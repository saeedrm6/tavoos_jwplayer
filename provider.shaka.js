(window.webpackJsonpjwplayer = window.webpackJsonpjwplayer || []).push([[16, 18], { 111: function (a, e, t) { "use strict"; var d = t(3), r = t(52); e.a = { canplay: function () { this.trigger(d.E) }, play: function () { this.stallTime = -1, this.video.paused || this.state === d.qb || this.setState(d.ob) }, loadedmetadata: function () { var a = { metadataType: "media", duration: this.getDuration(), height: this.video.videoHeight, width: this.video.videoWidth, seekRange: this.getSeekRange() }, e = this.drmUsed; e && (a.drm = e), this.trigger(d.K, a) }, timeupdate: function () { var r = this.video.currentTime, e = this.getCurrentTime(), t = this.getDuration(); if (!isNaN(t)) { this.seeking || this.video.paused || this.state !== d.rb && this.state !== d.ob || this.stallTime === r || (this.stallTime = -1, this.setState(d.qb), this.trigger(d.gb)); var n = { position: e, duration: t, currentTime: r, seekRange: this.getSeekRange(), metadata: { currentTime: r } }; if (this.getPtsOffset) { var i = this.getPtsOffset(); 0 <= i && (n.metadata.mpegts = i + e) } var a = this.getLiveLatency(); null !== a && (n.latency = a), (this.state === d.qb || this.seeking) && this.trigger(d.S, n) } }, click: function (t) { this.trigger(d.n, t) }, volumechange: function () { var t = this.video; this.trigger(d.V, { volume: Math.round(100 * t.volume) }), this.trigger(d.M, { mute: t.muted }) }, seeked: function () { this.seeking && (this.seeking = !1, this.trigger(d.R)) }, playing: function () { -1 === this.stallTime && this.setState(d.qb), this.trigger(d.gb) }, pause: function () { this.state !== d.lb && (this.video.ended || this.video.error || this.video.currentTime !== this.video.duration && this.setState(d.pb)) }, progress: function () { var a = this.getDuration(); if (!(0 >= a || a === 1 / 0)) { var e = this.video.buffered; if (e && 0 !== e.length) { var t = Object(r.a)(e.end(e.length - 1) / a, 0, 1); this.trigger(d.D, { bufferPercent: 100 * t, position: this.getCurrentTime(), duration: a, currentTime: this.video.currentTime, seekRange: this.getSeekRange() }) } } }, ratechange: function () { this.trigger(d.P, { playbackRate: this.video.playbackRate }) }, ended: function () { this.videoHeight = 0, this.streamBitrate = -1, this.state !== d.nb && this.state !== d.lb && this.trigger(d.F) }, loadeddata: function () { this.renderNatively && this.setTextTracks(this.video.textTracks) } } }, 112: function (d, e, t) { "use strict"; var l = t(5), r = t(11), n = t(85); e.a = { container: null, volume: function (t) { this.video.volume = Math.min(Math.max(0, t / 100), 1) }, mute: function (t) { this.video.muted = !!t, this.video.muted || this.video.removeAttribute("muted") }, resize: function (i, e, t) { var c = this.video, a = c.videoWidth, o = c.videoHeight; if (i && e && a && o) { var s = { objectFit: "", width: "", height: "" }; if ("uniform" === t) { var u = Math.abs(i / e - a / o); .09 > u && .0025 < u && (s.objectFit = "fill", t = "exactfit") } if (l.Browser.ie || l.OS.iOS && 9 > l.OS.version.major || l.Browser.androidNative) if ("uniform" !== t) { s.objectFit = "contain"; var f = i / e, m = a / o, d = 1, g = 1; "none" === t ? d = g = f > m ? Math.ceil(100 * o / e) / 100 : Math.ceil(100 * a / i) / 100 : "fill" === t ? d = g = f > m ? f / m : m / f : "exactfit" == t && (f > m ? (d = f / m, g = 1) : (d = 1, g = m / f)), Object(r.e)(c, "matrix(".concat(d.toFixed(2), ", 0, 0, ").concat(g.toFixed(2), ", 0, 0)")) } else s.top = s.left = s.margin = "", Object(r.e)(c, ""); Object(r.d)(c, s) } }, getContainer: function () { return this.container }, setContainer: function (t) { this.container = t, this.video.parentNode !== t && t.appendChild(this.video) }, remove: function () { this.stop(), this.destroy(); var t = this.container; t && t === this.video.parentNode && t.removeChild(this.video) }, atEdgeOfLiveStream: function () { return !!this.isLive() && 2 >= Object(n.a)(this.video.buffered) - this.video.currentTime } } }, 113: function (a, e) { "use strict"; e.a = { eventsOn_: function () { }, eventsOff_: function () { }, attachMedia: function () { this.eventsOn_() }, detachMedia: function () { return this.eventsOff_() } } }, 114: function (d, e, t) { "use strict"; function n(a, e, t) { var n = a + 1e3, d = s.o; return 0 < e ? (403 == e && (d = s.q), n += r(e)) : "http:" === ("" + t).substring(0, 5) && "https:" === document.location.protocol ? n += 12 : 0 === e && (n += 11), { code: n, key: d } } t.d(e, "b", function () { return n }), t.d(e, "a", function () { return r }); var s = t(1), r = function (t) { return 400 <= t && 600 > t ? t : 6 } }, 137: function (a, e, t) { "use strict"; t.d(e, "b", function () { return n }), t.d(e, "a", function () { return r }); var n = 1, r = 25 }, 138: function (d, e, t) { "use strict"; function n(a, e, t) { if (!a) return ""; var n = a.bitrate || a.bandwidth; return function (i, e) { var t = null; if (e && i) { var d = Object.keys(i), r = parseFloat(e); null == s && (s = -1 * d.length - (d.length - 1)), d.length && !isNaN(r) && (t = i[s]) } return s++ , t }(e, n) || a.label || function (i, e, t) { if (!i && !e) return ""; var n = "".concat(o(e), " kbps"), r = n; return i && (r = "".concat(i, "p"), e && t && (r += " (".concat(n, ")"))), r }(a.height, n, t) } function o(t) { return Math.floor(t / 1e3) } function i(t) { return !!Array.isArray(t) && t.some(function (a) { var e = a.height || a.bitrate || a.bandwidth, t = this[e]; return this[e] = 1, t }, {}) } var s = null; t.d(e, "a", function () { return n }), t.d(e, "c", function () { return o }), t.d(e, "b", function () { return i }) }, 139: function (d, e, t) { "use strict"; function n(i, e) { var d = e; return { start: function () { this.stop(), setInterval(function () { var e = i.getBandwidthEstimate(); Object(r.A)(e) && (d = e, i.trigger(a.i, { bandwidthEstimate: d })) }, 1e3) }, stop: function () { clearInterval(null) }, getEstimate: function () { return d } } } t.d(e, "a", function () { return n }); var a = t(3), r = t(0) }, 140: function (a, i) { !function () { var t = "undefined" == typeof window ? global : window, e = {}; for (var a in function (ed, e) { function td() { td = function () { }, Wp.Symbol || (Wp.Symbol = i) } function ad() { td(); var t = Wp.Symbol.iterator; t || (t = Wp.Symbol.iterator = Wp.Symbol("iterator")), "function" != typeof Array.prototype[t] && Xp(Array.prototype, t, { configurable: !0, writable: !0, value: function () { return nd(this) } }), ad = function () { } } function nd(a) { var e = 0; return c(function () { return e < a.length ? { done: !1, value: a[e++] } : { done: !0 } }) } function c(t) { return ad(), (t = { next: t })[Wp.Symbol.iterator] = function () { return this }, t } function id(a) { ad(); var e = a[Symbol.iterator]; return e ? e.call(a) : nd(a) } function t(i, e) { if (e) { for (var t = Wp, r = i.split("."), d = 0, p; d < r.length - 1; d++)p = r[d], p in t || (t[p] = {}), t = t[p]; (p = e(d = t[r = r[r.length - 1]])) != d && null != p && Xp(t, r, { configurable: !0, writable: !0, value: p }) } } function rd(t) { return function (a) { function d(e) { return a.next(e) } function t(e) { return a.throw(e) } return new Promise(function (n, r) { !function i(e) { e.done ? n(e.value) : Promise.resolve(e.value).then(d, t).then(i, r) }(a.next()) }) }(t()) } function d() { this.g = !1, this.c = null, this.s = void 0, this.l = 1, this.b = this.f = 0, this.i = this.a = null } function l(t) { if (t.g) throw new TypeError("Generator is already running"); t.g = !0 } function f(a, e) { a.a = { ud: e, Ed: !0 }, a.l = a.f || a.b } function dd(a, e, t) { return a.l = t, { value: e } } function E(t) { t.l = 0 } function b(a, e, t) { a.f = e, null != t && (a.b = t) } function h(a, e) { a.f = 0, a.b = e || 0 } function T(a, e) { a.l = e, a.f = 0 } function x(a) { a.f = 0; var e = a.a.ud; return a.a = null, e } function k(t) { t.i = [t.a], t.f = 0, t.b = 0 } function S(a, e) { var t = a.i.splice(0)[0]; (t = a.a = a.a || t) ? t.Ed ? a.l = a.f || a.b : null != t.A && a.b < t.A ? (a.l = t.A, a.a = null) : a.l = a.b : a.l = e } function I(t) { this.a = new d, this.b = t } function A(d, e, t, n) { try { var r = e.call(d.a.c, t); if (!(r instanceof Object)) throw new TypeError("Iterator result " + r + " is not an object"); if (!r.done) return d.a.g = !1, r; var i = r.value } catch (e) { return d.a.c = null, f(d.a, e), C(d) } return d.a.c = null, n.call(d.a, i), C(d) } function C(a) { for (; a.a.l;)try { var e = a.b(a.a); if (e) return a.a.g = !1, { value: e.value, done: !1 } } catch (e) { a.a.s = void 0, f(a.a, e) } if (a.a.g = !1, a.a.a) { if (e = a.a.a, a.a.a = null, e.Ed) throw e.ud; return { value: e.return, done: !0 } } return { value: void 0, done: !0 } } function _(a) { this.next = function (e) { return l(a.a), a.a.c ? e = A(a, a.a.c.next, e, a.a.h) : (a.a.h(e), e = C(a)), e }, this.throw = function (e) { return l(a.a), a.a.c ? e = A(a, a.a.c.throw, e, a.a.h) : (f(a.a, e), e = C(a)), e }, this.return = function (e) { return function (a, e) { l(a.a); var t = a.a.c; return t ? A(a, "return" in t ? t.return : function (t) { return { value: t, done: !0 } }, e, a.a.return) : (a.a.return(e), C(a)) }(a, e) }, ad(), this[Symbol.iterator] = function () { return this } } function od(a, e) { return _.prototype = a.prototype, new _(new I(e)) } function w(a, e) { return Object.prototype.hasOwnProperty.call(a, e) } function R(d, o, t) { d instanceof String && (d = d + ""); for (var n = d.length, r = 0, s; r < n; r++)if (s = d[r], o.call(t, s, r, d)) return { Ad: r, ge: s }; return { Ad: -1, ge: void 0 } } function L(a, e, t) { if (null == a) throw new TypeError("The 'this' value for String.prototype." + t + " must not be null or undefined"); if (e instanceof RegExp) throw new TypeError("First argument to String.prototype." + t + " must not be a regular expression"); return a + "" } function D(a, e) { var t = a.split("."), r = g, d; for ((t[0] in r) || !r.execScript || r.execScript("var " + t[0]); t.length && (d = t.shift());)t.length || void 0 === e ? r = r[d] ? r[d] : r[d] = {} : r[d] = e } function P(a, i) { function e() { } e.prototype = i.prototype, a.bg = i.prototype, a.prototype = new e, a.prototype.constructor = a, a.pg = function (t, e) { return i.prototype[e].apply(t, Array.prototype.slice.call(arguments, 2)) } } function N(t) { this.c = Math.exp(Math.log(.5) / t), this.b = this.a = 0 } function O(a, e, t) { var i = Math.pow(a.c, e); t = t * (1 - i) + i * a.a, isNaN(t) || (a.a = t, a.b += e) } function M(t) { return t.a / (1 - Math.pow(t.c, t.b)) } function B() { this.b = new N(2), this.c = new N(5), this.a = 0 } function j() { } function F() { } function V() { } function K(a) { var e; a instanceof K ? (H(this, a.sa), this.Xa = a.Xa, this.oa = a.oa, q(this, a.tb), this.fa = a.fa, X(this, a.a.clone()), this.Oa = a.Oa) : a && (e = (a + "").match(U)) ? (H(this, e[1] || "", !0), this.Xa = Y(e[2] || ""), this.oa = Y(e[3] || "", !0), q(this, e[4]), this.fa = Y(e[5] || "", !0), X(this, e[6] || "", !0), this.Oa = Y(e[7] || "")) : this.a = new $(null) } function H(a, e, t) { a.sa = t ? Y(e, !0) : e, a.sa && (a.sa = a.sa.replace(/:$/, "")) } function q(a, e) { if (e) { if (e = +e, isNaN(e) || 0 > e) throw Error("Bad port number " + e); a.tb = e } else a.tb = null } function X(a, e, i) { e instanceof $ ? a.a = e : (i || (e = Q(e, ie)), a.a = new $(e)) } function Y(a, e) { return a ? e ? decodeURI(a) : decodeURIComponent(a) : "" } function Q(a, i, t) { return "string" == typeof a ? (a = encodeURI(a).replace(i, J), t && (a = a.replace(/%25([0-9a-fA-F]{2})/g, "%$1")), a) : null } function J(t) { return "%" + (15 & (t = t.charCodeAt(0)) >> 4).toString(16) + (15 & t).toString(16) } function $(t) { this.a = t || null } function Z(t) { this.b = t, this.a = null } function ee(t) { this.b = t, this.a = null } function te(a, e) { var t = { maxAttempts: 2, baseDelay: 1e3, backoffFactor: 2, fuzzFactor: .5, timeout: 0 }; this.i = null == a.maxAttempts ? t.maxAttempts : a.maxAttempts, this.f = null == a.baseDelay ? t.baseDelay : a.baseDelay, this.h = null == a.fuzzFactor ? t.fuzzFactor : a.fuzzFactor, this.g = null == a.backoffFactor ? t.backoffFactor : a.backoffFactor, this.a = 0, this.b = this.f, (this.c = void 0 !== e && e) && (this.a = 1) } function se(a) { return rd(function e() { var i, d; return od(e, function (e) { switch (e.l) { case 1: if (a.a >= a.i) { if (!a.c) return e.return(Promise.reject()); a.a = 1, a.b = a.f } return i = a.a, a.a++ , 0 == i ? e.return() : (d = a.b * (1 + (2 * Math.random() - 1) * a.h), dd(e, new Promise(function (t) { new ee(t).O(d / 1e3) }), 2)); case 2: a.b *= a.g, E(e); } }) }) } function le(r, e, t) { for (var n = [], i = 3; i < arguments.length; ++i)n[i - 3] = arguments[i]; this.severity = r, this.category = e, this.code = t, this.data = n, this.handled = !1 } function ue() { var a = new Promise(function (e, t) { i = e, d = t }), i, d; return a.resolve = i, a.reject = d, a } function de(a, e) { this.promise = a, this.Hd = e, this.a = !1 } function pe(t) { return new de(Promise.reject(t), function () { return Promise.resolve() }) } function ce() { var t = Promise.reject(new le(2, 7, 7001)); return t.catch(function () { }), new de(t, function () { return Promise.resolve() }) } function fe(t) { return new de(Promise.resolve(t), function () { return Promise.resolve() }) } function me(t) { return new de(t, function () { return t.catch(function () { }) }) } function ge(t) { return new de(Promise.all(t.map(function (t) { return t.promise })), function () { return Promise.all(t.map(function (t) { return t.abort() })) }) } function ye(a, e, t) { try { var n = a(e); return n && n.promise && n.abort ? (t.resolve(n.promise), function () { return n.abort() }) : (t.resolve(n), function () { return Promise.resolve(n).then(function () { }).catch(function () { }) }) } catch (a) { return t.reject(a), function () { return Promise.resolve() } } } function be(e, t) { for (var a in t = void 0 === t ? {} : t) this[a] = t[a]; this.defaultPrevented = this.cancelable = this.bubbles = !1, this.timeStamp = ed.performance && ed.performance.now ? ed.performance.now() : Date.now(), this.type = e, this.isTrusted = !1, this.target = this.currentTarget = null, this.a = !1 } function he() { this.a = {} } function ve() { this.xc = new he, this.Sb = this } function Te(a) { var d = new Set; return function t(e) { switch (typeof e) { case "undefined": case "boolean": case "number": case "string": case "symbol": case "function": return e; default: if (!e || e.buffer && e.buffer.constructor == ArrayBuffer) return e; if (d.has(e)) return null; var n = e.constructor == Array; if (e.constructor != Object && !n) return null; d.add(e); var r = n ? [] : {}, a; for (a in e) r[a] = t(e[a]); return n && (r.length = e.length), r; } }(a) } function Ee(a, e) { return "number" == typeof a && "number" == typeof e && isNaN(a) && isNaN(e) || a === e } function xe(a, e) { var t = a.indexOf(e); -1 < t && a.splice(t, 1) } function ke(a, d, o) { if (o || (o = Ee), a.length != d.length) return !1; d = d.slice(); for (var s = {}, p = (a = id(a)).next(); !p.done; s = { item: s.item }, p = a.next()) { if (s.item = p.value, -1 == (p = d.findIndex(function (a) { return function (e) { return o(a.item, e) } }(s)))) return !1; d[p] = d[d.length - 1], d.pop() } return 0 == d.length } function Se() { this.a = [] } function Ie(a, e) { a.a.push(e.finally(function () { xe(a.a, e) })) } function Ae(t) { ve.call(this), this.f = !1, this.g = new Se, this.a = new Set, this.b = new Set, this.c = t || null } function Ce(a, e, t) { t = t || 3; var i = Me[a]; (!i || t >= i.priority) && (Me[a] = { priority: t, wf: e }) } function _e(a, e) { return { uris: a, method: "GET", body: null, headers: {}, allowCrossSiteCredentials: !1, retryParameters: e, licenseRequestType: null } } function we() { this.a = 0 } function Re(a, e, t) { de.call(this, a, e), this.b = t } function Le() { this.b = new he } function De(a, e, d, n, r) { a.b && (e = new Fe(e, d, n, r), a.b.push(d, e)) } function Pe(d, e, t, n) { De(d, e, t, function r(i) { d.ma(e, t, r), n(i) }, void 0) } function Oe(a) { if (a.b) { for (var e = a.b.getAll(), i = (e = id(e)).next(); !i.done; i = e.next())i.value.ma(); a.b.a = {} } } function Fe(a, e, t, n) { this.target = a, this.type = e, this.listener = t, this.a = function (a, e) { if (null == e) return !1; if ("boolean" == typeof e) return e; var t = new Set(["passive", "capture"]); return Object.keys(e).filter(function (a) { return !t.has(a) }), function (a) { var i = Be; if (null == i) { i = !1; try { var e = {}, n = { get: function () { return i = !0, !1 } }; Object.defineProperty(e, "passive", n), Object.defineProperty(e, "capture", n), n = function () { }, a.addEventListener("test", n, e), a.removeEventListener("test", n, e) } catch (t) { i = !1 } Be = i } return i || !1 }(a) ? e : e.capture || !1 }(a, n), this.target.addEventListener(e, t, this.a) } function Ve(a, e) { for (var t = id(a), n = t.next(); !n.done; n = t.next())if (!e(n.value)) return !1; return !0 } function Ke(a) { var e = new Map; return Object.keys(a).forEach(function (t) { e.set(t, a[t]) }), e } function He(a) { var i = {}; return a.forEach(function (t, e) { i[e] = t }), i } function qe(a, e) { var t = a; return e && (t += "; codecs=\"" + e + "\""), t } function Ge(a) { var n = (a = a.split("."))[0]; return a.pop(), [n, a.join(".")] } function Xe() { return ed.MediaSource && MediaSource.isTypeSupported } function We(t) { return "" != (Zp || (Je || (Je = new ee(function () { Zp = null })), (Zp = document.querySelector("video") || document.querySelector("audio")) || (Zp = document.createElement("video")), Je.O(1), Zp)).canPlayType(t) } function Ye(t) { return (navigator.userAgent || "").includes(t) } function Qe(t) { if (!t) return ""; 239 == (t = new Uint8Array(t))[0] && 187 == t[1] && 191 == t[2] && (t = t.subarray(3)), t = escape(it(t)); try { return decodeURIComponent(t) } catch (t) { throw new le(2, 2, 2004) } } function $e(a, d, t) { if (!a) return ""; if (!t && 0 != a.byteLength % 2) throw new le(2, 2, 2004); if (a instanceof ArrayBuffer) var o = a; else (t = new Uint8Array(a.byteLength)).set(new Uint8Array(a)), o = t.buffer; a = Math.floor(a.byteLength / 2), t = new Uint16Array(a), o = new DataView(o); for (var s = 0; s < a; s++)t[s] = o.getUint16(2 * s, d); return it(t) } function Ze(a) { var e = new Uint8Array(a); if (239 == e[0] && 187 == e[1] && 191 == e[2]) return Qe(e); if (254 == e[0] && 255 == e[1]) return $e(e.subarray(2), !1); if (255 == e[0] && 254 == e[1]) return $e(e.subarray(2), !0); var t = function (a, e) { return a.byteLength <= e || 32 <= a[e] && 126 >= a[e] }.bind(null, e); if (0 == e[0] && 0 == e[2]) return $e(a, !1); if (0 == e[1] && 0 == e[3]) return $e(a, !0); if (t(0) && t(1) && t(2) && t(3)) return Qe(a); throw new le(2, 2, 2003) } function et(a) { a = encodeURIComponent(a), a = unescape(a); for (var i = new Uint8Array(a.length), t = 0; t < a.length; ++t)i[t] = a.charCodeAt(t); return i.buffer } function at(a, e) { for (var t = new Uint8Array(2 * a.length), n = new DataView(t.buffer), r = 0; r < a.length; ++r)n.setUint16(2 * r, a.charCodeAt(r), e); return t.buffer } function it(a) { for (var e = "", i = 0; i < a.length; i += 16e3)e += String.fromCharCode.apply(null, a.subarray(i, i + 16e3)); return e } function rt(e, t) { var a = it(e); return t = null == t || t, a = ed.btoa(a).replace(/\+/g, "-").replace(/\//g, "_"), t ? a : a.replace(/=*$/, "") } function ot(e) { e = ed.atob(e.replace(/-/g, "+").replace(/_/g, "/")); for (var a = new Uint8Array(e.length), n = 0; n < e.length; ++n)a[n] = e.charCodeAt(n); return a } function st(e) { for (var t = new Uint8Array(e.length / 2), a = 0; a < e.length; a += 2)t[a / 2] = ed.parseInt(e.substr(a, 2), 16); return t } function lt(a) { for (var e = "", i = 0, d; i < a.length; ++i)d = a[i].toString(16), 1 == d.length && (d = "0" + d), e += d; return e } function ut(a, e) { if (!a && !e) return !0; if (!a || !e || a.length != e.length) return !1; for (var t = 0; t < a.length; ++t)if (a[t] != e[t]) return !1; return !0 } function dt() { for (var e = [], t = 0; t < arguments.length; ++t)e[t] = arguments[t]; for (var a = t = 0; a < e.length; ++a)t += e[a].length; t = new Uint8Array(t); for (var d = a = 0; d < e.length; ++d)t.set(e[d], a), a += e[d].length; return t } function pt(a) { var e = this; this.w = a, this.v = new Set, this.m = this.h = null, this.N = !1, this.a = null, this.i = new Le, this.b = new Map, this.o = [], this.j = new ue, this.f = null, this.g = function (t) { e.j.reject(t), a.onError(t) }, this.ka = new Map, this.S = new Map, this.K = new ee(function () { return function (a) { var e = a.ka, i = a.S; i.clear(), e.forEach(function (a, e) { return i.set(e, a) }), (e = Array.from(i.values())).length && e.every(function (t) { return "expired" == t }) && a.g(new le(2, 6, 6014)), a.w.gc(He(i)) }(e) }), this.c = !1, this.W = new ue, this.C = !1, this.F = [], this.ja = !1, this.V = new ee(function () { !function (a) { a.b.forEach(function (e, t) { var n = e.Uc, r = t.expiration; isNaN(r) && (r = 1 / 0), r != n && (a.w.onExpirationUpdated(t.sessionId, r), e.Uc = r) }) }(e) }).Ia(1), this.j.catch(function () { }) } function ct(a, e, t) { return a.o = t, a.C = 0 < t.length, ft(a, e) } function ft(e, t) { var n = t.some(function (t) { return 0 < t.drmInfos.length }); if (!n) { var r = Ke(e.f.servers); !function (a, e) { var d = []; e.forEach(function (a, e) { d.push({ keySystem: e, licenseServerUri: a, distinctiveIdentifierRequired: !1, persistentStateRequired: !1, audioRobustness: "", videoRobustness: "", serverCertificate: null, initData: [], keyIds: [] }) }); for (var t = id(a), n = t.next(); !n.done; n = t.next())n.value.drmInfos = d }(t, r) } var d = function (e) { if (0 == (e = Ke(e.f.clearKeys)).size) return null; var d = [], n = []; e.forEach(function (r, e) { var t = st(e), o = st(r); t = { kty: "oct", kid: rt(t, !1), k: rt(o, !1) }, d.push(t), n.push(t.kid) }), e = JSON.stringify({ keys: d }); var a = JSON.stringify({ kids: n }); return a = [{ initData: new Uint8Array(et(a)), initDataType: "keyids" }], { keySystem: "org.w3.clearkey", licenseServerUri: "data:application/json;base64," + ed.btoa(e), distinctiveIdentifierRequired: !1, persistentStateRequired: !1, audioRobustness: "", videoRobustness: "", serverCertificate: null, initData: a, keyIds: [] } }(e); if (d) { var s = id(t); for (r = s.next(); !r.done; r = s.next())r.value.drmInfos = [d] } for (r = (d = id(t)).next(); !r.done; r = d.next())for (s = (r = id(r.value.drmInfos)).next(); !s.done; s = r.next())Ct(s.value, Ke(e.f.servers), Ke(e.f.advanced || {})); return (r = function (d, e) { for (var t = new Set, p = id(e), f = p.next(), m; !f.done; f = p.next())for (m = id(f.value.drmInfos), f = m.next(); !f.done; f = m.next())t.add(f.value); for (p = id(t), f = p.next(); !f.done; f = p.next())Ct(f.value, Ke(d.f.servers), Ke(d.f.advanced || {})); m = d.C ? "required" : "optional"; var g = d.C ? ["persistent-license"] : ["temporary"]; for (p = new Map, t = id(t), f = t.next(); !f.done; f = t.next())f = f.value, p.set(f.keySystem, { audioCapabilities: [], videoCapabilities: [], distinctiveIdentifier: "optional", persistentState: m, sessionTypes: g, label: f.keySystem, drmInfos: [] }); for (t = id(e), f = t.next(); !f.done; f = t.next()) { f = f.value, m = f.audio, g = f.video; var y = m ? qe(m.mimeType, m.codecs) : "", s = g ? qe(g.mimeType, g.codecs) : "", u = id(f.drmInfos); for (f = u.next(); !f.done; f = u.next()) { f = f.value; var c = p.get(f.keySystem); c.drmInfos.push(f), f.distinctiveIdentifierRequired && (c.distinctiveIdentifier = "required"), f.persistentStateRequired && (c.persistentState = "required"), m && c.audioCapabilities.push({ robustness: f.audioRobustness || "", contentType: y }), g && c.videoCapabilities.push({ robustness: f.videoRobustness || "", contentType: s }) } } return p }(e, t)).size ? (r = vt(e, r), n ? r : r.catch(function () { })) : (e.N = !0, Promise.resolve()) } function mt(a) { return rd(function e() { var i; return od(e, function (e) { switch (e.l) { case 1: if (!(a.h && a.a && a.a.serverCertificate && a.a.serverCertificate.length)) { e.A(0); break } return b(e, 3), dd(e, a.h.setServerCertificate(a.a.serverCertificate), 5); case 5: T(e, 0); break; case 3: return i = x(e), e.return(Promise.reject(new le(2, 6, 6004, i.message))); } }) }) } function gt(a) { var e = a.a ? a.a.initData : []; return e.forEach(function (e) { return Et(a, e.initDataType, e.initData) }), a.o.forEach(function (e) { return Tt(a, e) }), e.length || a.o.length || a.j.resolve(), a.j } function yt(a, e, t) { for (var n = a.b.values(), d = (n = id(n)).next(); !d.done; d = n.next())if (ut(t, d.value.initData)) return; Et(a, e, t) } function bt(a, e) { return !!Ye("Edge/") || a.v.has(e) } function ht(t) { return t = function (a, e) { for (var t = [], n = id(a), r = n.next(); !r.done; r = n.next())t.push(e(r.value)); return t }(t = t.b.keys(), function (t) { return t.sessionId }), Array.from(t) } function vt(a, d) { if (1 == d.size && d.has("")) return Promise.reject(new le(2, 6, 6e3)); for (var e = id(d.values()), t = e.next(); !t.done; t = e.next())0 == (t = t.value).audioCapabilities.length && delete t.audioCapabilities, 0 == t.videoCapabilities.length && delete t.videoCapabilities; var o = e = new ue; return [!0, !1].forEach(function (a) { var e = this; d.forEach(function (n, t) { n.drmInfos.some(function (t) { return !!t.licenseServerUri }) == a && (o = o.catch(function () { if (!this.c) return navigator.requestMediaKeySystemAccess(t, [n]) }.bind(e))) }) }.bind(a)), o = (o = o.catch(function () { return Promise.reject(new le(2, 6, 6001)) })).then(function (t) { if (this.c) return Promise.reject(); this.v.clear(); var e = t.getConfiguration(), p = e.videoCapabilities || [], l = id(e.audioCapabilities || []); for (e = l.next(); !e.done; e = l.next())this.v.add(e.value.contentType); for (e = (p = id(p)).next(); !e.done; e = p.next())this.v.add(e.value.contentType); p = t.keySystem, l = []; var u = [], a = [], o = []; return function (a, d, t, n, r) { a.forEach(function (i) { if (d.includes(i.licenseServerUri) || d.push(i.licenseServerUri), i.serverCertificate && (t.some(function (e) { return ut(e, i.serverCertificate) }) || t.push(i.serverCertificate)), i.initData && i.initData.forEach(function (a) { n.some(function (e) { return e.keyId && e.keyId == a.keyId || e.initDataType == a.initDataType && ut(e.initData, a.initData) }) || n.push(a) }), i.keyIds) for (var e = 0; e < i.keyIds.length; ++e)r.includes(i.keyIds[e]) || r.push(i.keyIds[e]) }) }((e = d.get(t.keySystem)).drmInfos, l, u, a, o), this.a = { keySystem: p, licenseServerUri: l[0], distinctiveIdentifierRequired: "required" == e.distinctiveIdentifier, persistentStateRequired: "required" == e.persistentState, audioRobustness: e.audioCapabilities ? e.audioCapabilities[0].robustness : "", videoRobustness: e.videoCapabilities ? e.videoCapabilities[0].robustness : "", serverCertificate: u[0], initData: a, keyIds: o }, this.a.licenseServerUri ? t.createMediaKeys() : Promise.reject(new le(2, 6, 6012, this.a.keySystem)) }.bind(a)).then(function (t) { return this.c ? Promise.reject() : void (this.h = t, this.N = !0) }.bind(a)).catch(function (t) { if (!this.c) return this.a = null, this.v.clear(), t instanceof le ? Promise.reject(t) : Promise.reject(new le(2, 6, 6002, t.message)) }.bind(a)), e.reject(), o } function Tt(a, e) { try { var t = a.h.createSession("persistent-license") } catch (e) { var n = new le(2, 6, 6005, e.message); return a.g(n), Promise.reject(n) } De(a.i, t, "message", a.Pd.bind(a)), De(a.i, t, "keystatuseschange", a.Nd.bind(a)); var r = { initData: null, loaded: !1, Uc: 1 / 0, ua: null }; return a.b.set(t, r), t.load(e).then(function (a) { return this.c ? Promise.reject() : a ? (r.loaded = !0, At(this) && this.j.resolve(), t) : (this.b.delete(t), void this.g(new le(2, 6, 6013))) }.bind(a), function (a) { this.c || (this.b.delete(t), this.g(new le(2, 6, 6005, a.message))) }.bind(a)) } function Et(a, e, t) { try { var i = a.C ? a.h.createSession("persistent-license") : a.h.createSession() } catch (e) { return void a.g(new le(2, 6, 6005, e.message)) } De(a.i, i, "message", a.Pd.bind(a)), De(a.i, i, "keystatuseschange", a.Nd.bind(a)), a.b.set(i, { initData: t, loaded: !1, Uc: 1 / 0, ua: null }), i.generateRequest(e, t.buffer).catch(function (e) { if (!a.c) { if (a.b.delete(i), e.errorCode && e.errorCode.systemCode) { var t = e.errorCode.systemCode; 0 > t && (t += Math.pow(2, 32)), t = "0x" + t.toString(16) } a.g(new le(2, 6, 6006, e.message, e, t)) } }) } function xt(d, e) { var t = e.target, n = d.b.get(t), r = d.a.licenseServerUri, o = d.f.advanced[d.a.keySystem]; "individualization-request" == e.messageType && o && o.individualizationServer && (r = o.individualizationServer), (r = _e([r], d.f.retryParameters)).body = e.message, r.method = "POST", r.licenseRequestType = e.messageType, "com.microsoft.playready" != d.a.keySystem && "com.chromecast.playready" != d.a.keySystem || function (a) { var e = $e(a.body, !0, !0); if (e.includes("PlayReadyKeyMessage")) { for (var i = (e = new DOMParser().parseFromString(e, "application/xml")).getElementsByTagName("HttpHeader"), n = 0; n < i.length; ++n)a.headers[i[n].querySelector("name").textContent] = i[n].querySelector("value").textContent; a.body = ot(e.querySelector("Challenge").textContent).buffer } else a.headers["Content-Type"] = "text/xml; charset=utf-8" }(r), d.a.keySystem.startsWith("com.apple.fps") && function (a) { var e = new Uint8Array(a.body); e = "spc=" + rt(e), a.headers["Content-Type"] = "application/x-www-form-urlencoded", a.body = et(e) }(r), d.w.nb.request(2, r).promise.then(function (a) { return this.c ? Promise.reject() : (this.a.keySystem.startsWith("com.apple.fps") && function (a) { try { var e = Qe(a.data) } catch (t) { return } "<ckc>" === (e = e.trim()).substr(0, 5) && "</ckc>" === e.substr(-6) && (e = e.slice(5, -6)); try { e = JSON.parse(e).ckc } catch (t) { } a.data = ot(e).buffer }(a), t.update(a.data).then(function () { var t = this; this.w.onEvent(new be("drmsessionupdate")), n && (n.ua && n.ua.resolve(), new ee(function () { n.loaded = !0, At(t) && t.j.resolve() }).O(Nt)) }.bind(this))) }.bind(d), function (t) { this.c || (t = new le(2, 6, 6007, t), this.g(t), n && n.ua && n.ua.reject(t)) }.bind(d)).catch(function (t) { this.c || (t = new le(2, 6, 6008, t.message), this.g(t), n && n.ua && n.ua.reject(t)) }.bind(d)) } function kt() { var a = [{ contentType: "video/mp4; codecs=\"avc1.42E01E\"" }, { contentType: "video/webm; codecs=\"vp8\"" }], d = [{ videoCapabilities: a, persistentState: "required", sessionTypes: ["persistent-license"] }, { videoCapabilities: a }], t = new Map; return a = ["org.w3.clearkey", "com.widevine.alpha", "com.microsoft.playready", "com.apple.fps.3_0", "com.apple.fps.2_0", "com.apple.fps.1_0", "com.apple.fps", "com.adobe.primetime"].map(function (a) { return function (n) { return rd(function e() { var s, p, l; return od(e, function (e) { switch (e.l) { case 1: return b(e, 2), dd(e, navigator.requestMediaKeySystemAccess(n, d), 4); case 4: return s = e.s, l = !!(p = s.getConfiguration().sessionTypes) && p.includes("persistent-license"), Ye("Tizen 3") && (l = !1), t.set(n, { persistentState: l }), dd(e, s.createMediaKeys(), 5); case 5: T(e, 0); break; case 2: x(e), t.set(n, null), E(e); } }) }) }(a) }), Promise.all(a).then(function () { return He(t) }) } function St(a, e) { var t = e.audio, n = e.video; if (t && t.encrypted && !bt(a, qe(t.mimeType, t.codecs)) || n && n.encrypted && !bt(a, qe(n.mimeType, n.codecs))) return !1; var r = a.keySystem(); return 0 == e.drmInfos.length || e.drmInfos.some(function (t) { return t.keySystem == r }) } function It(d, e) { if (!d.length) return e; if (!e.length) return d; for (var t = [], n = 0; n < d.length; n++)for (var p = 0; p < e.length; p++)if (d[n].keySystem == e[p].keySystem) { var l = d[n]; p = e[p]; var a = []; a = (a = a.concat(l.initData || [])).concat(p.initData || []); var u = []; u = (u = u.concat(l.keyIds)).concat(p.keyIds), t.push({ keySystem: l.keySystem, licenseServerUri: l.licenseServerUri || p.licenseServerUri, distinctiveIdentifierRequired: l.distinctiveIdentifierRequired || p.distinctiveIdentifierRequired, persistentStateRequired: l.persistentStateRequired || p.persistentStateRequired, videoRobustness: l.videoRobustness || p.videoRobustness, audioRobustness: l.audioRobustness || p.audioRobustness, serverCertificate: l.serverCertificate || p.serverCertificate, initData: a, keyIds: u }); break } return t } function At(t) { return Ve(t = t.b.values(), function (t) { return t.loaded }) } function Ct(e, t, a) { !e.keySystem || "org.w3.clearkey" == e.keySystem && e.licenseServerUri || (t.size && (t = t.get(e.keySystem) || "", e.licenseServerUri = t), e.keyIds || (e.keyIds = []), (a = a.get(e.keySystem)) && (e.distinctiveIdentifierRequired || (e.distinctiveIdentifierRequired = a.distinctiveIdentifierRequired), e.persistentStateRequired || (e.persistentStateRequired = a.persistentStateRequired), e.videoRobustness || (e.videoRobustness = a.videoRobustness), e.audioRobustness || (e.audioRobustness = a.audioRobustness), e.serverCertificate || (e.serverCertificate = a.serverCertificate)), ed.cast && ed.cast.__platform__ && "com.microsoft.playready" == e.keySystem && (e.keySystem = "com.chromecast.playready")) } function _t() { this.a = new muxjs.mp4.CaptionParser, this.g = [], this.f = {} } function wt() { } function Lt(t) { return !t || 1 == t.length && 1e-6 > t.end(0) - t.start(0) ? null : t.length ? t.end(t.length - 1) : null } function Dt(a, e, t) { return t = void 0 === t ? 0 : t, a && a.length && (1 != a.length || !(1e-6 > a.end(0) - a.start(0))) && !(e > a.end(a.length - 1)) && e + t >= a.start(0) } function Pt(a, e) { if (!a || !a.length || 1 == a.length && 1e-6 > a.end(0) - a.start(0)) return 0; for (var t = 0, i = a.length - 1; 0 <= i && a.end(i) > e; --i)t += a.end(i) - Math.max(a.start(i), e); return t } function Mt(a) { if (!a) return []; for (var e = [], t = 0; t < a.length; t++)e.push({ start: a.start(t), end: a.end(t) }); return e } function Ut(a, e) { if (0 == e.length) return a; var t = e.map(function (t) { return new K(t) }); return a.map(function (t) { return new K(t) }).map(function (a) { return t.map(a.resolve.bind(a)) }).reduce(Ot.uc, []).map(function (t) { return t.toString() }) } function Bt(a, e) { return { keySystem: a, licenseServerUri: "", distinctiveIdentifierRequired: !1, persistentStateRequired: !1, audioRobustness: "", videoRobustness: "", serverCertificate: null, initData: e || [], keyIds: [] } } function jt() { this.a = new muxjs.mp4.Transmuxer({ keepOriginalTimestamps: !0 }), this.b = null, this.g = [], this.c = [], this.f = !1, this.a.on("data", this.i.bind(this)), this.a.on("done", this.h.bind(this)) } function Ft(e, t) { return ed.muxjs && "mp2t" == e.split(";")[0].split("/")[1] && (t ? MediaSource.isTypeSupported(Kt(t, e)) : MediaSource.isTypeSupported(Kt("audio", e)) || MediaSource.isTypeSupported(Kt("video", e))) } function Kt(d, e) { var t = e.replace("mp2t", "mp4"); "audio" == d && (t = t.replace("video", "audio")); var s = /avc1\.(66|77|100)\.(\d+)/.exec(t); if (s) { var r = "avc1.", p = s[1], a = +s[2]; r = ("66" == p ? r + "4200" : "77" == p ? r + "4d00" : r + "6400") + (a >> 4).toString(16), r += (15 & a).toString(16), t = t.replace(s[0], r) } return t } function Ht(a, e, t) { this.startTime = a, this.direction = en, this.endTime = e, this.payload = t, this.region = new Gt, this.position = null, this.positionAlign = zt, this.size = 100, this.textAlign = $t, this.writingMode = tn, this.lineInterpretation = nn, this.line = null, this.lineHeight = "", this.lineAlign = rn, this.displayAlign = Qt, this.backgroundColor = this.color = "", this.backgroundImage = null, this.fontSize = "", this.fontWeight = on, this.fontStyle = sn, this.fontFamily = "", this.textDecoration = [], this.wrapLine = !0, this.id = "" } function Gt() { this.id = "", this.regionAnchorY = this.regionAnchorX = this.viewportAnchorY = this.viewportAnchorX = 0, this.height = this.width = 100, this.viewportAnchorUnits = this.widthUnits = this.heightUnits = cn, this.scroll = fn } function Xt(t) { this.g = null, this.c = t, this.f = this.m = 0, this.h = 1 / 0, this.b = this.a = null, this.j = "", this.i = new Map } function Wt(e) { return !!(hn[e] || ed.muxjs && "application/cea-608" == e) } function Yt(a, e) { "application/cea-608" != e && (a.g = new hn[e]) } function dn(d, e, p, n, r) { for (var l = p + " " + n, c = new Map, o = (e = id(e)).next(), f; !o.done; o = e.next())f = o.value, o = f.stream, c.has(o) || c.set(o, new Map), c.get(o).has(l) || c.get(o).set(l, []), f.startTime += r, f.endTime += r, f.startTime >= d.f && f.startTime < d.h && (f = new Ht(f.startTime, f.endTime, f.text), c.get(o).get(l).push(f), o == d.j && d.c.append([f])); for (l = (r = id(c.keys())).next(); !l.done; l = r.next())for (l = l.value, d.i.has(l) || d.i.set(l, new Map), o = (e = id(c.get(l).keys())).next(); !o.done; o = e.next())o = o.value, f = c.get(l).get(o), d.i.get(l).set(o, f); d.a = null == d.a ? Math.max(p, d.f) : Math.min(d.a, Math.max(p, d.f)), d.b = Math.max(d.b, Math.min(n, d.h)) } function ln(a, i, r) { this.f = a, this.h = r, this.b = {}, this.a = null, this.c = {}, this.i = new Le, this.v = !1, this.j = {}, this.m = i, a = this.o = new ue, i = new MediaSource, Pe(this.i, i, "sourceopen", a.resolve), this.f.src = pn(i), this.g = i } function mn(a) { var e = qe(a.mimeType, a.codecs), t = function (a) { var e = [a.mimeType]; return $p.forEach(function (t, n) { var r = a[n]; r && e.push(t + "=\"" + r + "\"") }), e.join(";") }(a); return Wt(e) || MediaSource.isTypeSupported(t) || Ft(e, a.type) } function gn(a, e) { a.a || (a.a = new Xt(a.h)), Yt(a.a, e) } function yn(a, e) { if ("text" == e) var t = a.a.a; else t = !(t = Tn(a, e)) || 1 == t.length && 1e-6 > t.end(0) - t.start(0) ? null : 1 == t.length && 0 > t.start(0) ? 0 : t.length ? t.start(0) : null; return t } function vn(a, e) { return "text" == e ? a.a.b : Lt(Tn(a, e)) } function Tn(a, e) { try { return a.b[e].buffered } catch (t) { return null } } function En(d, t, e, n, i, a) { return "text" == t ? function (a, i, t, n) { return Promise.resolve().then(function () { if (this.g && this.c) if (null == t || null == n) this.g.parseInit(new Uint8Array(i)); else { var a = { periodStart: this.m, segmentStart: t, segmentEnd: n }; a = this.g.parseMedia(new Uint8Array(i), a).filter(function (t) { return t.startTime >= this.f && t.startTime < this.h }.bind(this)), this.c.append(a), null == this.a && (this.a = Math.max(t, this.f)), this.b = Math.min(n, this.h) } }.bind(a)) }(d.a, e, n, i) : d.j[t] ? function (a, e) { a.f = !0, a.b = new ue, a.g = [], a.c = []; var t = new Uint8Array(e); return a.a.push(t), a.a.flush(), a.f && a.b.reject(new le(2, 3, 3018)), a.b }(d.j[t], e).then(function (a) { return this.a || gn(this, "text/vtt"), a.captions && dn(this.a, a.captions, n, i, this.b.video.timestampOffset), kn(this, t, this.ce.bind(this, t, a.data.buffer)) }.bind(d)) : (a && ed.muxjs && (d.a || gn(d, "text/vtt"), null == n && null == i ? d.m.init(e) : d.m.b(e, function (t) { t.length && dn(d.a, t, n, i, d.b.video.timestampOffset) })), kn(d, t, d.ce.bind(d, t, e))) } function xn(a, e) { return "text" == e ? a.a ? (a.m.c(), a.a.remove(0, 1 / 0)) : Promise.resolve() : kn(a, e, a.de.bind(a, e, 0, a.g.duration)) } function kn(a, e, t) { if (a.v) return Promise.reject(); if (t = { start: t, p: new ue }, a.c[e].push(t), 1 == a.c[e].length) try { t.start() } catch (n) { "QuotaExceededError" == n.name ? t.p.reject(new le(2, 3, 3017, e)) : t.p.reject(new le(2, 3, 3015, n)), In(a, e) } return t.p } function Sn(d, e) { if (d.v) return Promise.reject(); var t = [], r; for (r in d.b) { var o = new ue, i = { start: function (t) { t.resolve() }.bind(null, o), p: o }; d.c[r].push(i), t.push(o), 1 == d.c[r].length && i.start() } return Promise.all(t).then(function () { try { e() } catch (e) { var t = Promise.reject(new le(2, 3, 3015, e)) } for (var a in this.b) In(this, a); return t }.bind(d), function () { return Promise.reject() }.bind(d)) } function In(a, e) { a.c[e].shift(); var t = a.c[e][0]; if (t) try { t.start() } catch (n) { t.p.reject(new le(2, 3, 3015, n)), In(a, e) } } function An(a, n) { return a = _n(a), n = _n(n), a.split("-")[0] == n.split("-")[0] } function Cn(a, i) { a = _n(a), i = _n(i); var d = a.split("-"), n = i.split("-"); return d[0] == n[0] && 1 == d.length && 2 == n.length } function _n(a) { var n = a.split("-"); return a = n[0] || "", n = n[1] || "", a = a.toLowerCase(), a = bn.get(a) || a, (n = n.toUpperCase()) ? a + "-" + n : a } function wn(t) { return t.language ? _n(t.language) : t.audio && t.audio.language ? _n(t.audio.language) : t.video && t.video.language ? _n(t.video.language) : "und" } function Rn(d, e) { for (var t = _n(d), n = new Set, p = id(e), l = p.next(); !l.done; l = p.next())n.add(_n(l.value)); for (l = (p = id(n)).next(); !l.done; l = p.next())if ((l = l.value) == t) return l; for (l = (p = id(n)).next(); !l.done; l = p.next())if (Cn(l = l.value, t)) return l; for (l = (p = id(n)).next(); !l.done; l = p.next()) { var u = l = l.value, c = t; if (u = _n(u), c = _n(c), u = u.split("-"), c = c.split("-"), 2 == u.length && 2 == c.length && u[0] == c[0]) return l } for (l = (n = id(n)).next(); !l.done; l = n.next())if (Cn(t, p = l.value)) return p; return null } function Pn(a, e, t) { function n(a, e, t) { return a >= e && a <= t } var r = a.video; return !(r && r.width && r.height && !(n(r.width, e.minWidth, Math.min(e.maxWidth, t.width)) && n(r.height, e.minHeight, Math.min(e.maxHeight, t.height)) && n(r.width * r.height, e.minPixels, e.maxPixels)) || !n(a.bandwidth, e.minBandwidth, e.maxBandwidth)) } function Dn(a, d, t) { var n = !1; return a.forEach(function (a) { var e = a.allowedByApplication; a.allowedByApplication = Pn(a, d, t), e != a.allowedByApplication && (n = !0) }), n } function Nn(a, e, t, n) { n.variants = n.variants.filter(function (n) { if (a && a.N && !St(a, n)) return !1; var d = n.audio; return n = n.video, !(d && !mn(d) || n && !mn(n) || d && e && !On(d, e) || n && t && !On(n, t)) }), n.textStreams = n.textStreams.filter(function (t) { return Wt(qe(t.mimeType, t.codecs)) }) } function On(a, e) { return a.mimeType == e.mimeType && a.codecs.split(".")[0] == e.codecs.split(".")[0] } function Mn(d) { var p = d.audio, t = d.video, n = p ? p.codecs : null, r = t ? t.codecs : null, i = []; r && i.push(r), n && i.push(n); var a = []; t && a.push(t.mimeType), p && a.push(p.mimeType), a = a[0] || null; var l = []; p && l.push(p.kind), t && l.push(t.kind), l = l[0] || null; var c = new Set; return p && p.roles.forEach(function (t) { return c.add(t) }), t && t.roles.forEach(function (t) { return c.add(t) }), d = { id: d.id, active: !1, type: "variant", bandwidth: d.bandwidth, language: d.language, label: null, kind: l, width: null, height: null, frameRate: null, mimeType: a, codecs: i.join(", "), audioCodec: n, videoCodec: r, primary: d.primary, roles: Array.from(c), audioRoles: null, videoId: null, audioId: null, channelsCount: null, audioBandwidth: null, videoBandwidth: null, originalVideoId: null, originalAudioId: null, originalTextId: null }, t && (d.videoId = t.id, d.originalVideoId = t.originalId, d.width = t.width || null, d.height = t.height || null, d.frameRate = t.frameRate || null, d.videoBandwidth = t.bandwidth || null), p && (d.audioId = p.id, d.originalAudioId = p.originalId, d.channelsCount = p.channelsCount, d.audioBandwidth = p.bandwidth || null, d.label = p.label, d.audioRoles = p.roles), d } function Un(t) { return { id: t.id, active: !1, type: "text", bandwidth: 0, language: t.language, label: t.label, kind: t.kind || null, width: null, height: null, frameRate: null, mimeType: t.mimeType, codecs: t.codecs || null, audioCodec: null, videoCodec: null, primary: t.primary, roles: t.roles, audioRoles: null, videoId: null, audioId: null, channelsCount: null, audioBandwidth: null, videoBandwidth: null, originalVideoId: null, originalAudioId: null, originalTextId: t.originalId } } function Bn(t) { return t.__shaka_id || (t.__shaka_id = Ln++), t.__shaka_id } function jn(t) { return { id: Bn(t), active: !1, type: "", bandwidth: 0, language: _n(t.language), label: t.label, kind: t.kind, width: null, height: null, frameRate: null, mimeType: null, codecs: null, audioCodec: null, videoCodec: null, primary: !1, roles: [], audioRoles: null, videoId: null, audioId: null, channelsCount: null, audioBandwidth: null, videoBandwidth: null, originalVideoId: null, originalAudioId: null, originalTextId: null } } function Fn(t) { return t.allowedByApplication && t.allowedByKeySystem } function Vn(d, o) { for (var e = d.filter(function (t) { return t.audio && t.audio.channelsCount }), t = new Map, r = (e = id(e)).next(), s; !r.done; r = e.next())s = (r = r.value).audio.channelsCount, t.has(s) || t.set(s, []), t.get(s).push(r); return 0 == (e = Array.from(t.keys())).length ? d : (r = e.filter(function (t) { return t <= o })).length ? t.get(Math.max.apply(null, r)) : t.get(Math.min.apply(null, e)) } function Hn(d, s, t) { var n = d, p = d.filter(function (t) { return t.primary }); p.length && (n = p); var i = n.length ? n[0].language : ""; if (n = n.filter(function (t) { return t.language == i }), s) { var a = Rn(_n(s), d.map(function (t) { return t.language })); a && (n = d.filter(function (t) { return _n(t.language) == a })) } if (t) { if ((d = qn(n, t)).length) return d; } else if ((d = n.filter(function (t) { return 0 == t.roles.length })).length) return d; return (d = n.map(function (t) { return t.roles }).reduce(Ot.uc, [])).length ? qn(n, d[0]) : n } function qn(a, n) { return a.filter(function (t) { return t.roles.includes(n) }) } function zn(a, e, t) { for (var n = 0; n < t.length; n++)if (t[n].audio == a && t[n].video == e) return t[n]; return null } function Gn() { this.h = null, this.f = !1, this.b = new B, this.c = [], this.i = !1, this.a = this.g = null } function Xn(a, e) { return a && (e = e.filter(function (e) { return Pn(e, a, { width: 1 / 0, height: 1 / 0 }) })), e.sort(function (a, e) { return a.bandwidth - e.bandwidth }) } function Wn(a, e) { this.a = a, this.b = e } function Yn(d, e) { var t = new Wn(2, 6), n = tl, r = n.a, i = t.b - r.b; (0 < (t.a - r.a || i) ? n.c : n.b)(n.a, t, d, e) } function Qn(a, e, t, n) { F([t, "has been deprecated and will be removed in", e, ". We are currently at version", a, ". Additional information:", n].join(" ")) } function Jn(a, e, t, n) { j([t, "has been deprecated and has been removed in", e, ". We are now at version", a, ". Additional information:", n].join("")) } function $n(t) { return JSON.stringify(t, function (a, e) { if ("function" != typeof e) { if (e instanceof Event || e instanceof be) { var t = {}, d; for (d in e) { var o = e[d]; o && "object" == typeof o ? "detail" == d && (t[d] = o) : d in Event || (t[d] = o) } return t } if (e instanceof TimeRanges) for (t = { __type__: "TimeRanges", length: e.length, start: [], end: [] }, d = 0; d < e.length; ++d)t.start.push(e.start(d)), t.end.push(e.end(d)); else t = e instanceof Uint8Array ? { __type__: "Uint8Array", entries: Array.from(e) } : "number" == typeof e ? isNaN(e) ? "NaN" : isFinite(e) ? e : 0 > e ? "-Infinity" : "Infinity" : e; return t } }) } function Zn(t) { return JSON.parse(t, function (a, e) { return "NaN" == e ? NaN : "-Infinity" == e ? -1 / 0 : "Infinity" == e ? 1 / 0 : e && "object" == typeof e && "TimeRanges" == e.__type__ ? function (a) { return { length: a.length, start: function (e) { return a.start[e] }, end: function (e) { return a.end[e] } } }(e) : e && "object" == typeof e && "Uint8Array" == e.__type__ ? new Uint8Array(e.entries) : e }) } function er(d, e, t, n, r, i) { this.N = d, this.f = new ee(e), this.S = t, this.j = !1, this.F = n, this.K = r, this.w = i, this.b = this.h = !1, this.C = "", this.i = null, this.m = this.Ld.bind(this), this.o = this.gf.bind(this), this.a = { video: {}, player: {} }, this.v = 0, this.c = {}, this.g = null } function tr(a) { var e = nl; e.removeUpdateListener(a.m), e.removeMessageListener("urn:x-cast:com.google.shaka.v2", a.o) } function pr(a) { for (var e in a.c) { var t = a.c[e]; delete a.c[e], t.reject(new le(1, 7, 7e3)) } } function mr(t) { t = $n(t), nl.sendMessage("urn:x-cast:com.google.shaka.v2", t, function () { }, V) } function br(a, e, t) { ve.call(this), this.c = a, this.b = e, this.i = this.g = this.f = this.j = this.h = null, this.a = new er(t, this.Qf.bind(this), this.Rf.bind(this), this.Sf.bind(this), this.Tf.bind(this), this.yd.bind(this)), function (a) { for (var e in a.a.init(), a.i = new Le, al.forEach(function (t) { De(this.i, this.c, t, this.jg.bind(this)) }.bind(a)), or.forEach(function (t) { De(this.i, this.b, t, this.vf.bind(this)) }.bind(a)), a.h = {}, a.c) Object.defineProperty(a.h, e, { configurable: !1, enumerable: !0, get: a.ig.bind(a, e), set: a.kg.bind(a, e) }); for (var t in a.j = {}, a.b) Object.defineProperty(a.j, t, { configurable: !1, enumerable: !0, get: a.Sd.bind(a, t) }); a.f = new ve, a.f.Sb = a.h, a.g = new ve, a.g.Sb = a.j }(this) } function vr(a, e, t, n) { var r = this; ve.call(this), this.a = a, this.b = e, this.c = new Le, this.w = { video: a, player: e }, this.C = t || function () { }, this.F = n || function (t) { return t }, this.o = !1, this.h = !0, this.g = 0, this.m = !1, this.j = !0, this.i = this.f = null, this.v = new ee(function () { Er(r) }), function (a) { var e = cast.receiver.CastReceiverManager.getInstance(); e.onSenderConnected = a.Od.bind(a), e.onSenderDisconnected = a.Od.bind(a), e.onSystemVolumeChanged = a.ye.bind(a), a.i = e.getCastMessageBus("urn:x-cast:com.google.cast.media"), a.i.onMessage = a.bf.bind(a), a.f = e.getCastMessageBus("urn:x-cast:com.google.shaka.v2"), a.f.onMessage = a.nf.bind(a), e.start(), al.forEach(function (t) { De(this.c, this.a, t, this.Ud.bind(this, "video")) }.bind(a)), or.forEach(function (t) { De(this.c, this.b, t, this.Ud.bind(this, "player")) }.bind(a)), cast.__platform__ && cast.__platform__.canDisplayType("video/mp4; codecs=\"avc1.640028\"; width=3840; height=2160") ? a.b.fd(3840, 2160) : a.b.fd(1920, 1080), De(a.c, a.a, "loadeddata", function () { this.m = !0 }.bind(a)), De(a.c, a.b, "loading", function () { this.h = !1, Tr(this) }.bind(a)), De(a.c, a.a, "playing", function () { this.h = !1, Tr(this) }.bind(a)), De(a.c, a.a, "pause", function () { Tr(this) }.bind(a)), De(a.c, a.b, "unloading", function () { this.h = !0, Tr(this) }.bind(a)), De(a.c, a.a, "ended", function () { var t = this; new ee(function () { t.a && t.a.ended && (t.h = !0, Tr(t)) }).O(5) }.bind(a)) }(this) } function Tr(t) { Promise.resolve().then(function () { this.b && (this.dispatchEvent(new be("caststatuschanged")), xr(this) || Ir(this, 0)) }.bind(t)) } function Er(a) { a.v.O(.5); var i = { video: {}, player: {} }; if (rr.forEach(function (t) { i.video[t] = this.a[t] }.bind(a)), a.b.U()) for (var e in ur) 0 == a.g % ur[e] && (i.player[e] = a.b[e]()); for (var t in sr) 0 == a.g % sr[t] && (i.player[t] = a.b[t]()); (e = cast.receiver.CastReceiverManager.getInstance().getSystemVolume()) && (i.video.volume = e.level, i.video.muted = e.muted), a.m && (a.g += 1), Sr(a, { type: "update", update: i }, a.f), xr(a) } function xr(t) { return t.j && (t.a.duration || t.b.U()) && (kr(t), t.j = !1, !0) } function kr(a) { var e = { contentId: a.b.$b(), streamType: a.b.U() ? "LIVE" : "BUFFERED", duration: a.a.duration, contentType: "" }; Ir(a, 0, e) } function Sr(a, i, t, n) { a.o && (a = $n(i), n ? t.getCastChannel(n).send(a) : t.broadcast(a)) } function Ir(a, e, t) { var n = a.a.playbackRate, d = il; n = { mediaSessionId: 0, playbackRate: n, playerState: d = a.h ? d.IDLE : a.b.Jc() ? d.he : a.a.paused ? d.je : d.ke, currentTime: a.a.currentTime, supportedMediaCommands: 15, volume: { level: a.a.volume, muted: a.a.muted } }, t && (n.media = t), Sr(a, { requestId: e, type: "MEDIA_STATUS", status: [n] }, a.i) } function Ar(d, s, p) { var l = function (a) { for (var i = [], t = (a = id(a)).next(); !t.done; t = a.next())(t = Cr(t.value)) && i.push(t); return i }(d), u = null; d = []; var c = [], f = new Set(l.map(function (t) { return t.keyId })); if (f.delete(null), 1 < f.size) throw new le(2, 4, 4010); if (p || (c = l.filter(function (t) { return "urn:mpeg:dash:mp4protection:2011" != t.Zd || (u = t.init || u, !1) })).length && 0 == (d = function (d, e, t) { for (var s = [], r = (t = id(t)).next(); !r.done; r = t.next()) { r = r.value; var p = Mr.get(r.Zd); if (p) { var l = Bt(p, r.init || d); (p = Nr.get(p)) && (l.licenseServerUri = p(r)), s.push(l) } else for (r = id(r = e(r.node) || []), l = r.next(); !l.done; l = r.next())s.push(l.value) } return s }(u, s, c)).length && (d = [Bt("", u)]), l.length && (p || !c.length)) for (d = [], p = (s = id(Mr.values())).next(); !p.done; p = s.next())"org.w3.clearkey" != (p = p.value) && d.push(Bt(p, u)); if (f = Array.from(f)[0] || null) for (p = (s = id(d)).next(); !p.done; p = s.next())for (l = (p = id(p.value.initData)).next(); !l.done; l = p.next())l.value.keyId = f; return { sd: f, qg: u, drmInfos: d, xd: !0 } } function Cr(a) { var e = a.getAttribute("schemeIdUri"), d = _r.getAttributeNS(a, "urn:mpeg:cenc:2013", "default_KID"), o = _r.wd(a, "urn:mpeg:cenc:2013", "pssh").map(_r.ac); if (!e) return null; if (e = e.toLowerCase(), d && (d = d.replace(/-/g, "").toLowerCase()).includes(" ")) throw new le(2, 4, 4009); var r = []; try { r = o.map(function (t) { return { initDataType: "cenc", initData: ot(t), keyId: null } }) } catch (t) { throw new le(2, 4, 4007) } return { node: a, Zd: e, keyId: d, init: 0 < r.length ? r : null } } function wr(e, t, n, r, i) { var d = { RepresentationID: t, Number: n, Bandwidth: r, Time: i }; return e.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g, function (e, o, n, s) { if ("$$" == e) return "$"; var i = d[o]; if (null == i) return e; switch ("RepresentationID" == o && n && (n = void 0), "Time" == o && (i = Math.round(i)), s) { case void 0: case "d": case "i": case "u": e = i.toString(); break; case "o": e = i.toString(8); break; case "x": e = i.toString(16); break; case "X": e = i.toString(16).toUpperCase(); break; default: e = i.toString(); }return n = ed.parseInt(n, 10) || 1, Array(Math.max(0, n - e.length) + 1).join("0") + e }) } function Rr(m, e) { var t = Lr(m, e, "timescale"), g = 1; t && (g = _r.jc(t) || 1), t = Lr(m, e, "duration"), (t = _r.jc(t || "")) && (t /= g); var y = Lr(m, e, "startNumber"), b = +Lr(m, e, "presentationTimeOffset") || 0, a = _r.rb(y || ""); null != y && null != a || (a = 1); var T = Dr(m, e, "SegmentTimeline"); if (y = null, T) { y = g; var E = m.R.duration || 1 / 0; T = _r.P(T, "S"); for (var u = [], c = 0, x = 0; x < T.length; ++x) { var k = T[x], S = _r.H(k, "t", _r.rb), I = _r.H(k, "d", _r.rb); if (k = _r.H(k, "r", _r.parseInt), null != S && (S -= b), !I) break; if (S = null == S ? c : S, 0 > (k = k || 0)) if (x + 1 < T.length) { if (null == (k = _r.H(T[x + 1], "t", _r.rb))) break; if (S >= k) break; k = Math.ceil((k - S) / I) - 1 } else { if (1 / 0 == E) break; if (S / y >= E) break; k = Math.ceil((E * y - S) / I) - 1 } 0 < u.length && S != c && (u[u.length - 1].end = S / y); for (var p = 0; p <= k; ++p)c = S + I, u.push({ start: S / y, end: c / y, fg: S }), S = c } y = u } return { timescale: g, Z: t, Wa: a, ia: b / g || 0, od: b, M: y } } function Lr(a, e, t) { return [e(a.B), e(a.ba), e(a.ga)].filter(Ot.Da).map(function (a) { return a.getAttribute(t) }).reduce(function (a, e) { return a || e }) } function Dr(a, e, t) { return [e(a.B), e(a.ba), e(a.ga)].filter(Ot.Da).map(function (a) { return _r.Yb(a, t) }).reduce(function (a, e) { return a || e }) } function Pr(d, e, t, n, r, i) { if (i = void 0 === i ? 0 : i, _r.getAttributeNS(d, "http://www.w3.org/1999/xlink", "href")) { var p = function (d, e, t, n, p, i) { for (var a = _r.getAttributeNS(d, "http://www.w3.org/1999/xlink", "href"), r = _r.getAttributeNS(d, "http://www.w3.org/1999/xlink", "actuate") || "onRequest", o = 0, s; o < d.attributes.length; o++)s = d.attributes[o], "http://www.w3.org/1999/xlink" == s.namespaceURI && (d.removeAttributeNS(s.namespaceURI, s.localName), --o); if (5 <= i) return pe(new le(2, 4, 4028)); if ("onLoad" != r) return pe(new le(2, 4, 4027)); var f = Ut([n], [a]); return p.request(0, _e(f, e)).T(function (n) { if (!(n = _r.Qd(n.data, d.tagName))) return pe(new le(2, 4, 4001, a)); for (; d.childNodes.length;)d.removeChild(d.childNodes[0]); for (; n.childNodes.length;) { var o = n.childNodes[0]; n.removeChild(o), d.appendChild(o) } for (o = 0; o < n.attributes.length; o++) { var l = n.attributes[o].nodeName, u = n.getAttribute(l); d.setAttribute(l, u) } return Pr(d, e, t, f[0], p, i + 1) }) }(d, e, t, n, r, i); return t && (p = p.T(void 0, function () { return Pr(d, e, t, n, r, i) })), p } p = []; for (var l = 0, c; l < d.childNodes.length; l++)c = d.childNodes[l], c instanceof Element && ("urn:mpeg:dash:resolve-to-zero:2013" == _r.getAttributeNS(c, "http://www.w3.org/1999/xlink", "href") ? (d.removeChild(c), --l) : "SegmentTimeline" != c.tagName && p.push(Pr(c, e, t, n, r, i))); return ge(p).T(function () { return d }) } function Ur(a, e, t) { this.c = a, this.b = e, this.a = t } function Br(d, e, t, n, r, i) { this.position = d, this.startTime = e, this.endTime = t, this.c = n, this.b = r, this.a = i } function jr(a, e) { this.I = a, this.b = e == Or, this.a = 0 } function Fr() { throw new le(2, 3, 3e3) } function Vr() { this.c = [], this.b = [], this.a = !1 } function Kr(t) { for (; t.reader.pa() && !t.parser.a;)t.parser.ic(t.start, t.reader, t.partialOkay) } function Hr(a) { for (var e = a.reader.D(); 0 < e && !a.parser.a; --e)a.parser.ic(a.start, a.reader, a.partialOkay) } function Gr(a) { return function (e) { a(e.reader.Va(e.reader.I.byteLength - e.reader.aa())) } } function Xr(a) { for (var e = 0, i = 0; i < a.length; i++)e = e << 8 | a.charCodeAt(i); return e } function Wr(t) { return String.fromCharCode(255 & t >> 24, 255 & t >> 16, 255 & t >> 8, 255 & t) } function Yr(d, o, t, n) { var e = new Vr().ca("sidx", function (i) { a = function (d, p, t, n) { var r = []; n.reader.J(4); var i = n.reader.D(); if (0 == i) throw new le(2, 3, 3005); if (0 == n.version) var a = n.reader.D(), m = n.reader.D(); else a = n.reader.ub(), m = n.reader.ub(); n.reader.J(2); var g = n.reader.Jb(); for (d = d + n.size + m, m = 0; m < g; m++) { var u = n.reader.D(), y = (2147483648 & u) >>> 31; u &= 2147483647; var l = n.reader.D(); if (n.reader.J(4), 1 == y) throw new le(2, 3, 3006); r.push(new Br(r.length, a / i - p, (a + l) / i - p, function () { return t }, d, d + u - 1)), a += l, d += u } return n.parser.stop(), r }(o, n, t, i) }), a; if (d && e.parse(d), a) return a; throw new le(2, 3, 3004) } function Qr(t) { this.a = t } function ei(a, e) { for (; a.a.length && a.a[a.a.length - 1].startTime >= e;)a.a.pop(); for (; a.a.length && 0 >= a.a[0].endTime;)a.a.shift(); if (0 != a.a.length) { var t = a.a[a.a.length - 1]; a.a[a.a.length - 1] = new Br(t.position, t.startTime, e, t.c, t.b, t.a) } } function ti(t) { this.b = t, this.a = new jr(t, 0), zr || (zr = [new Uint8Array([255]), new Uint8Array([127, 255]), new Uint8Array([63, 255, 255]), new Uint8Array([31, 255, 255, 255]), new Uint8Array([15, 255, 255, 255, 255]), new Uint8Array([7, 255, 255, 255, 255, 255]), new Uint8Array([3, 255, 255, 255, 255, 255, 255]), new Uint8Array([1, 255, 255, 255, 255, 255, 255, 255])]) } function ni(a) { var e = ri(a); if (7 < e.length) throw new le(2, 3, 3002); for (var d = 0, o = 0; o < e.length; o++)d = 256 * d + e[o]; e = d, d = ri(a); e: { for (o = 0; o < zr.length; o++)if (ut(d, zr[o])) { o = !0; break e } o = !1 } if (o) d = a.b.byteLength - a.a.aa(); else { if (8 == d.length && 224 & d[1]) throw new le(2, 3, 3001); o = d[0] & (1 << 8 - d.length) - 1; for (var s = 1; s < d.length; s++)o = 256 * o + d[s]; d = o } return d = a.a.aa() + d <= a.b.byteLength ? d : a.b.byteLength - a.a.aa(), o = new DataView(a.b.buffer, a.b.byteOffset + a.a.aa(), d), a.a.J(d), new ii(e, o) } function ri(a) { var e = a.a.ha(), i; for (i = 1; 8 >= i && !(e & 1 << 8 - i); i++); if (8 < i) throw new le(2, 3, 3002); var d = new Uint8Array(i); for (d[0] = e, e = 1; e < i; e++)d[e] = a.a.ha(); return d } function ii(a, e) { this.id = a, this.a = e } function ai(a) { if (8 < a.a.byteLength) throw new le(2, 3, 3002); if (8 == a.a.byteLength && 224 & a.a.getUint8(0)) throw new le(2, 3, 3001); for (var e = 0, i = 0; i < a.a.byteLength; i++)e = 256 * e + a.a.getUint8(i); return e } function oi() { } function si(a) { var i = new ti(a.a); if (179 != (a = ni(i)).id) throw new le(2, 3, 3013); if (a = ai(a), 183 != (i = ni(i)).id) throw new le(2, 3, 3012); i = new ti(i.a); for (var d = 0, o; i.pa();)if (o = ni(i), 241 == o.id) { d = ai(o); break } return { gg: a, Af: d } } function ui(d, e) { var t = Dr(d, e, "Initialization"); if (!t) return null; var o = d.B.la, s = t.getAttribute("sourceURL"); s && (o = Ut(d.B.la, [s])), s = 0; var p = null; return (t = _r.H(t, "range", _r.kc)) && (s = t.start, p = t.end), new Ur(function () { return o }, s, p) } function ci(p, e, t, n, r, i, a, o) { var s = p.presentationTimeline, u = !p.gb || !p.R.Lc, c = p.R.start, l = p.R.duration, f = e, m = null; return { createSegmentIndex: function () { var d = [f(n, r, i), "webm" == a ? f(t.c(), t.b, t.a) : null]; return f = null, Promise.all(d).then(function (i) { var d = i[0]; i = i[1] || null, d = "mp4" == a ? Yr(d, r, n, o) : new oi().parse(d, i, n, o), s.ob(d, c), m = new Qr(d), u && ei(m, l) }) }, findSegmentPosition: function (t) { return m.find(t) }, getSegmentReference: function (t) { return m.get(t) } } } function li(t) { return t.Lb } function fi(d, e) { var t = ui(d, hi), n = function (a) { return [a.B.Ga, a.ba.Ga, a.ga.Ga].filter(Ot.Da).map(function (t) { return _r.P(t, "SegmentURL") }).reduce(function (a, e) { return 0 < a.length ? a : e }).map(function (e) { return e.getAttribute("indexRange") && !a.Dd && (a.Dd = !0), { $e: e.getAttribute("media"), start: (e = _r.H(e, "mediaRange", _r.kc, { start: 0, end: null })).start, end: e.end } }) }(d), s = Rr(d, hi), p = s.Wa; 0 == p && (p = 1); var l = 0; if (s.Z ? l = s.Z * (p - 1) : s.M && 0 < s.M.length && (l = s.M[0].start), !(n = { Z: s.Z, startTime: l, Wa: p, ia: s.ia, M: s.M, mb: n }).Z && !n.M && 1 < n.mb.length) throw new le(2, 4, 4002); if (!n.Z && !d.R.duration && !n.M && 1 == n.mb.length) throw new le(2, 4, 4002); if (n.M && 0 == n.M.length) throw new le(2, 4, 4002); return p = s = null, d.ga.id && d.B.id && (s = e[p = d.ga.id + "," + d.B.id]), l = function (d, e, t, n) { var r = n.mb.length; n.M && n.M.length != n.mb.length && (r = Math.min(n.M.length, n.mb.length)); for (var p = [], a = n.startTime, f = 0; f < r; f++) { var m = n.mb[f], c = Ut(t, [m.$e]), l; l = null == n.Z ? n.M ? n.M[f].end : a + d : a + n.Z, p.push(new Br(f + e, a, l, function (t) { return t }.bind(null, c), m.start, m.end)), a = l } return p }(d.R.duration, n.Wa, d.B.la, n), s ? (s.Pc(l), p = d.presentationTimeline.Db(), s.zc(p - d.R.start)) : (d.presentationTimeline.ob(l, d.R.start), s = new Qr(l), p && d.gb && (e[p] = s)), d.gb && d.R.Lc || ei(s, d.R.duration), { createSegmentIndex: Promise.resolve.bind(Promise), findSegmentPosition: s.find.bind(s), getSegmentReference: s.get.bind(s), initSegmentReference: t, ia: n.ia } } function hi(t) { return t.Ga } function di(d, p, l, u) { var c = function (a) { var d = Lr(a, pi, "initialization"); if (!d) return null; var t = a.B.id, n = a.bandwidth || null, r = a.B.la; return new Ur(function () { var a = wr(d, t, null, n, null); return Ut(r, [a]) }, 0, null) }(d), i = Rr(d, pi), f = Lr(d, pi, "media"), m = Lr(d, pi, "index"); if (f = (i = { Z: i.Z, timescale: i.timescale, Wa: i.Wa, ia: i.ia, od: i.od, M: i.M, Oc: f, Fb: m }).Fb ? 1 : 0, f += i.M ? 1 : 0, 0 == (f += i.Z ? 1 : 0)) throw new le(2, 4, 4002); if (1 != f && (i.Fb && (i.M = null), i.Z = null), !i.Fb && !i.Oc) throw new le(2, 4, 4002); if (i.Fb) { if ("mp4" != (l = d.B.mimeType.split("/")[1]) && "webm" != l) throw new le(2, 4, 4006); if ("webm" == l && !c) throw new le(2, 4, 4005); u = wr(i.Fb, d.B.id, null, d.bandwidth || null, null), d = ci(d, p, c, u = Ut(d.B.la, [u]), 0, null, l, i.ia) } else i.Z ? (u || (d.presentationTimeline.Rc(i.Z), d.presentationTimeline.Sc(d.R.start)), d = function (d, e) { var p = d.R.duration, n = e.Z, r = e.Wa, i = e.timescale, a = e.Oc, o = d.bandwidth || null, s = d.B.id, l = d.B.la; return { createSegmentIndex: Promise.resolve.bind(Promise), findSegmentPosition: function (t) { return 0 > t || p && t >= p ? null : Math.floor(t / n) }, getSegmentReference: function (d) { var e = d * n, t = e + n; return p && (t = Math.min(t, p)), 0 > t || p && e >= p ? null : new Br(d, e, t, function () { var t = wr(a, s, d + r, o, e * i); return Ut(l, [t]) }, 0, null) } } }(d, i)) : (f = p = null, d.ga.id && d.B.id && (p = l[f = d.ga.id + "," + d.B.id]), m = function (a, e) { for (var t = [], n = 0, d; n < e.M.length; n++)d = n + e.Wa, t.push(new Br(d, e.M[n].start, e.M[n].end, function (d, o, t, n, r, i) { return Ut(n, [d = wr(d, o, r, t, i)]).map(function (t) { return t.toString() }) }.bind(null, e.Oc, a.B.id, a.bandwidth || null, a.B.la, d, e.M[n].fg + e.od), 0, null)); return t }(d, i), u = !d.gb || !d.R.Lc, p ? (u && ei(new Qr(m), d.R.duration), p.Pc(m), l = d.presentationTimeline.Db(), p.zc(l - d.R.start)) : (d.presentationTimeline.ob(m, d.R.start), p = new Qr(m), f && d.gb && (l[f] = p)), u && ei(p, d.R.duration), d = { createSegmentIndex: Promise.resolve.bind(Promise), findSegmentPosition: p.find.bind(p), getSegmentReference: p.get.bind(p) }); return { createSegmentIndex: d.createSegmentIndex, findSegmentPosition: d.findSegmentPosition, getSegmentReference: d.getSegmentReference, initSegmentReference: c, ia: i.ia } } function pi(t) { return t.Nb } function vi(a, e, t) { this.f = a, this.lc = e, this.h = this.g = 1 / 0, this.a = 1, this.b = this.c = null, this.j = 0, this.m = !0, this.i = 0, this.o = void 0 === t || t } function yi(a, i, t, n) { return a = _e(a, n), 0 == i && null == t || (a.headers.Range = t ? "bytes=" + i + "-" + t : "bytes=" + i + "-"), a } function gi() { var t = this; this.a = this.b = null, this.f = [], this.c = null, this.j = [], this.h = 1, this.m = {}, this.o = 0, this.v = new N(5), this.i = new ee(function () { !function (a) { rd(function e() { var i, d; return od(e, function (e) { switch (e.l) { case 1: return i = 0, b(e, 2), dd(e, bi(a), 4); case 4: i = e.s, T(e, 3); break; case 2: d = x(e), a.a && (d.severity = 1, a.a.onError(d)); case 3: if (!a.a) return e.return(); ki(a, i), E(e); } }) }) }(t) }), this.g = new Se } function bi(a) { var e = Date.now(), t = a.a.networkingEngine.request(0, _e(a.f, a.b.retryParameters)); return Ie(a.g, t), t.promise.then(function (e) { if (a.a) return e.uri && !a.f.includes(e.uri) && a.f.unshift(e.uri), function (a, e, i) { if (!(e = _r.Qd(e, "MPD"))) throw new le(2, 4, 4001, i); return e = Pr(e, a.b.retryParameters, a.b.dash.xlinkFailGracefully, i, a.a.networkingEngine), Ie(a.g, e), e.promise.then(function (e) { return function (k, e, t) { return rd(function n() { var B, V, K, H, q, z, G, X, W, Y, Q, J, $, Z, ee, te, ae, ne, ie, re, de, oe; return od(n, function (a) { switch (a.l) { case 1: H = Ot, z = [t], 0 < (G = (q = _r).P(e, "Location").map(q.ac).filter(H.Da)).length && (X = Ut(z, G), z = k.f = X), W = q.P(e, "BaseURL").map(q.ac), Y = Ut(z, W), k.b.dash.ignoreMinBufferTime || (Q = q.H(e, "minBufferTime", q.za)), k.o = q.H(e, "minimumUpdatePeriod", q.za, -1), J = q.H(e, "availabilityStartTime", q.sf), $ = q.H(e, "timeShiftBufferDepth", q.za), Z = q.H(e, "suggestedPresentationDelay", q.za), ee = q.H(e, "maxSegmentDuration", q.za), te = e.getAttribute("type") || "static", k.c ? ae = k.c.presentationTimeline : (ne = Math.max(k.b.dash.defaultPresentationDelay, 1.5 * Q), ae = new vi(J, null == Z ? ne : Z, k.b.dash.autoCorrectDrift)); for (var n = { gb: "static" != te, presentationTimeline: ae, ga: null, R: null, ba: null, B: null, bandwidth: 0, Dd: !1 }, i = Y, r = _r.H(e, "mediaPresentationDuration", _r.za), d = [], o = 0, s = _r.P(e, "Period"), p = 0, l; p < s.length; p++) { l = s[p], o = _r.H(l, "start", _r.za, o); var u = _r.H(l, "duration", _r.za), c = null; if (p != s.length - 1) { var f = _r.H(s[p + 1], "start", _r.za); null != f && (c = f - o) } else null != r && (c = r - o); if (null == c && (c = u), l = wi(k, n, i, { start: o, duration: c, node: l, Lc: null == c || p == s.length - 1 }), d.push(l), u = n.ga.id, k.j.includes(u) || (k.j.push(u), k.c && (k.a.filterNewPeriod(l), k.c.periods.push(l))), null == c) { o = null; break } o += c } if (null == k.c && k.a.filterAllPeriods(d), null == r ? (B = d, V = o, K = !0) : (B = d, V = r, K = !1), ie = V, re = B, ae.Ob("static" == te), "static" != te && K || ae.ta(ie || 1 / 0), ae.U() && !isNaN(k.b.availabilityWindowOverride) && ($ = k.b.availabilityWindowOverride), null == $ && ($ = 1 / 0), ae.hd($), ae.Rc(ee || 1), k.c) { a.A(0); break } if (k.c = { presentationTimeline: ae, periods: re, offlineSessionIds: [], minBufferTime: Q || 0 }, !ae.fe()) { a.A(0); break } return de = q.P(e, "UTCTiming"), dd(a, function (a, i, e) { e = e.map(function (t) { return { scheme: t.getAttribute("schemeIdUri"), value: t.getAttribute("value") } }); var t = a.b.dash.clockSyncUri; return !e.length && t && e.push({ scheme: "urn:mpeg:dash:utc:http-head:2014", value: t }), Ot.ve(e, function (t) { var a = t.scheme; switch (t = t.value, a) { case "urn:mpeg:dash:utc:http-head:2014": case "urn:mpeg:dash:utc:http-head:2012": return Si(this, i, t, "HEAD"); case "urn:mpeg:dash:utc:http-xsdate:2014": case "urn:mpeg:dash:utc:http-iso:2014": case "urn:mpeg:dash:utc:http-xsdate:2012": case "urn:mpeg:dash:utc:http-iso:2012": return Si(this, i, t, "GET"); case "urn:mpeg:dash:utc:direct:2014": case "urn:mpeg:dash:utc:direct:2012": return a = Date.parse(t), isNaN(a) ? 0 : a - Date.now(); case "urn:mpeg:dash:utc:http-ntp:2014": case "urn:mpeg:dash:utc:ntp:2014": case "urn:mpeg:dash:utc:sntp:2014": return F("NTP UTCTiming scheme is not supported"), Promise.reject(); default: return F("Unrecognized scheme in UTCTiming element", a), Promise.reject(); } }.bind(a)).catch(function () { return F("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"), 0 }) }(k, Y, de), 4); case 4: if (oe = a.s, !k.a) return a.return(); ae.ae(oe), E(a); } }) }) }(a, e, i) }) }(a, e.data, e.uri) }).then(function () { var t = (Date.now() - e) / 1e3; return O(a.v, 1, t), t }) } function wi(d, p, l, u) { if (p.ga = xi(u.node, null, l), p.R = u, p.ga.id || (p.ga.id = "__shaka_period_" + u.start), _r.P(u.node, "EventStream").forEach(d.tf.bind(d, u.start, u.duration)), l = _r.P(u.node, "AdaptationSet").map(d.rf.bind(d, p)).filter(Ot.Da), p.gb) { p = []; for (var r = id(l), c = r.next(); !c.done; c = r.next())for (var f = (c = id(c.value.Df)).next(); !f.done; f = c.next())p.push(f.value); if (p.length != new Set(p).size) throw new le(2, 4, 4018) } var m = l.filter(function (t) { return !t.md }); if (l.filter(function (t) { return t.md }).forEach(function (a) { var i = a.streams[0], t = a.md; m.forEach(function (a) { a.id == t && a.streams.forEach(function (t) { t.trickModeVideo = i }) }) }), p = Ti(m, "video"), r = Ti(m, "audio"), !p.length && !r.length) throw new le(2, 4, 4004); for (r.length || (r = [null]), p.length || (p = [null]), l = [], c = 0; c < r.length; c++)for (f = 0; f < p.length; f++)Ei(d, r[c], p[f], l); for (d = Ti(m, "text"), p = [], r = 0; r < d.length; r++)p.push.apply(p, d[r].streams); return { startTime: u.start, textStreams: p, variants: l } } function Ti(a, n) { return a.filter(function (t) { return t.contentType == n }) } function Ei(d, e, t, n) { if (e || t) if (e && t) { var r = e.drmInfos, p = t.drmInfos; if (!r.length || !p.length || 0 < It(r, p).length) { p = It(e.drmInfos, t.drmInfos); for (var l = 0; l < e.streams.length; l++)for (var u = 0; u < t.streams.length; u++)r = (t.streams[u].bandwidth || 0) + (e.streams[l].bandwidth || 0), r = { id: d.h++, language: e.language, primary: e.Nc || t.Nc, audio: e.streams[l], video: t.streams[u], bandwidth: r, drmInfos: p, allowedByApplication: !0, allowedByKeySystem: !0 }, n.push(r) } } else for (p = e || t, l = 0; l < p.streams.length; l++)r = p.streams[l].bandwidth || 0, r = { id: d.h++, language: p.language || "und", primary: p.Nc, audio: e ? p.streams[l] : null, video: t ? p.streams[l] : null, bandwidth: r, drmInfos: p.drmInfos, allowedByApplication: !0, allowedByKeySystem: !0 }, n.push(r) } function ki(a, e) { 0 > a.o || a.i.O(Math.max(3, a.o - e, M(a.v))) } function xi(d, e, p) { e = e || { contentType: "", mimeType: "", codecs: "", emsgSchemeIdUris: [], frameRate: void 0, Tc: null }, p = p || e.la; var f = _r.rb, r = _r.xe, m = _r.P(d, "BaseURL").map(_r.ac), a = d.getAttribute("contentType") || e.contentType, g = d.getAttribute("mimeType") || e.mimeType, s = d.getAttribute("codecs") || e.codecs; r = _r.H(d, "frameRate", r) || e.frameRate; for (var u = _r.P(d, "InbandEventStream"), y = e.emsgSchemeIdUris.slice(), l = (u = id(u)).next(); !l.done; l = u.next())l = l.value.getAttribute("schemeIdUri"), y.includes(l) || y.push(l); return u = function (a) { for (var i = 0; i < a.length; ++i) { var d = a[i], o = d.getAttribute("schemeIdUri"); if (o && (d = d.getAttribute("value"))) switch (o) { case "urn:mpeg:dash:outputChannelPositionList:2012": return d.trim().split(/ +/).length; case "urn:mpeg:dash:23003:3:audio_channel_configuration:2011": case "urn:dts:dash:audio_channel_configuration:2012": if (!(o = parseInt(d, 10))) continue; return o; case "tag:dolby.com,2014:dash:audio_channel_configuration:2011": case "urn:dolby:dash:audio_channel_configuration:2011": if (o = parseInt(d, 16)) { for (a = 0; o;)1 & o && ++a, o >>= 1; return a } } } return null }(u = _r.P(d, "AudioChannelConfiguration")) || e.Tc, a || (a = Ii(g, s)), { la: Ut(p, m), Lb: _r.Yb(d, "SegmentBase") || e.Lb, Ga: _r.Yb(d, "SegmentList") || e.Ga, Nb: _r.Yb(d, "SegmentTemplate") || e.Nb, width: _r.H(d, "width", f) || e.width, height: _r.H(d, "height", f) || e.height, contentType: a, mimeType: g, codecs: s, frameRate: r, emsgSchemeIdUris: y, id: d.getAttribute("id"), Tc: u } } function Si(a, e, i, n) { return (e = _e(e = Ut(e, [i]), a.b.retryParameters)).method = n, e = a.a.networkingEngine.request(4, e), Ie(a.g, e), e.promise.then(function (t) { if ("HEAD" == n) { if (!t.headers || !t.headers.date) return 0; t = t.headers.date } else t = Qe(t.data); return t = Date.parse(t), isNaN(t) ? 0 : t - Date.now() }) } function Ii(a, e) { return Wt(qe(a, e)) ? "text" : a.split("/")[0] } function Ai(a, e, t, n) { this.b = a, this.type = e, this.a = t, this.segments = n || null } function Ci(a, e, t, n) { this.id = a, this.name = e, this.a = t, this.value = void 0 === n ? null : n } function Pi(a, e) { this.name = a, this.value = e } function _i(a, i, t) { return (a = a.getAttribute(i)) ? a.value : t || null } function Mi(a, e) { this.b = e, this.a = a } function Ni(t) { this.b = t, this.a = 0 } function Oi(t) { Li(t, /[ \t]+/gm) } function Li(a, e) { e.lastIndex = a.a; var t = e.exec(a.b); return t = null == t ? null : { position: t.index, length: t[0].length, Gf: t }, a.a == a.b.length || null == t || t.position != a.a ? null : (a.a += t.length, t.Gf) } function Di(t) { return t.a == t.b.length ? null : (t = Li(t, /[^ \t\n]*/gm)) ? t[0] : null } function ji() { this.a = 0 } function Ui(d, s, p) { var n = (s = (s = Qe(s)).replace(/\r\n|\r(?=[^\n]|$)/gm, "\n").trim()).split(/\n+/m); if (!/^#EXTM3U($|[ \t\n])/m.test(n[0])) throw new le(2, 4, 4015); s = 0; for (var l = 1; l < n.length; l++)if (!mi.Kc(n[l])) { var u = Fi(d, n[l]); if (--d.a, Ri.includes(u.name)) { s = 1; break } "EXT-X-STREAM-INF" == u.name && (l += 1) } for (l = [], u = 1; u < n.length;)if (mi.Kc(n[u])) u += 1; else { var c = Fi(d, n[u]); if (Hi.includes(c.name)) { if (1 != s) throw new le(2, 4, 4017); return new Ai(p, s, l, d = Bi(d, p, n = n.splice(u, n.length - u), l)) } l.push(c), u += 1, "EXT-X-STREAM-INF" == c.name && (c.a.push(new Pi("URI", n[u])), u += 1) } return new Ai(p, s, l) } function Bi(d, e, t, o) { var r = [], i = []; return t.forEach(function (t) { if (/^(#EXT)/.test(t)) t = Fi(d, t), Ri.includes(t.name) ? o.push(t) : i.push(t); else { if (mi.Kc(t)) return []; t = mi.vc(e, t.trim()), r.push(new Mi(t, i)), i = [] } }), r } function Fi(d, e) { var t = d.a++, n = e.match(/^#(EXT[^:]*)(?::(.*))?$/); if (!n) throw new le(2, 4, 4016, e); var p = n[1], a = n[2], l; if (n = [], a) { var c; (c = Li(a = new Ni(a), /^([^,=]+)(?:,|$)/g)) && (l = c[1]); for (var f = /([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g; c = Li(a, f);)n.push(new Pi(c[1], c[2] || c[3])) } return new Ci(t, p, n, l) } function Vi(a) { try { var e = Vi.parse(a); return fe({ uri: a, Xc: a, data: e.data, headers: { "content-type": e.contentType } }) } catch (t) { return pe(t) } } function qi() { var t = this; this.c = this.g = null, this.W = 1, this.C = new Map, this.S = new Set, this.a = new Map, this.b = null, this.v = "", this.o = new ji, this.N = 0, this.h = new ee(function () { !function (a) { rd(function e() { var i, d; return od(e, function (e) { switch (e.l) { case 1: return a.g ? (b(e, 2), dd(e, a.update(), 4)) : e.return(); case 4: i = a.N, a.h.O(i), T(e, 0); break; case 2: (d = x(e)).severity = 1, a.g.onError(d), a.h.O(.1), E(e); } }) }) }(t) }), this.f = la, this.m = null, this.w = 0, this.F = 1 / 0, this.i = new Se, this.K = [], this.j = new Map, this.V = !1 } function zi(d, e) { return rd(function t() { var p, m, g, y, b, v, T, x, k, S; return od(t, function (t) { switch (t.l) { case 1: return p = mi, m = fa, g = e.ne, dd(t, ia(d, g), 2); case 2: if (y = t.s, 1 != (b = Ui(d.o, y.data, y.uri)).type) throw new le(2, 4, 4017); return T = (v = p.Pa(b.a, "EXT-X-MEDIA-SEQUENCE")) ? +v.value : 0, x = e.stream, dd(t, Zi(d, e.pc, b, T, x.mimeType, x.codecs), 3); case 3: k = t.s, e.Mb.a = k, S = k[k.length - 1], p.Pa(b.a, "EXT-X-ENDLIST") && (aa(d, m.Ma), d.b.ta(S.endTime)), E(t); } }) }) } function Gi(t) { t.forEach(function (a) { var e = a.stream.codecs.split(","); e = e.filter(function (t) { return "mp4a.40.34" != t }), a.stream.codecs = e.join(",") }) } function Xi(a, e, t, n, r) { return { id: a.W++, language: e ? e.language : "und", primary: !!e && e.primary || !!t && t.primary, audio: e, video: t, bandwidth: n, drmInfos: r, allowedByApplication: !0, allowedByKeySystem: !0 } } function Wi(p, e, t) { return rd(function n() { var m, g, y, b, v, T, E, x, k; return od(n, function (a) { switch (a.l) { case 1: if (m = na(e, "URI"), p.a.has(m)) return a.return(p.a.get(m)); if (g = na(e, "TYPE").toLowerCase(), y = Vt, "subtitles" == g && (g = y.na), b = _n(_i(e, "LANGUAGE", "und")), v = _i(e, "NAME"), T = e.getAttribute("DEFAULT"), E = e.getAttribute("AUTOSELECT"), x = _i(e, "CHANNELS"), "audio" != g) n = null; else if (x) { var n = x.split("/")[0]; n = parseInt(n, 10) } else n = null; return dd(a, Yi(p, m, t, g, b, !!T || !!E, v, n, null), 2); case 2: return null == (k = a.s) ? a.return(null) : p.a.has(m) ? a.return(p.a.get(m)) : (p.C.set(e.id, k), p.a.set(m, k), a.return(k)); } }) }) } function Yi(d, e, t, n, r, i, a, o, s) { return rd(function u() { var f, E, O, V, H, q, z, G, X, W, Y, Q, B, F, J, $, Z, ee, te, ae, ne, ie, re, de, se; return od(u, function (p) { switch (p.l) { case 1: return E = (f = mi).vc(d.v, e), V = "", dd(p, ia(d, E), 2); case 2: if (q = p.s, E = q.uri, 1 != (O = Ui(d.o, q.data, E)).type) throw new le(2, 4, 4017); z = [], O.segments.forEach(function (t) { t = f.hb(t.b, "EXT-X-KEY"), z.push.apply(z, t) }), G = !1, X = [], W = null; for (var l = id(z), u = l.next(); !u.done; u = l.next())if (Y = u.value, "NONE" != (Q = na(Y, "METHOD"))) { if (G = !0, "AES-128" == Q) return d.V = !0, p.return(null); B = na(Y, "KEYFORMAT"), (J = (F = sa[B]) ? F(Y) : null) && (J.keyIds.length && (W = J.keyIds[0]), X.push(J)) } if (G && !X.length) throw new le(2, 4, 4026); return function (a, e) { var t = fa, d = mi.Pa(e.a, "EXT-X-PLAYLIST-TYPE"), o = mi.Pa(e.a, "EXT-X-ENDLIST"); o = d && "VOD" == d.value || o, d = d && "EVENT" == d.value && !o, d = !o && !d, o ? aa(a, t.Ma) : (aa(a, d ? t.pd : t.ie), t = ra(e.a, "EXT-X-TARGETDURATION"), t = +t.value, a.w = Math.max(t, a.w), a.F = Math.min(t, a.F)) }(d, O), V = function (a, e) { if (1 == e.length) return e[0]; var t = ta(a, e); if (null != t) return t; throw new le(2, 4, 4025, e) }(n, t), dd(p, function (m, e, t, n) { return rd(function r() { var g, y, b, v, T, E, x, k, S, I; return od(r, function (a) { switch (a.l) { case 1: return g = Vt, y = oe, b = n.segments[0].a, v = new K(b), T = v.fa.split(".").pop(), E = oa[e], (x = E[T]) ? a.return(x) : e == g.na ? t && "vtt" != t ? a.return("application/mp4") : a.return("text/vtt") : ((k = _e([b], m.c.retryParameters)).method = "HEAD", dd(a, ua(m, k, y.qd), 2)); case 2: if (S = a.s, !(I = S.headers["content-type"])) throw new le(2, 4, 4021, T); return a.return(I.split(";")[0]); } }) }) }(d, n, V, O), 3); case 3: return H = p.s, Z = ($ = f.Pa(O.a, "EXT-X-MEDIA-SEQUENCE")) ? +$.value : 0, dd(p, Zi(d, e, O, Z, H, V), 4); case 4: return ee = p.s, te = ee[0].startTime, ae = ee[ee.length - 1].endTime, ne = ae - te, ie = new Qr(ee), re = $i(O), de = void 0, "text" == n && (de = "subtitle"), se = { id: d.W++, originalId: a, createSegmentIndex: Promise.resolve.bind(Promise), findSegmentPosition: ie.find.bind(ie), getSegmentReference: ie.get.bind(ie), initSegmentReference: re, presentationTimeOffset: 0, mimeType: H, codecs: V, kind: de, encrypted: G, keyId: W, language: r, label: a, type: n, primary: i, trickModeVideo: null, emsgSchemeIdUris: null, frameRate: void 0, width: void 0, height: void 0, bandwidth: void 0, roles: [], channelsCount: o, closedCaptions: s }, p.return({ stream: se, Mb: ie, drmInfos: X, pc: e, ne: E, Qc: te, rg: ae, duration: ne }); } }) }) } function $i(a) { var i = mi.hb(a.a, "EXT-X-MAP"); if (!i.length) return null; if (1 < i.length) throw new le(2, 4, 4020); var d = na(i = i[0], "URI"), o = mi.vc(a.b, d); return a = 0, d = null, (i = _i(i, "BYTERANGE")) && (a = i.split("@"), i = +a[0], d = (a = +a[1]) + i - 1), new Ur(function () { return [o] }, a, d) } function Ji(d, e, p, n) { var r = e.b, l = e.a; e = ra(r, "EXTINF").value.split(","), e = n + +e[0]; var a = 0, u = null; return (r = mi.Pa(r, "EXT-X-BYTERANGE")) && (a = r.value.split("@"), r = +a[0], u = (a = a[1] ? +a[1] : d.a + 1) + r - 1), new Br(p, n, e, function () { return [l] }, a, u) } function Qi(a) { a.b && (a.K.forEach(function (e) { a.b.ob(e, 0) }), a.K = []) } function Zi(d, e, t, n, r, i) { return rd(function a() { var b, T, E, x, k, S, o, I, A, C; return od(a, function (a) { switch (a.l) { case 1: return b = t.segments, T = [], E = b[0].a, x = Ji(null, b[0], n, 0), k = $i(t), dd(a, function (m, e, t, n, r, i) { return rd(function a() { var g, y, b, T, E, x, k, S, I; return od(a, function (a) { switch (a.l) { case 1: if (m.m && (g = m.a.get(e), y = g.Mb, b = y.get(n.position))) return a.return(b.startTime); if ("audio/mpeg" == r) return a.return(0); if ("video/mp4" != r && "audio/mp4" != r) { a.A(2); break } return T = [ea(m, n)], t && T.push(ea(m, t)), dd(a, Promise.all(T), 3); case 3: return E = a.s, x = E[0], k = E[1] || E[0], a.return(function (a, e) { var t = 0; if (new Vr().G("moov", Kr).G("trak", Kr).G("mdia", Kr).ca("mdhd", function (a) { a.reader.J(0 == a.version ? 8 : 16), t = a.reader.D(), a.parser.stop() }).parse(e, !0), !t) throw new le(2, 4, 4030); var d = 0, o = !1; if (new Vr().G("moof", Kr).G("traf", Kr).ca("tfdt", function (a) { d = (0 == a.version ? a.reader.D() : a.reader.ub()) / t, o = !0, a.parser.stop() }).parse(a, !0), !o) throw new le(2, 4, 4030); return d }(x.data, k.data)); case 2: if ("video/mp2t" != r) { a.A(4); break } return dd(a, ea(m, n), 5); case 5: return S = a.s, a.return(function (a) { function i() { throw new le(2, 4, 4030) } a = new jr(new DataView(a), 0); for (var t = 0, d = 0; ;) { if (t = a.aa(), 71 != (d = a.ha()) && i(), 16384 & a.Jb() || i(), 0 != (d = (48 & a.ha()) >> 4) && 2 != d || i(), 3 == d && (d = a.ha(), a.J(d)), 1 == a.D() >> 8) return a.J(3), 0 != (t = a.ha() >> 6) && 1 != t || i(), 0 == a.ha() && i(), t = a.ha(), d = a.Jb(), a = a.Jb(), (1073741824 * ((14 & t) >> 1) + ((65534 & d) << 14 | (65534 & a) >> 1)) / 9e4; a.seek(t + 188), 71 != (d = a.ha()) && (a.seek(t + 192), d = a.ha()), 71 != d && (a.seek(t + 204), d = a.ha()), 71 != d && i(), a.Yd(1) } }(S.data)); case 4: if ("application/mp4" != r && !r.startsWith("text/")) { a.A(6); break } return dd(a, ea(m, n), 7); case 7: return I = a.s, a.return(function (a, i, r) { return Wt(a = qe(a, i)) ? (Yt(i = new Xt(null), a), i.Hc(r)) : 0 }(r, i, I.data)); case 6: throw new le(2, 4, 4030); } }) }) }(d, e, k, x, r, i), 2); case 2: S = a.s, E.split("/").pop(); for (var s = 0; s < b.length; ++s)o = b[s], I = T[T.length - 1], A = 0 == s ? S : I.endTime, C = Ji(I, o, n + s, A), T.push(C); return d.K.push(T), Qi(d), a.return(T); } }) }) } function ea(d, e) { return rd(function t() { var p, l, c, f, m, g; return od(t, function (t) { switch (t.l) { case 1: return p = oe, l = yi(e.c(), e.b, e.b + 2048 - 1, d.c.retryParameters), c = yi(e.c(), e.b, e.a, d.c.retryParameters), b(t, 2), dd(t, ua(d, l, p.qd), 4); case 4: return f = t.s, t.return(f); case 2: if (7001 == (m = x(t)).code) throw m; return F("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.", l.uris[0]), dd(t, ua(d, c, p.qd), 5); case 5: return g = t.s, t.return(g); } }) }) } function ta(a, e) { for (var t = Ki[a], n = 0; n < t.length; n++)for (var d = 0; d < e.length; d++)if (t[n].test(e[d].trim())) return e[d].trim(); return "text" == a ? "" : null } function na(a, e) { var t = a.getAttribute(e); if (!t) throw new le(2, 4, 4023, e); return t.value } function ra(a, e) { var t = mi.Pa(a, e); if (!t) throw new le(2, 4, 4024, e); return t } function ia(a, e) { return ua(a, _e([e], a.c.retryParameters), oe.og) } function aa(a, e) { a.f = e, a.b && a.b.Ob(a.f == fa.Ma), a.f != fa.Ma || a.h.stop() } function ua(a, e, i) { if (!a.i) throw new le(2, 7, 7001); return e = a.g.networkingEngine.request(i, e), Ie(a.i, e), e.promise } function ca() { this.a = new Map } function da(a, e, t) { pa(a, e).text = t } function pa(a, e) { return a.a.has(e) || a.a.set(e, new va), a.a.get(e) } function va() { this.text = this.variant = null } function ma(a, e) { this.a = a, this.b = new Set([a]); for (var i = id(e = e || []), n = i.next(); !n.done; n = i.next())this.add(n.value) } function ya(a, e) { var t; if (!(t = !!a.audio != !!e.audio || !!a.video != !!e.video || a.language != e.language) && (t = a.audio && e.audio)) { t = a.audio; var i = e.audio; t = !(t.channelsCount == i.channelsCount && ga(t, i) && ba(t.roles, i.roles)) } return !t && (t = a.video && e.video) && (t = !(ga(t = a.video, i = e.video) && ba(t.roles, i.roles))), !t } function ga(a, e) { if (a.mimeType != e.mimeType) return !1; var t = a.codecs.split(",").map(function (t) { return Ge(t)[0] }), n = e.codecs.split(",").map(function (t) { return Ge(t)[0] }); if (t.length != n.length) return !1; t.sort(), n.sort(); for (var r = 0; r < t.length; r++)if (t[r] != n[r]) return !1; return !0 } function ba(a, e) { var t = new Set(a), d = new Set(e); if (t.delete("main"), d.delete("main"), t.size != d.size) return !1; for (var r = (t = id(t)).next(); !r.done; r = t.next())if (!d.has(r.value)) return !1; return !0 } function wa(t) { this.a = t, this.b = new Ta(t.language, "", t.audio && t.audio.channelsCount ? t.audio.channelsCount : 0) } function Ta(a, e, t) { this.c = a, this.b = e, this.a = t } function Ea(a, e) { this.a = xa, this.b = new Map().set(xa, e).set(ha, a) } function ka(a, e) { this.g = a, this.h = Aa(a), this.c = a.a.currentTime, this.f = Date.now() / 1e3, this.i = e, this.b = function () { } } function Ia(t) { this.a = t } function Aa(a) { if (a.a.paused || 0 == a.a.playbackRate || null == a.a.buffered) var d = !1; else e: { d = a.a.buffered, a = a.a.currentTime; for (var o = 0; o < d.length; o++) { var s = d.start(o), r = d.end(o); if (!(a < s || a > r - .5)) { d = !0; break e } } d = !1 } return d } function Ca(d, e, t, n, r) { var i = this; this.b = d, this.w = e, this.v = t, this.m = r, this.g = new Le, this.j = !1, this.o = d.readyState, this.f = !1, this.c = n, this.i = !1, De(this.g, d, "waiting", function () { return Pa(i) }), this.h = new ee(function () { Pa(i) }).Ia(.25) } function Pa(d) { if (0 != d.b.readyState) { if (!d.b.seeking) d.j = !1; else if (!d.j) return; if (!d.b.paused) { d.b.readyState != d.o && (d.f = !1, d.o = d.b.readyState); var p = d.v.smallGapLimit, l = d.b.currentTime, u = d.b.buffered; e: { if (u && u.length && !(1 == u.length && 1e-6 > u.end(0) - u.start(0))) for (var c = Ye("Edge/") || Ye("Trident/") || Ye("Tizen") || Ye("CrKey") ? .5 : .1, f = 0; f < u.length; f++)if (u.start(f) > l && (0 == f || u.end(f - 1) - l <= c)) { c = f; break e } c = null } if (null == c) d.c && (u = Aa(l = (d = d.c).g), l = l.a.currentTime, c = Date.now() / 1e3, d.c == l && d.h == u || (d.f = c, d.c = l, d.h = u), (l = c - d.f) >= d.i && u && d.b(d.c, l)); else if (0 != c || d.i) { f = u.start(c); var m = d.w.wa(); if (!(f >= m)) { p = (m = f - l) <= p; var g = !1; .001 > m || (p || d.f || (d.f = !0, (l = new be("largegap", { currentTime: l, gapSize: m })).cancelable = !0, d.m(l), d.v.jumpLargeGaps && !l.defaultPrevented && (g = !0)), !p && !g) || (0 != c && u.end(c - 1), d.b.currentTime = f) } } } } } function _a(a) { var e = this; this.f = a, this.b = new Set, this.c = new ee(function () { Ma(e, !1) }).Ia(.25) } function Ma(a, e) { for (var t = id(a.b), n = t.next(); !n.done; n = t.next())n.value.h(a.f.currentTime, e) } function Na(a) { for (var i = [], t = (a = id(a)).next(); !t.done; t = a.next())for (var d = (t = id(t.value.variants)).next(); !d.done; d = t.next())i.push(d.value); return i } function Ra(a, e) { for (var t = null, d = id(a), r = d.next(); !r.done; r = d.next())e >= (r = r.value).startTime && (t = r); return t } function Oa(t) { this.f = t, this.b = null, this.c = function () { } } function La(a) { var e = this; this.b = a, this.g = !1, this.f = this.b.cc(), this.c = new ee(function () { e.b.Gd(.25 * e.f) }) } function Da(a) { a.c.stop(); var e = a.g ? 0 : a.f; 0 <= e ? a.b.cc() != e && a.b.gd(e) : (a.c.Ia(.25), 0 != a.b.cc() && a.b.gd(0)) } function ja(a, e, t) { this.b = a, this.g = e, this.h = t, this.c = new Le, this.f = new Ha(a), 0 < a.readyState ? Fa(this, t) : Ba(this, t) } function Ua(t) { return 0 < t.b.readyState ? t.b.currentTime : t.h } function Ba(a, e) { a.h = e, a.c.ma(a.b, "loadedmetadata"), Pe(a.c, a.b, "loadedmetadata", function () { Fa(a, e) }) } function Fa(a, e) { .001 > Math.abs(a.b.currentTime - e) ? Va(a) : (Pe(a.c, a.b, "seeking", function () { Va(a) }), Ka(a.f, 0 == a.b.currentTime ? e : a.b.currentTime)) } function Va(t) { De(t.c, t.b, "seeking", function () { return t.g() }) } function Ha(a) { var e = this; this.c = a, this.i = 10, this.h = this.g = this.f = 0, this.b = new ee(function () { 0 >= e.f ? e.b.stop() : e.c.currentTime == e.g ? (e.c.currentTime = e.h, e.f--) : e.b.stop() }) } function Ka(a, e) { a.g = a.c.currentTime, a.h = e, a.f = a.i, a.c.currentTime = e, a.b.Ia(.1) } function qa(a) { function e() { t.g = !0, null != t.c && (t.b.currentTime = t.c) } var t = this; this.b = a, this.g = !1, this.c = null, this.f = new Le, 0 == this.b.readyState ? Pe(this.f, this.b, "loadedmetadata", e) : e() } function za(d, e, t, n, r, i) { var a = this; this.c = d, this.b = e.presentationTimeline, this.C = e.minBufferTime || 0, this.h = t, this.w = r, this.m = null, this.g = new Ca(d, e.presentationTimeline, t, function (a, e) { if (!e.stallEnabled) return null; var t = e.stallSkip, n = new ka(new Ia(a), e.stallThreshold); return function (a, e) { a.b = e }(n, function () { a.currentTime += t }), n }(d, t), i), this.f = new ja(d, function () { var n = a.g; n.j = !0, n.i = !1, n.f = !1; var i = Ua(a.f); return n = Xa(a, i), .001 < Math.abs(n - i) && (i = new Date().getTime() / 1e3, !a.m || a.m < i - 1) ? (a.m = i, 0 < (i = a.f).b.readyState ? Ka(i.f, n) : Ba(i, n), n = void 0) : (a.w(), n = void 0), n }, function (a, e) { return null == e ? e = 1 / 0 > a.b.Y() ? a.b.ib() : a.b.wa() : 0 > e && (e = a.b.wa() + e), Ga(a, Wa(a, e)) }(this, n)), this.j = new ee(function () { if (0 != a.c.readyState && !a.c.paused) { var i = a.c.currentTime, r = a.b.ib(), d = a.b.wa(); 3 > d - r && (r = d - 3), i < r && (i = Xa(a, i), a.c.currentTime = i) } }).Ia(.25) } function Ga(a, e) { var t = a.b.Y(); return e >= t ? t - a.h.durationBackoff : e } function Xa(d, e) { var t = Dt.bind(null, d.c.buffered), n = Math.max(d.C, d.h.rebufferingGoal), p = d.h.safeSeekOffset, i = d.b.ib(), l = d.b.wa(), o = d.b.Y(); 3 > l - i && (i = l - 3); var s = d.b.Cb(n), u = d.b.Cb(p); return n = d.b.Cb(n + p), e >= o ? Ga(d, e) : e > l ? l : e < i ? t(u) ? u : n : e >= s || t(e) ? e : n } function Wa(a, e) { var t = a.b.ib(); return e < t ? t : e > (t = a.b.wa()) ? t : e } function Ya() { this.c = function () { }, this.b = new Set } function $a(a) { var i = this; this.i = a, this.g = new Map, this.b = function () { }, this.c = function () { }, this.f = function () { }, this.j = [{ Za: null, Ya: Qa, Sa: function (t, e) { return i.b(t, e) } }, { Za: Sa, Ya: Qa, Sa: function (t, e) { return i.b(t, e) } }, { Za: Za, Ya: Qa, Sa: function (t, e) { return i.b(t, e) } }, { Za: Qa, Ya: Sa, Sa: function (t, e) { return i.c(t, e) } }, { Za: Qa, Ya: Za, Sa: function (t, e) { return i.c(t, e) } }, { Za: Sa, Ya: Za, Sa: function (t, e) { return i.f(t, e) } }, { Za: Za, Ya: Sa, Sa: function (t, e) { return i.f(t, e) } }] } function Ja(a, e) { this.a = e, this.c = a, this.g = null, this.j = 1, this.v = Promise.resolve(), this.h = [], this.i = new Map, this.b = new Map, this.o = !1, this.F = null, this.C = this.f = this.m = !1, this.w = 0 } function Jr(t) { return Zr(t, "audio") } function $r(t) { return Zr(t, "video") } function Zr(a, e) { var t = a.b.get(e); return t ? t.Fa || t.stream : null } function sd(d, e) { return rd(function t() { var p, f, m, g, y, b, h, v; return od(t, function (t) { switch (t.l) { case 1: return p = Vt, dd(t, xn(d.a.L, p.na), 2); case 2: return d.w++ , d.C = !1, f = d.w, m = d.a.L, g = new Map, y = new Set, g.set(p.na, e), y.add(e), dd(t, m.init(g, !1), 3); case 3: return d.f ? t.return() : dd(t, yd(d, y), 4); case 4: if (d.f) return t.return(); d.w != f || d.b.has(p.na) || d.C || (b = d.a.Qa(), h = xd(d, b), v = md(e, h, 0), d.b.set(p.na, v), Ad(d, v, 0)), E(t); } }) }) } function pd(a, e) { var t = a.b.get("video"); if (t) { var n = t.stream; if (n) if (e) { var d = n.trickModeVideo; d && !t.Fa && (ud(a, d, !1, 0, !1), t.Fa = n) } else (n = t.Fa) && (t.Fa = null, ud(a, n, !0, 0, !1)) } } function ld(a, e, t, n) { e.video && ud(a, e.video, t, n, !1), e.audio && ud(a, e.audio, t, n, !1) } function ud(d, e, p, n, r) { var i = d.b.get(e.type); if (!i && "text" == e.type && d.g.ignoreTextStreamFailures) sd(d, e); else if (i) { var a = kd(d, e); if (p && a != i.ya) d.b.forEach(function (e) { cd(d, e) }); else { i.Fa && (e.trickModeVideo ? (i.Fa = e, e = e.trickModeVideo) : i.Fa = null); var o = d.h[a]; o && o.vb && (o = d.i.get(e.id)) && o.vb && (i.stream != e || r) && ("text" == e.type && gn(d.a.L, qe(e.mimeType, e.codecs)), i.stream = e, i.ec = !0, function (d, e, t) { if (!e.Hb) return !1; var o = d.a.Qa(), r = vn(d.a.L, e.type); if (null == (t = (t = vd(d, e, o, r, t)) && t.a ? t.a - t.b : null)) return !1; var i = e.stream.initSegmentReference; return i && (t += (i.a ? i.a - i.b : null) || 0), i = d.a.getBandwidthEstimate(), 8 * t / i < r - o - Math.max(d.c.minBufferTime || 0, d.g.rebufferingGoal) || e.Hb.b.a > t }(d, i, a) && i.Hb.abort(), p && (i.Na ? i.qc = !0 : i.Ea ? (i.Ja = !0, i.Wb = n, i.qc = !0) : (Cd(i), Id(d, i, !0, n)))) } } } function cd(a, e) { e.Na || e.Ja || (e.Ea ? (e.Ja = !0, e.Wb = 0) : null == yn(a.a.L, e.type) ? null == e.Ba && Ad(a, e, 0) : (Cd(e), Id(a, e, !1, 0))) } function fd(d, e, t, n, a) { return rd(function i() { var r, p, m, g, y, b, v; return od(i, function (i) { switch (i.l) { case 1: return r = d.a.Qa(), p = xd(d, r), m = Vt, g = new Map, y = new Set, e && (g.set(m.wb, e), y.add(e)), t && (g.set(m.La, t), y.add(t)), n && (g.set(m.na, n), y.add(n)), b = d.a.L, v = d.g.forceTransmuxTS, dd(i, b.init(g, v), 2); case 2: return d.f ? i.return() : (function (a) { var e = a.c.presentationTimeline.Y(); 1 / 0 > e ? a.a.L.ta(e) : a.a.L.ta(Math.pow(2, 32)) }(d), dd(i, yd(d, y), 3)); case 3: if (d.f) return i.return(); g.forEach(function (e, t) { if (!d.b.has(t)) { var n = md(e, p, a); d.b.set(t, n), Ad(d, n, 0) } }), E(i); } }) }) } function md(a, e, t) { return { stream: a, type: a.type, lb: null, xa: null, Fa: null, ec: !0, ya: e, endOfStream: !1, Ea: !1, Ba: null, Ja: !1, Wb: 0, qc: !1, Na: !1, $c: !1, Eb: !1, Xd: t || 0, Hb: null } } function gd(d, o) { var e = d.h[o]; if (e) return e.promise; e = { promise: new ue, vb: !1 }, d.h[o] = e; for (var t = new Set, r = id(d.c.periods[o].variants), s = r.next(); !s.done; s = r.next())(s = s.value).video && t.add(s.video), s.video && s.video.trickModeVideo && t.add(s.video.trickModeVideo), s.audio && t.add(s.audio); for (s = (r = id(d.c.periods[o].textStreams)).next(); !s.done; s = r.next())t.add(s.value); return d.v = d.v.then(function () { if (!this.f) return yd(this, t) }.bind(d)).then(function () { this.f || (this.h[o].promise.resolve(), this.h[o].vb = !0) }.bind(d)).catch(function (t) { this.f || (this.h[o].promise.catch(function () { }), this.h[o].promise.reject(), delete this.h[o], this.a.onError(t)) }.bind(d)), e.promise } function yd(d, e) { return rd(function t() { var p, n, f, m, l, g, y; return od(t, function (t) { switch (t.l) { case 1: p = []; for (var a = id(e), i = a.next(); !i.done; i = a.next())n = i.value, (f = d.i.get(n.id)) ? p.push(f.promise) : (d.i.set(n.id, { promise: new ue, vb: !1 }), p.push(n.createSegmentIndex())); return b(t, 2), dd(t, Promise.all(p), 4); case 4: if (d.f) return t.return(); T(t, 3); break; case 2: if (m = x(t), d.f) return t.return(); for (i = (t = id(e)).next(); !i.done; i = t.next())l = i.value, d.i.get(l.id).promise.catch(function () { }), d.i.get(l.id).promise.reject(), d.i.delete(l.id); throw m; case 3: for (i = (a = id(e)).next(); !i.done; i = a.next())g = i.value, (y = d.i.get(g.id)).vb || (y.promise.resolve(), y.vb = !0); E(t); } }) }) } function bd(a, e) { if (!a.f && !e.Ea && null != e.Ba && !e.Na) if (e.Ba = null, e.Ja) Id(a, e, e.qc, e.Wb); else { try { var t = function (d, e) { function p(t) { return "text" == t.type && "application/cea-608" == t.stream.mimeType } if (p(e)) return d.a.L.nc(e.stream.originalId || ""), null; var n = d.a.Qa(), t = hd(d, e, n), r = kd(d, e.stream), a = xd(d, t), l = function (a, i, t) { return "text" == i ? null == (a = a.a).b || a.b < t ? 0 : a.b - Math.max(t, a.a) : Pt(a = Tn(a, i), t) }(d.a.L, e.type, n), s = Math.max(d.c.minBufferTime || 0, d.g.rebufferingGoal, d.g.bufferingGoal) * d.j; if (t >= d.c.presentationTimeline.Y()) return e.endOfStream = !0, "video" == e.type && (t = d.b.get("text")) && "application/cea-608" == t.stream.mimeType && (t.endOfStream = !0), null; if (e.endOfStream = !1, e.ya = a, a != r) return null; if (l >= s) return .5; if (a = vn(d.a.L, e.type), !(a = vd(d, e, n, a, r))) return 1; var u = 1 / 0; return Array.from(d.b.values()).forEach(function (e) { p(e) || (e = hd(d, e, n), u = Math.min(u, e)) }), t >= u + d.c.presentationTimeline.a ? 1 : (e.Xd = 0, function (d, p, t, e, n) { var i = d.c.periods[e], a = p.stream, o = d.c.presentationTimeline.Y(), l = d.c.periods[e + 1]; e = function (a, d, t, o, r) { return d.ec ? (t = function (a, d, t, n, r) { return "text" == d ? (a.a.m = t, (a = a.a).f = n, a.h = r, Promise.resolve()) : Promise.all([kn(a, d, a.me.bind(a, d)), kn(a, d, a.Pf.bind(a, d, t)), kn(a, d, a.Mf.bind(a, d, n, r))]) }(a.a.L, d.type, a.c.periods[t].startTime - d.stream.presentationTimeOffset, o, r), d.stream.initSegmentReference ? (a = Sd(a, d, d.stream.initSegmentReference).then(function (t) { if (!this.f) return En(this.a.L, d.type, t, null, null, d.stream.closedCaptions && 0 < d.stream.closedCaptions.size) }.bind(a)).catch(function (t) { return d.ec = !0, Promise.reject(t) }), Promise.all([t, a])) : t) : Promise.resolve() }(d, p, e, Math.max(0, i.startTime - .1), l ? l.startTime + .01 : o), p.Ea = !0, p.ec = !1, o = Sd(d, p, n), Promise.all([e, o]).then(function (r) { if (!this.f && !this.m) return function (d, e, t, n, r, i, a) { var o = r.closedCaptions && 0 < r.closedCaptions.size; return null != r.emsgSchemeIdUris && 0 < r.emsgSchemeIdUris.length && new Vr().ca("emsg", d.K.bind(d, n, i, r.emsgSchemeIdUris)).parse(a), function (a, e, t) { var d = Math.max(a.g.bufferBehind, a.c.presentationTimeline.a), r = yn(a.a.L, e.type); return null == r ? Promise.resolve() : 0 >= (t = t - r - d) ? Promise.resolve() : a.a.L.remove(e.type, r, r + t).then(function () { }.bind(a)) }(d, e, t).then(function () { if (!this.f) return En(this.a.L, e.type, a, i.startTime + n.startTime, i.endTime + n.startTime, o) }.bind(d)).then(function () { if (!this.f) return e.lb = r, e.xa = i, Promise.resolve() }.bind(d)) }(this, p, t, i, a, n, r[1]) }.bind(d)).then(function () { this.f || this.m || (p.Ea = !1, p.$c = !1, p.Ja || this.a.Vc(), Ad(this, p, 0), function (a, e) { if (!a.o) { var t = Array.from(a.b.values()); if (1 == t.length && "text" == t[0].type || (a.o = t.every(function (t) { return "text" == t.type || !t.Ja && !t.Na && t.xa })), a.o) { for (t = kd(a, e), a.h[t] || gd(a, t).then(function () { this.f || this.a.Id() }.bind(a)).catch(Ot.Gb), t = 0; t < a.c.periods.length; ++t)gd(a, t).catch(Ot.Gb); a.a.pf && a.a.pf() } } }(this, a)) }.bind(d)).catch(function (t) { this.f || this.m || (p.Ea = !1, "text" == p.type && this.g.ignoreTextStreamFailures ? this.b.delete("text") : 7001 == t.code ? (p.Ea = !1, p.Ba = null, Ad(this, p, 0)) : 3017 == t.code ? function (a, i, e) { if (!Array.from(a.b.values()).some(function (t) { return t != i && t.$c })) { var t = Math.round(100 * a.j); if (20 < t) a.j -= .2; else { if (!(4 < t)) return i.Eb = !0, a.m = !0, void a.a.onError(e); a.j -= .04 } i.$c = !0 } Ad(a, i, 4) }(this, p, t) : (p.Eb = !0, t.severity = 2, _d(this, t))) }.bind(d)) }(d, e, n, r, a), null) }(a, e); null != t && (Ad(a, e, t), e.Eb = !1) } catch (e) { return void _d(a, e) } t = Array.from(a.b.values()), function (a, e) { var t = kd(a, e.stream); if (e.ya != t) { var d = e.ya, r = Array.from(a.b.values()); r.every(function (t) { return t.ya == d }) && r.every(Ed) && gd(a, d).then(function () { if (!this.f && r.every(function (a) { var e = Ed(a), t = kd(this, a.stream); return e && a.ya == d && t != d }.bind(this))) { var i = this.c.periods[d], o = this.a.Jd(i), s = new Map; o.variant && o.variant.video && s.set("video", o.variant.video), o.variant && o.variant.audio && s.set("audio", o.variant.audio), o.text && s.set("text", o.text); var n = id(this.b.keys()); for (o = n.next(); !o.done; o = n.next())if (o = o.value, !s.has(o) && "text" != o) return void this.a.onError(new le(2, 5, 5005)); for (o = (n = id(Array.from(s.keys()))).next(); !o.done; o = n.next())if (o = o.value, !this.b.has(o)) { if ("text" != o) return void this.a.onError(new le(2, 5, 5005)); fd(this, null, null, s.get("text"), i.startTime), s.delete(o) } for (o = (i = id(Array.from(this.b.keys()))).next(); !o.done; o = i.next())o = o.value, (n = s.get(o)) ? (ud(this, n, !1, 0, !1), Ad(this, this.b.get(o), 0)) : this.b.delete(o); this.a.Id() } }.bind(a)).catch(Ot.Gb) } }(a, e), a.o && t.every(function (t) { return t.endOfStream }) && a.a.L.endOfStream().then(function () { if (!this.f) { var t = this.a.L.Y(); t < this.c.presentationTimeline.Y() && this.c.presentationTimeline.ta(t) } }.bind(a)) } } function hd(a, e, t) { return e.lb && e.xa ? (t = kd(a, e.lb), a.c.periods[t].startTime + e.xa.endTime) : Math.max(t, e.Xd) } function vd(d, e, t, o, r) { if (e.xa && e.stream == e.lb) return Td(d, e, r, e.xa.position + 1); if (e.xa ? (t = kd(d, e.lb), t = e.stream.findSegmentPosition(Math.max(0, d.c.periods[t].startTime + e.xa.endTime - d.c.periods[r].startTime))) : t = e.stream.findSegmentPosition(Math.max(0, (o || t) - d.c.periods[r].startTime)), null == t) return null; var i = null; return null == o && (i = Td(d, e, r, Math.max(0, t - 1))), i || Td(d, e, r, t) } function Td(a, i, d, o) { return d = a.c.periods[d], (i = i.stream.getSegmentReference(o)) ? (a = (o = a.c.presentationTimeline).Db(), o = o.jb(), d.startTime + i.endTime < a || d.startTime + i.startTime > o ? null : i) : null } function Ed(t) { return !t.Ea && null == t.Ba && !t.Ja && !t.Na } function xd(a, e) { var t = Ra(a.c.periods, e + qt); return t ? a.c.periods.indexOf(t) : 0 } function kd(d, e) { for (var t = d.c.periods, n = 0; n < t.length; n++) { for (var p = t[n], l = new Set, a = id(p.variants), u = a.next(); !u.done; u = a.next())(u = u.value).audio && l.add(u.audio), u.video && l.add(u.video), u.video && u.video.trickModeVideo && l.add(u.video.trickModeVideo); for (a = (p = id(p.textStreams)).next(); !a.done; a = p.next())l.add(a.value); if (l.has(e)) return n } return -1 } function Sd(a, i, t) { return t = yi(t.c(), t.b, t.a, a.g.retryParameters), a = a.a.nb.request(1, t), i.Hb = a, a.promise.then(function (t) { return i.Hb = null, t.data }) } function Id(d, e, t, n) { rd(function r() { var p, l, u; return od(r, function (a) { switch (a.l) { case 1: return e.Ja = !1, e.qc = !1, e.Wb = 0, e.Na = !0, n ? (l = d.a.Qa(), u = d.a.L.Y(), p = d.a.L.remove(e.type, l + n, u)) : p = xn(d.a.L, e.type).then(function () { if (!this.f && t) return this.a.L.flush(e.type) }.bind(d)), dd(a, p, 2); case 2: if (d.f) return a.return(); e.lb = null, e.xa = null, e.Na = !1, e.endOfStream = !1, Ad(d, e, 0), E(a); } }) }) } function Ad(a, e, t) { e.Ba = new Z(function () { bd(a, e) }).O(t) } function Cd(t) { null != t.Ba && (t.Ba.stop(), t.Ba = null) } function _d(a, e) { se(a.F).then(function () { this.f || (this.a.onError(e), e.handled || this.g.failureCallback(e)) }.bind(a)) } function wd(d, e, t, n, r, o) { if (200 <= t && 299 >= t && 202 != t) return { uri: r || n, Xc: n, data: e, headers: d, fromCache: !!d["x-shaka-from-cache"] }; r = null; try { r = Ze(e) } catch (t) { } throw new le(401 == t || 403 == t ? 2 : 1, 1, 1001, n, t, r, d, o) } function Rd(d, p, l, n) { var r = new Rd.b; Ke(p.headers).forEach(function (a, e) { r.append(e, a) }); var i = new Rd.a, a = { rd: !1, ee: !1 }; if (d = new de(d = Rd.j(d, l, { body: p.body || void 0, headers: r, method: p.method, signal: i.signal, credentials: p.allowCrossSiteCredentials ? "include" : void 0 }, a, n), function () { return a.rd = !0, i.abort(), Promise.resolve() }), p = p.retryParameters.timeout) { var o = new ee(function () { a.ee = !0, i.abort() }); o.O(p / 1e3), d.finally(function () { o.stop() }) } return d } function Ld(d, e, p, n) { var t = new Ld.f, i = Date.now(), r = 0; return new de(new Promise(function (a, o) { for (var s in t.open(e.method, d, !0), t.responseType = "arraybuffer", t.timeout = e.retryParameters.timeout, t.withCredentials = e.allowCrossSiteCredentials, t.onabort = function () { o(new le(1, 1, 7001, d, p)) }, t.onload = function (e) { for (var n = (e = e.target).getAllResponseHeaders().trim().split("\r\n"), s = {}, i = (n = id(n)).next(); !i.done; i = n.next())s[(i = i.value.split(": "))[0].toLowerCase()] = i.slice(1).join(": "); try { var l = wd(s, e.response, e.status, d, e.responseURL, p); a(l) } catch (t) { o(t) } }, t.onerror = function (e) { o(new le(1, 1, 1002, d, e, p)) }, t.ontimeout = function () { o(new le(1, 1, 1003, d, p)) }, t.onprogress = function (a) { var e = Date.now(); (100 < e - i || a.lengthComputable && a.loaded == a.total) && (n(e - i, a.loaded - r, a.total - a.loaded), r = a.loaded, i = e) }, e.headers) t.setRequestHeader(s.toLowerCase(), e.headers[s]); t.send(e.body) }), function () { return t.abort(), Promise.resolve() }) } function Dd() { this.a = this.f = this.b = 0, this.c = new Map, this.g = 0 } function Pd(a, e) { this.g = a, this.b = new Map, this.c = !1, this.f = e, this.a = new Dd } function Nd(d, e, s, t, n) { var i = function (a, e) { a.b += e; var t = a.g; return a.g++ , a.c.set(t, e), t }(d.a, t); t = d.b.get(e) || Promise.resolve(), d.b.set(e, t.then(function () { return rd(function e() { var a; return od(e, function (e) { switch (e.l) { case 1: return dd(e, function (a, e) { return rd(function t() { var i; return od(t, function (t) { switch (t.l) { case 1: return dd(t, a.g.request(1, e).promise, 2); case 2: return i = t.s, t.return(i.data); } }) }) }(d, s), 2); case 2: if (a = e.s, d.c) throw new le(2, 9, 7001); d.a.close(i, a.byteLength); var t = d.a; return d.f(0 == t.b ? 0 : t.f / t.b, d.a.a), e.return(n(a)); } }) }) })) } function Od(a, e) { var t = this; this.c = a, this.b = a.objectStore(e), this.a = new ue, a.onabort = function (a) { a.preventDefault(), t.a.reject() }, a.onerror = function (a) { a.preventDefault(), t.a.reject() }, a.oncomplete = function () { t.a.resolve() } } function Md(a, i) { return new Promise(function (t, e) { var n = a.b.openCursor(); n.onerror = e, n.onsuccess = function (a) { return (a = a.target.result) ? void (i(a.key, a.value, a), a.continue()) : t() } }) } function Ud(t) { this.b = t, this.a = [] } function Bd(a, e) { return Fd(a, e, "readonly") } function jd(a, e) { return Fd(a, e, "readwrite") } function Fd(a, e, t) { var i = new Od(t = a.b.transaction([e], t), e); return a.a.push(i), i.promise().then(function () { xe(a.a, i) }, function () { xe(a.a, i) }), i } function Vd(t) { this.a = new Ud(t) } function Kd() { this.a = new Map } function Hd(a, i, r) { if (!(a = a.a.get(i))) throw new le(2, 9, 9013, "Could not find mechanism with name " + i); if (!(i = a.getCells().get(r))) throw new le(2, 9, 9013, "Could not find cell with name " + r); return i } function qd(a, e) { eo.set(a, e) } function zd(t) { this.a = new Ud(t) } function Gd(t) { return Promise.reject(new le(2, 9, 9011, "Cannot add new value to " + t)) } function Xd(a, d, t, n) { var r = (a = jd(a.a, d)).store(); return t.forEach(function (t) { r.delete(t).onsuccess = function () { return n(t) } }), a.promise() } function Wd(d, o, t) { var n = (d = Bd(d.a, o)).store(), r = {}, i = []; return t.forEach(function (a) { n.get(a).onsuccess = function (e) { null == (e = e.target.result) && i.push(a), r[a] = e } }), d.promise().then(function () { return i.length ? Promise.reject(new le(2, 9, 9012, "Could not find values for ")) : t.map(function (t) { return r[t] }) }) } function Yd(t) { return { originalManifestUri: t.originalManifestUri, duration: t.duration, size: t.size, expiration: null == t.expiration ? 1 / 0 : t.expiration, periods: t.periods.map(Qd), sessionIds: t.sessionIds, drmInfo: t.drmInfo, appMetadata: t.appMetadata } } function Qd(t) { return function (d) { var e = d.streams.filter(function (t) { return "audio" == t.contentType }), t = d.streams.filter(function (t) { return "video" == t.contentType }); if (!e.every(function (t) { return t.variantIds }) || !t.every(function (t) { return t.variantIds })) { e.forEach(function (t) { t.variantIds = [] }), t.forEach(function (t) { t.variantIds = [] }); var o = 0; if (t.length && !e.length) { var n = o++; t.forEach(function (t) { t.variantIds.push(n) }) } if (!t.length && e.length) { var i = o++; e.forEach(function (t) { t.variantIds.push(i) }) } t.length && e.length && e.forEach(function (a) { t.forEach(function (e) { var t = o++; a.variantIds.push(t), e.variantIds.push(t) }) }) } }(t), t.streams.forEach(function () { }), { startTime: t.startTime, streams: t.streams.map(Jd) } } function Jd(a) { var e = a.Xe ? to(a.Xe) : null; return { id: a.id, originalId: null, primary: a.primary, presentationTimeOffset: a.presentationTimeOffset, contentType: a.contentType, mimeType: a.mimeType, codecs: a.codecs, frameRate: a.frameRate, kind: a.kind, language: a.language, label: a.label, width: a.width, height: a.height, initSegmentKey: e, encrypted: a.encrypted, keyId: a.keyId, segments: a.segments.map($d), variantIds: a.variantIds } } function $d(a) { var e = to(a.uri); return { startTime: a.startTime, endTime: a.endTime, dataKey: e } } function Zd(t) { return { data: t.data } } function to(a) { var e; if ((e = /^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(a)) || (e = /^offline:segment\/([0-9]+)$/.exec(a))) return +e[1]; throw new le(2, 9, 9004, "Could not parse uri " + a) } function ao(a, e, t, n) { this.a = new Ud(a), this.c = e, this.b = t, this.f = n } function no(a, d, t) { if (a.f) return Promise.reject(new le(1, 9, 9011, "Cannot add new value to " + d)); var n = (a = jd(a.a, d)).store(), r = []; return t.forEach(function (t) { n.add(t).onsuccess = function (t) { r.push(t.target.result) } }), a.promise().then(function () { return r }) } function io(a, d, t, n) { var r = (a = jd(a.a, d)).store(); return t.forEach(function (t) { r.delete(t).onsuccess = function () { return n(t) } }), a.promise() } function ro(d, o, t) { var n = (d = Bd(d.a, o)).store(), r = {}, i = []; return t.forEach(function (a) { var e = n.get(a); e.onsuccess = function () { null == e.result && i.push(a), r[a] = e.result } }), d.promise().then(function () { return i.length ? Promise.reject(new le(1, 9, 9012, "Could not find values for ")) : t.map(function (t) { return r[t] }) }) } function oo() { this.g = this.c = this.b = this.a = this.f = null } function so(a, e, t, n) { this.a = a, this.g = e, this.f = t, this.c = n, this.b = ["offline:", a, "/", e, "/", t, "/", n].join("") } function po(a) { if (null == (a = /^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(a))) return null; var i = a[1]; if ("manifest" != i && "segment" != i) return null; var t = a[2]; if (!t) return null; var n = a[3]; return n && null != i ? new so(i, t, n, +a[4]) : null } function lo(a, e) { this.b = a, this.a = e } function uo(a, e, t) { var n = e.streams.filter(function (t) { return "audio" == t.contentType }), d = e.streams.filter(function (t) { return "video" == t.contentType }); return n = function (d, e, s) { for (var p = new Set, l = id(e), u = l.next(), c; !u.done; u = l.next())for (c = id(u.value.variantIds), u = c.next(); !u.done; u = c.next())p.add(u.value); for (l = id(s), u = l.next(); !u.done; u = l.next())for (c = id(u.value.variantIds), u = c.next(); !u.done; u = c.next())p.add(u.value); for (l = new Map, p = id(p), u = p.next(); !u.done; u = p.next())u = u.value, l.set(u, { id: u, language: "", primary: !1, audio: null, video: null, bandwidth: 0, drmInfos: [], allowedByApplication: !0, allowedByKeySystem: !0 }); for (e = id(e), p = e.next(); !p.done; p = e.next())for (p = p.value, u = co(d, p), c = id(p.variantIds), p = c.next(); !p.done; p = c.next())(p = l.get(p.value)).language = u.language, p.primary = p.primary || u.primary, p.audio = u; for (s = id(s), e = s.next(); !e.done; e = s.next())for (p = e.value, e = co(d, p), u = id(p.variantIds), p = u.next(); !p.done; p = u.next())(p = l.get(p.value)).primary = p.primary || e.primary, p.video = e; return l }(a, n, d), d = e.streams.filter(function (t) { return "text" == t.contentType }).map(function (e) { return co(a, e) }), e.streams.forEach(function (n) { n = n.segments.map(function (e, t) { return fo(a, t, e) }), t.ob(n, e.startTime) }), { startTime: e.startTime, variants: Array.from(n.values()), textStreams: d } } function co(a, e) { var t = e.segments.map(function (e, t) { return fo(a, t, e) }), i = new Qr(t); return t = { id: e.id, originalId: e.originalId, createSegmentIndex: function () { return Promise.resolve() }, findSegmentPosition: function (t) { return i.find(t) }, getSegmentReference: function (t) { return i.get(t) }, initSegmentReference: null, presentationTimeOffset: e.presentationTimeOffset, mimeType: e.mimeType, codecs: e.codecs, width: e.width || void 0, height: e.height || void 0, frameRate: e.frameRate || void 0, kind: e.kind, encrypted: e.encrypted, keyId: e.keyId, language: e.language, label: e.label || null, type: e.contentType, primary: e.primary, trickModeVideo: null, emsgSchemeIdUris: null, roles: [], channelsCount: null, closedCaptions: null }, null != e.initSegmentKey && (t.initSegmentReference = function (a, e) { var t = new so("segment", a.b, a.a, e); return new Ur(function () { return [t.toString()] }, 0, null) }(a, e.initSegmentKey)), t } function fo(a, e, t) { var n = new so("segment", a.b, a.a, t.dataKey); return new Br(e, t.startTime, t.endTime, function () { return [n.toString()] }, 0, null) } function mo() { this.a = null } function go(a) { var e = po(a); return e && "manifest" == e.a ? go.h(a) : e && "segment" == e.a ? go.i(e.key(), e) : pe(new le(2, 1, 9004, a)) } function yo(d, e, t) { return rd(function n() { var f, g, k, S, I, A; return od(n, function (a) { switch (a.l) { case 1: f = []; for (var n = [], i = id(t), r = i.next(); !r.done; r = i.next()) { r = r.value; for (var o = !1, s = id(n), l = s.next(); !l.done; l = s.next())if (bo((l = l.value).info, r)) { l.sessionIds.push(r.sessionId), o = !0; break } o || n.push({ info: r, sessionIds: [r.sessionId] }) } g = id(n), k = g.next(); case 2: if (k.done) { a.A(4); break } return S = k.value, I = function (d, e, t) { return rd(function n() { var o, s; return od(n, function (a) { switch (a.l) { case 1: return o = new pt({ nb: e, onError: function () { }, gc: function () { }, onExpirationUpdated: function () { }, onEvent: function () { } }), b(a, 2), o.configure(d), dd(a, function (d, e, t, n, r, i) { var a = new Map; return a.set(e, { audioCapabilities: r, videoCapabilities: i, distinctiveIdentifier: "optional", persistentState: "required", sessionTypes: ["persistent-license"], label: e, drmInfos: [{ keySystem: e, licenseServerUri: t, distinctiveIdentifierRequired: !1, persistentStateRequired: !0, audioRobustness: "", videoRobustness: "", serverCertificate: n, initData: null, keyIds: null }] }), vt(d, a) }(o, t.info.keySystem, t.info.licenseUri, t.info.serverCertificate, t.info.audioCapabilities, t.info.videoCapabilities), 4); case 4: T(a, 3); break; case 2: return x(a), dd(a, o.destroy(), 5); case 5: return a.return([]); case 3: return b(a, 6), dd(a, mt(o), 8); case 8: T(a, 7); break; case 6: return x(a), dd(a, o.destroy(), 9); case 9: return a.return([]); case 7: return s = [], dd(a, Promise.all(t.sessionIds.map(function (a) { return rd(function e() { return od(e, function (e) { switch (e.l) { case 1: return b(e, 2), dd(e, function (d, e) { return rd(function t() { var o, s, p; return od(t, function (t) { switch (t.l) { case 1: return dd(t, Tt(d, e), 2); case 2: return (o = t.s) ? (s = [], (p = d.b.get(o)) && (p.ua = new ue, s.push(p.ua)), s.push(o.remove()), dd(t, Promise.all(s), 0)) : t.return(); } }) }) }(o, a), 4); case 4: s.push(a), T(e, 0); break; case 2: x(e), E(e); } }) }) })), 10); case 10: return dd(a, o.destroy(), 11); case 11: return a.return(s); } }) }) }(d, e, S), dd(a, I, 5); case 5: A = a.s, f = f.concat(A), k = g.next(), a.A(2); break; case 4: return a.return(f); } }) }) } function bo(a, e) { function t(a, e) { return a.robustness == e.robustness && a.contentType == e.contentType } return a.keySystem == e.keySystem && a.licenseUri == e.licenseUri && ke(a.audioCapabilities, e.audioCapabilities, t) && ke(a.videoCapabilities, e.videoCapabilities, t) } function ho(a, e) { var t = this; this.g = e, this.c = a, this.i = { va: null, u: null, mimeType: null, startTime: null, kd: null, uri: null }, this.h = null, this.f = [], this.b = this.a = null, this.j = !0, this.m = Promise.resolve().then(function () { return function (a) { return rd(function e() { return od(e, function (e) { switch (e.l) { case 1: if (a.j) { if (0 == a.f.length || a.a && !a.a.Ra) var t = !1; else { a.a && (a.a.qa.Ua(), a.a = null); var i = (t = a.f.shift()).create(a.i); i ? (t.qa.pb(), a.a = { node: i.node, payload: i.payload, Ra: i.Ra, qa: t.qa }) : t.qa.hc(), t = !0 } return t ? t = Promise.resolve() : a.a ? t = function (a) { return rd(function e() { var i, d; return od(e, function (e) { switch (e.l) { case 1: return a.c = a.g.Me(a.c, a.i, a.a.node, a.a.payload), b(e, 2), a.b = a.g.we(a.c, a.i, a.a.payload), dd(e, a.b.promise, 4); case 4: a.b = null, a.c == a.a.node && (a.a.qa.fc(), a.a = null), T(e, 0); break; case 2: return 7001 == (i = x(e)).code ? a.a.qa.Ua() : a.a.qa.onError(i), a.a = null, a.b = null, d = a, dd(e, a.g.handleError(a.i, i), 5); case 5: d.c = e.s, E(e); } }) }) }(a) : (a.g.cf(a.c), a.h = new ue, t = a.h), dd(e, t, 1) } e.A(0); } }) }) }(t) }) } function vo(a, e) { var t = { pb: function () { }, fc: function () { }, Ua: function () { }, onError: function () { }, hc: function () { }, tg: function () { } }; return a.f.push({ create: e, qa: t }), a.b && a.b.abort(), To(a), t } function To(t) { t.h && (t.h.resolve(), t.h = null) } function Eo(a) { this.a = null; for (var e = 0, i; e < a.textTracks.length; ++e)i = a.textTracks[e], i.mode = "disabled", "Shaka Player TextTrack" == i.label && (this.a = i); this.a || (this.a = a.addTextTrack("subtitles", "Shaka Player TextTrack")), this.a.mode = "hidden" } function xo(a) { if (a.startTime >= a.endTime) return null; var e = new VTTCue(a.startTime, a.endTime, a.payload); e.lineAlign = a.lineAlign, e.positionAlign = a.positionAlign, e.size = a.size; try { e.align = a.textAlign } catch (t) { } return "center" == a.textAlign && "center" != e.align && (e.align = "middle"), "vertical-lr" == a.writingMode ? e.vertical = "lr" : "vertical-rl" == a.writingMode && (e.vertical = "rl"), 1 == a.lineInterpretation && (e.snapToLines = !1), null != a.line && (e.line = a.line), null != a.position && (e.position = a.position), e } function ko(d, e) { var t = d.mode; d.mode = "showing" == t ? "showing" : "hidden"; for (var n = d.cues, r = n.length - 1, o; 0 <= r; r--)o = n[r], o && e(o) && d.removeCue(o); d.mode = t } function So(d, e, t, n, r) { var i = r in n, o = !0, p; for (p in e) { var l = r + "." + p, f = i ? n[r] : t[p]; i || p in t ? void 0 === e[p] ? void 0 === f || i ? delete d[p] : d[p] = Te(f) : f.constructor == Object && e[p] && e[p].constructor == Object ? (d[p] || (d[p] = Te(f)), l = So(d[p], e[p], f, n, l), o = o && l) : typeof e[p] != typeof f || null == e[p] || e[p].constructor != f.constructor ? o = !1 : d[p] = e[p] : o = !1 } return o } function Io(d, e) { for (var t = {}, n = t, o = 0, s = 0; !(0 > (o = d.indexOf(".", o)));)0 != o && "\\" == d[o - 1] || (n[s = d.substring(s, o).replace(/\\\./g, ".")] = {}, n = n[s], s = o + 1), o += 1; return n[d.substring(s).replace(/\\\./g, ".")] = e, t } function Ao() { } function Co() { var n = 5e5, d = 1 / 0; navigator.connection && (n = 1e6 * navigator.connection.downlink, navigator.connection.saveData && (d = 360)); var s = { retryParameters: { maxAttempts: 2, baseDelay: 1e3, backoffFactor: 2, fuzzFactor: .5, timeout: 0 }, availabilityWindowOverride: NaN, dash: { customScheme: function (t) { if (t) return null }, clockSyncUri: "", ignoreDrmInfo: !1, xlinkFailGracefully: !1, defaultPresentationDelay: 10, ignoreMinBufferTime: !1, autoCorrectDrift: !0 } }, r = { retryParameters: { maxAttempts: 2, baseDelay: 1e3, backoffFactor: 2, fuzzFactor: .5, timeout: 0 }, failureCallback: function () { }, rebufferingGoal: 2, bufferingGoal: 10, bufferBehind: 30, ignoreTextStreamFailures: !1, alwaysStreamText: !1, startAtSegmentBoundary: !1, smallGapLimit: .5, jumpLargeGaps: !1, durationBackoff: 1, forceTransmuxTS: !1, safeSeekOffset: 5, stallEnabled: !0, stallThreshold: 1, stallSkip: .1 }; Ye("Web0S") && (r.stallEnabled = !1); var i = { trackSelectionCallback: function (t) { return t }, progressCallback: function () { }, usePersistentLicense: !0 }, a = { drm: { retryParameters: { maxAttempts: 2, baseDelay: 1e3, backoffFactor: 2, fuzzFactor: .5, timeout: 0 }, servers: {}, clearKeys: {}, advanced: {}, delayLicenseRequestUntilPlayed: !1 }, manifest: s, streaming: r, offline: i, abrFactory: Gn, abr: { enabled: !0, defaultBandwidthEstimate: n, switchInterval: 8, bandwidthUpgradeTarget: .85, bandwidthDowngradeTarget: .95, restrictions: { minWidth: 0, maxWidth: 1 / 0, minHeight: 0, maxHeight: d, minPixels: 0, maxPixels: 1 / 0, minBandwidth: 0, maxBandwidth: 1 / 0 } }, preferredAudioLanguage: "", preferredTextLanguage: "", preferredVariantRole: "", preferredTextRole: "", preferredAudioChannelCount: 2, restrictions: { minWidth: 0, maxWidth: 1 / 0, minHeight: 0, maxHeight: 1 / 0, minPixels: 0, maxPixels: 1 / 0, minBandwidth: 0, maxBandwidth: 1 / 0 }, playRangeStart: 0, playRangeEnd: 1 / 0, textDisplayFactory: function () { return null } }; return i.trackSelectionCallback = function (t) { return function (d, e) { var t = d.filter(function (t) { return "variant" == t.type }), s = [], p = Rn(e, t.map(function (t) { return t.language })); p && (s = t.filter(function (t) { return _n(t.language) == p })), 0 == s.length && (s = t.filter(function (t) { return t.primary })), 0 == s.length && (t.map(function (t) { return t.language }), s = t); var i = s.filter(function (t) { return t.height && 480 >= t.height }); if (i.length && (i.sort(function (a, e) { return e.height - a.height }), s = i.filter(function (t) { return t.height == i[0].height })), t = [], s.length) { var a = Math.floor(s.length / 2); s.sort(function (a, e) { return a.bandwidth - e.bandwidth }), t.push(s[a]) } for (s = id(d), a = s.next(); !a.done; a = s.next())"text" == (a = a.value).type && t.push(a); return t }(t, a.preferredAudioLanguage) }, a } function _o(a, e, t) { var n = { ".drm.servers": "", ".drm.clearKeys": "", ".drm.advanced": { distinctiveIdentifierRequired: !1, persistentStateRequired: !1, videoRobustness: "", audioRobustness: "", serverCertificate: new Uint8Array(0), individualizationServer: "" } }; return So(a, e, t || Co(), n, "") } function wo() { this.a = null, this.b = [] } function Ro(a, e) { if (null == a.a) a.a = { timestamp: Date.now() / 1e3, state: e, duration: 0 }; else { var t = Date.now() / 1e3; a.a.duration = t - a.a.timestamp, a.a.state != e && (a.b.push(a.a), a.a = { timestamp: t, state: e, duration: 0 }) } } function Lo(a, e) { var t = 0; a.a && a.a.state == e && (t += a.a.duration); for (var d = id(a.b), r = d.next(); !r.done; r = d.next())t += (r = r.value).state == e ? r.duration : 0; return t } function Do() { this.b = this.c = null, this.a = [] } function Po(a, e, t) { a.b != e && (a.b = e, a.a.push({ timestamp: Date.now() / 1e3, id: e.id, type: "text", fromAdaptation: t, bandwidth: null })) } function No() { this.f = this.j = this.c = this.h = this.i = this.g = this.m = NaN, this.a = new wo, this.b = new Do } function Oo(e, t) { var d = this; ve.call(this), this.g = dl, this.a = null, this.$a = !1, this.i = new Le, this.rc = this.j = this.xb = this.c = this.m = this.f = this.Pb = this.V = this.Qb = this.K = this.bb = this.o = this.C = this.h = this.N = null, this.Fd = 1e9, this.Tb = new Set, this.eb = !0, this.ka = null, this.Bd = !1, this.zd = 0, this.ja = null, this.F = new ca, this.b = Fo(this), this.Ub = { width: 1 / 0, height: 1 / 0 }, this.v = null, this.Rb = new Ta(this.b.preferredAudioLanguage, this.b.preferredVariantRole, this.b.preferredAudioChannelCount), this.Ka = this.b.preferredTextLanguage, this.yb = this.b.preferredTextRole, t && t(this), this.N = function (a) { return new Ae(function (e, t) { a.j && a.j.segmentDownloaded(e, t) }) }(this), De(this.i, ed, "online", function () { d.cd() }), this.w = { name: "detach" }, this.S = { name: "attach" }, this.Ca = { name: "unload" }, this.Ac = { name: "manifest-parser" }, this.yc = { name: "manifest" }, this.ab = { name: "media-source" }, this.sc = { name: "drm-engine" }, this.W = { name: "load" }, this.Dc = { name: "src-equals-drm-engine" }, this.cb = { name: "src-equals" }; var a = new Map; a.set(this.S, function (a, e) { return me(function (a, e, t) { return null == e.u && (e.u = t.u, De(a.i, e.u, "error", function () { var e = as(a); e && a.Ha(e) })), a.a = e.u, Promise.resolve() }(d, a, e)) }), a.set(this.w, function (t) { return t.u && (d.i.ma(t.u, "error"), t.u = null), d.a = null, me(t = Promise.resolve()) }), a.set(this.Ca, function (t) { return me(Mo(d, t)) }), a.set(this.ab, function (e) { return me(e = function (e, t) { return rd(function n() { var d, p, l, u; return od(n, function (a) { switch (a.l) { case 1: return d = ed.muxjs ? new _t : new wt, p = e.b.textDisplayFactory, l = new p, e.tc = p, dd(a, (u = new ln(t.u, d, l)).o, 2); case 2: e.C = u, E(a); } }) }) }(d, e)) }), a.set(this.Ac, function (a, e) { return me(function (d, e, t) { return rd(function n() { var s, p, l; return od(n, function (a) { switch (a.l) { case 1: if (e.va = t.va, e.mimeType = t.mimeType, e.uri = t.uri, s = e.uri, p = d.N, d.xb = s, e.va) { d.m = e.va(), a.A(2); break } return l = d, dd(a, rl.create(s, p, d.b.manifest.retryParameters, e.mimeType), 3); case 3: l.m = a.s; case 2: d.m.configure(d.b.manifest), E(a); } }) }) }(d, a, e)) }), a.set(this.yc, function (t) { return function (a, e) { var d = e.uri, t = a.N; a.Pb = new Ya, function (a, e) { a.c = e }(a.Pb, function (e) { ts(a, "timelineregionadded", e) }); var n = { networkingEngine: t, filterNewPeriod: function (e) { return a.Bc(e) }, filterAllPeriods: function (e) { return Vo(a, e) }, onTimelineRegionAdded: function (e) { var t = a.Pb; e: { for (var n = id(t.b), d = n.next(); !d.done; d = n.next())if ((d = d.value).schemeIdUri == e.schemeIdUri && d.startTime == e.startTime && d.endTime == e.endTime) { n = d; break e } n = null } null == n && (t.b.add(e), t.c(e)) }, onEvent: function (e) { return a.dispatchEvent(e) }, onError: function (e) { return a.Ha(e) } }; return new de(Promise.resolve().then(function () { return rd(function e() { var i; return od(e, function (e) { switch (e.l) { case 1: return i = a, dd(e, a.m.start(d, n), 2); case 2: if (i.c = e.s, a.dispatchEvent(new be("manifestparsed")), 0 == a.c.periods.length) throw new le(2, 4, 4014); !function (a) { function n(t) { return t.video && t.audio || t.video && t.video.codecs.includes(",") } a.some(function (t) { return t.variants.some(n) }) && a.forEach(function (t) { t.variants = t.variants.filter(n) }) }(a.c.periods), E(e); } }) }) }), function () { return a.m.stop() }) }(d, t) }), a.set(this.sc, function () { return me(function (a) { return rd(function e() { return od(e, function (e) { switch (e.l) { case 1: return a.h = new pt({ nb: a.N, onError: function (e) { a.Ha(e) }, gc: function (e) { ns(a, e) }, onExpirationUpdated: function (e, t) { is(a, e, t) }, onEvent: function (e) { a.dispatchEvent(e) } }), a.h.configure(a.b.drm), dd(e, ct(a.h, Na(a.c.periods), a.c.offlineSessionIds), 2); case 2: Vo(a, a.c.periods), E(e); } }) }) }(d)) }), a.set(this.W, function (a, e) { return me(function (p, f, e) { return rd(function t() { var n, m, g, y, b, v, T, x, k; return od(t, function (t) { switch (t.l) { case 1: return f.startTime = e.startTime, n = f.u, m = f.uri, p.xb = m, p.v = new No, g = function () { return Go(p) }, y = function () { var e = p.a.playbackRate; 0 != e && p.K.set(e) }, De(p.i, n, "playing", g), De(p.i, n, "pause", g), De(p.i, n, "ended", g), De(p.i, n, "ratechange", y), b = p.b.abrFactory, p.j && p.rc == b || (p.rc = b, p.j = new b, p.j.configure(p.b.abr)), function (d, e) { for (var t = 0; t < e.length; t++) { for (var p = e[t], r = new Map, l = id(p.variants), f = l.next(); !f.done; f = l.next())if ((f = f.value).video && f.video.closedCaptions) for (var m = id((f = f.video).closedCaptions.keys()), s = m.next(); !s.done; s = m.next())if (s = s.value, !r.has(s)) { var g = { id: d.Fd++, originalId: s, createSegmentIndex: Promise.resolve.bind(Promise), findSegmentPosition: function () { return null }, getSegmentReference: function () { return null }, initSegmentReference: null, presentationTimeOffset: 0, mimeType: "application/cea-608", codecs: "", kind: "caption", encrypted: !1, keyId: null, language: f.closedCaptions.get(s), label: null, type: "text", primary: !1, trickModeVideo: null, emsgSchemeIdUris: null, roles: f.roles, channelsCount: null, closedCaptions: null }; r.set(s, g) } for (r = id(r.values()), l = r.next(); !l.done; l = r.next())p.textStreams.push(l.value) } }(p, p.c.periods), p.Rb = new Ta(p.b.preferredAudioLanguage, p.b.preferredVariantRole, p.b.preferredAudioChannelCount), p.Ka = p.b.preferredTextLanguage, function (a, e, t) { 0 < e && (a.U() || a.be(e)), t < a.Y() && (a.U() || a.ta(t)) }(p.c.presentationTimeline, p.b.playRangeStart, p.b.playRangeEnd), dd(t, p.h.zb(n), 2); case 2: return p.j.init(function (e, t, d) { t = void 0 !== t && t, d = void 0 === d ? 0 : d; e: { for (var o = id(p.c.periods), s = o.next(); !s.done; s = o.next())if ((s = s.value).variants.includes(e)) { o = s; break e } o = null } jo(p, o, e, !0), p.f && (ld(p.f, e, t, d), Yo(p)) }), p.o = function (a, e) { return new za(a.a, a.c, a.b.streaming, e, function () { a.bb && Ma(a.bb, !0), a.f && function (d) { function e(e) { var a = d.a.L; return e = "text" == e ? null != (e = a.a).a && null != e.b && s >= e.a && s < e.b : Dt(e = Tn(a, e), s, n), e } var s = d.a.Qa(), n = d.g.smallGapLimit, t = xd(d, s); if (Ve(d.b.values(), function (a) { return a.ya == t })) for (var i = id(d.b.keys()), a = i.next(); !a.done; a = i.next())e(a = a.value) || cd(d, d.b.get(a)); else Ve(d.b.keys(), e) || d.b.forEach(function (e) { cd(d, e) }) }(a.f) }, function (e) { return a.dispatchEvent(e) }) }(p, f.startTime), p.bb = function (a) { var e = new Oa(a.c); !function (a, e) { a.c = e }(e, function () { Qo(a) }); var t = new $a(a.Pb); !function (a, e, t, n) { a.b = e, a.c = t, a.f = n }(t, function (e) { ts(a, "timelineregionenter", e) }, function (e) { ts(a, "timelineregionexit", e) }, function (e, t) { t || (ts(a, "timelineregionenter", e), ts(a, "timelineregionexit", e)) }); var n = new _a(a.a); return n.b.add(e), n.b.add(t), n }(p), p.K = new La({ cc: function () { return f.u.playbackRate }, gd: function (t) { f.u.playbackRate = t }, Gd: function (t) { f.u.currentTime += t } }), v = Math.max(p.c.minBufferTime, p.b.streaming.rebufferingGoal), Uo(p, v), p.f = function (a) { return new Ja(a.c, { Qa: function () { return a.o.i() }, getBandwidthEstimate: function () { return a.j.getBandwidthEstimate() }, L: a.C, nb: a.N, Jd: a.af.bind(a), Id: a.re.bind(a), onError: a.Ha.bind(a), onEvent: function (e) { return a.dispatchEvent(e) }, ef: a.ff.bind(a), Vc: a.mf.bind(a) }) }(p), p.f.configure(p.b.streaming), function (d) { function o(a) { var e = ""; a.video && (e = Ge(a.video.codecs)[0]); var i = ""; return a.audio && (i = Ge(a.audio.codecs)[0]), e + "-" + i } var e = d.c.periods.reduce(function (a, e) { return a.concat(e.variants) }, []); e = Vn(e, d.b.preferredAudioChannelCount); var t = new he; e.forEach(function (a) { var e = o(a); t.push(e, a) }); var s = null, p = 1 / 0; t.forEach(function (a, e) { var t = 0, i = 0; e.forEach(function (a) { t += a.bandwidth || 0, ++i }); var d = t / i; d < p && (s = a, p = d) }), d.c.periods.forEach(function (t) { t.variants = t.variants.filter(function (t) { return o(t) == s }) }) }(p), p.g = ol, p.dispatchEvent(new be("streaming")), dd(t, p.f.start(), 3); case 3: p.b.streaming.startAtSegmentBoundary && (T = p.o.i(), x = function (d, e) { function t(a, e) { if (!a) return null; var t = a.findSegmentPosition(e - s.startTime); return null == t ? null : (t = a.getSegmentReference(t)) ? t.startTime + s.startTime : null } var n = Jr(d.f), o = $r(d.f), s = ps(d); return n = t(n, e), null != (o = t(o, e)) && null != n ? Math.max(o, n) : null == o ? null == n ? e : n : o }(p, T), p.o.o(x)), p.c.periods.forEach(p.Bc.bind(p)), Qo(p), Yo(p), (k = ps(p)).variants.some(function (t) { return t.primary }), Xo(p, k.variants), Pe(p.i, n, "loadeddata", function () { p.v.c = Date.now() / 1e3 - e.kd }), E(t); } }) }) }(d, a, e)) }), a.set(this.Dc, function (t) { return me(t = function (a, e) { return rd(function t() { var d, o; return od(t, function (t) { switch (t.l) { case 1: return d = Vt, a.h = new pt({ nb: a.N, onError: function (e) { a.Ha(e) }, gc: function (e) { ns(a, e) }, onExpirationUpdated: function (e, t) { is(a, e, t) }, onEvent: function (e) { a.dispatchEvent(e) } }), a.h.configure(a.b.drm), o = { id: 0, language: "und", primary: !1, audio: null, video: { id: 0, originalId: null, createSegmentIndex: Promise.resolve.bind(Promise), findSegmentPosition: function () { return null }, getSegmentReference: function () { return null }, initSegmentReference: null, presentationTimeOffset: 0, mimeType: "video/mp4", codecs: "", encrypted: !0, keyId: null, language: "und", label: null, type: d.La, primary: !1, trickModeVideo: null, emsgSchemeIdUris: null, roles: [], channelsCount: null, closedCaptions: null }, bandwidth: 100, drmInfos: [], allowedByApplication: !0, allowedByKeySystem: !0 }, dd(t, ct(a.h, [o], []), 2); case 2: return dd(t, a.h.zb(e.u), 0); } }) }) }(d, t)) }), a.set(this.cb, function (a, e) { return function (d, o, e) { function t() { return Go(d) } if (o.uri = e.uri, o.startTime = e.startTime, d.xb = o.uri, d.v = new No, d.o = new qa(o.u), null != o.startTime && d.o.o(o.startTime), d.K = new La({ cc: function () { return o.u.playbackRate }, gd: function (t) { o.u.playbackRate = t }, Gd: function (t) { o.u.currentTime += t } }), Uo(d, d.b.streaming.rebufferingGoal), De(d.i, o.u, "playing", t), De(d.i, o.u, "pause", t), De(d.i, o.u, "ended", t), Pe(d.i, o.u, "loadeddata", function () { d.v.c = Date.now() / 1e3 - e.kd }), d.a.audioTracks && (De(d.i, d.a.audioTracks, "addtrack", function () { return Qo(d) }), De(d.i, d.a.audioTracks, "removetrack", function () { return Qo(d) })), d.a.textTracks) { var n = d.a.textTracks; De(d.i, n, "addtrack", function () { return Qo(d) }), De(d.i, n, "removetrack", function () { return Qo(d) }) } o.u.src = o.uri, d.g = sl, d.dispatchEvent(new be("streaming")); var i = new ue; return d.a.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA ? i.resolve() : d.a.error ? i.reject(as(d)) : (Pe(d.i, d.a, "loadeddata", function () { i.resolve() }), Pe(d.i, d.a, "error", function () { i.reject(as(d)) })), new de(i, function () { return i.reject(new le(2, 7, 7001)), Promise.resolve() }) }(d, a, e) }), this.fb = new ho(this.w, { Me: function (r, e, t, n) { var i = null; return r == d.w && (i = t == d.w ? d.w : d.S), r == d.S && (i = t == d.w || e.u != n.u ? d.w : t == d.S ? d.S : t == d.ab || t == d.W ? d.ab : t == d.cb ? d.Dc : null), r == d.ab && (i = t == d.W && e.u == n.u ? d.Ac : d.Ca), r == d.Ac && (i = cs(d.W, d.yc, d.Ca, t, e, n)), r == d.yc && (i = cs(d.W, d.sc, d.Ca, t, e, n)), r == d.sc && (i = cs(d.W, d.W, d.Ca, t, e, n)), r == d.Dc && (i = t == d.cb && e.u == n.u ? d.cb : d.Ca), r != d.W && r != d.cb || (i = d.Ca), r == d.Ca && (i = n.u && e.u == n.u ? d.S : d.w), i }, we: function (i, e, t) { return d.dispatchEvent(new be("onstatechange", { state: i.name })), a.get(i)(e, t) }, handleError: function (a) { return rd(function e() { return od(e, function (e) { switch (e.l) { case 1: return dd(e, Mo(d, a), 2); case 2: return e.return(a.u ? d.S : d.w); } }) }) }, cf: function (t) { d.dispatchEvent(new be("onstateidle", { state: t.name })) } }), e && this.zb(e, !0) } function Mo(a, e) { return rd(function t() { return od(t, function (t) { switch (t.l) { case 1: if (a.g != Ls && (a.g = dl), a.dispatchEvent(new be("unloading")), e.va = null, e.mimeType = null, e.startTime = null, e.uri = null, e.u && (a.i.ma(e.u, "loadeddata"), a.i.ma(e.u, "playing"), a.i.ma(e.u, "pause"), a.i.ma(e.u, "ended"), a.i.ma(e.u, "ratechange")), a.bb && (a.bb.a(), a.bb = null), a.Qb && (a.Qb.stop(), a.Qb = null), !a.m) { t.A(2); break } return dd(t, a.m.stop(), 3); case 3: a.m = null; case 2: if (!a.j) { t.A(4); break } return dd(t, a.j.stop(), 4); case 4: if (!a.f) { t.A(6); break } return dd(t, a.f.destroy(), 7); case 7: a.f = null; case 6: if (a.o && (a.o.a(), a.o = null), !a.C) { t.A(8); break } return dd(t, a.C.destroy(), 9); case 9: a.C = null; case 8: if (e.u && e.u.src && (e.u.removeAttribute("src"), e.u.load()), !a.h) { t.A(10); break } return dd(t, a.h.destroy(), 11); case 11: a.h = null; case 10: a.F.a.clear(), a.xb = null, a.V = null, a.Tb.clear(), a.c = null, a.v = null, a.tc = null, a.eb = !0, zo(a), E(t); } }) }) } function Uo(d, e) { d.V = new Ea(e, Math.min(.5, e / 2)), d.V.a = 0, zo(d), d.Qb = new ee(function () { switch (d.g) { case sl: var e = !!d.a.ended || Lt(d.a.buffered) >= d.a.duration - .1; break; case ol: e: { var o; if ((o = d.a.ended) || (o = !(o = d.C).g || "ended" == o.g.readyState), o) e = !0; else { if (d.c.presentationTimeline.U() && (o = d.c.presentationTimeline.jb(), Lt(d.a.buffered) >= o)) { e = !0; break e } e = !1 } } break; default: e = !1; }var s = Pt(d.a.buffered, d.a.currentTime), p = e, i = (o = d.V).b.get(o.a); e = o.a, s = p || s >= i ? 1 : 0, o.a = s, e != s && zo(d) }).Ia(.25) } function Bo(a) { if (a.m && a.m.configure(a.b.manifest), a.h && a.h.configure(a.b.drm), a.f) { a.f.configure(a.b.streaming); try { a.c.periods.forEach(a.Bc.bind(a)) } catch (e) { a.Ha(e) } var e = Jr(a.f), d = $r(a.f), o = ps(a); e = zn(e, d, o.variants), a.j && e && e.allowedByApplication && e.allowedByKeySystem ? Xo(a, o.variants) : Wo(a, o) } if (a.C && (o = a.b.textDisplayFactory, a.tc != o)) { e = new o; var s = (d = a.C).h; d.h = e, s && (e.setTextVisibility(s.isTextVisible()), s.destroy()), d.a && (d.a.c = e), a.tc = o, a.f && (e = (o = a.f).b.get("text")) && ud(o, e.stream, !0, 0, !0) } a.j && (a.j.configure(a.b.abr), a.b.abr.enabled && !a.eb ? a.j.enable() : a.j.disable(), es(a)) } function jo(a, i, t, n) { pa(a.F, i).variant = t, (a = a.v.b).c != t && (a.c = t, a.a.push({ timestamp: Date.now() / 1e3, id: t.id, type: "variant", fromAdaptation: n, bandwidth: t.bandwidth })) } function Fo(a) { var e = Co(); return e.streaming.failureCallback = function (e) { a.U() && [1001, 1002, 1003].includes(e.code) && (e.severity = 1, a.cd()) }, e.textDisplayFactory = function () { return new Eo(a.a) }, e } function Vo(a, e) { var t = a.f ? Jr(a.f) : null, i = a.f ? $r(a.f) : null; if (e.forEach(Nn.bind(null, a.h, t, i)), 0 == (t = function (a, i) { var t = 0; return a.forEach(function (a) { t += i(a) ? 1 : 0 }), t }(e, function (t) { return t.variants.some(Fn) }))) throw new le(2, 4, 4032); if (t < e.length) throw new le(2, 4, 4011); e.forEach(function (t) { Dn(t.variants, this.b.restrictions, this.Ub) && this.f && ps(this) == t && Qo(this), rs(this, t.variants) }.bind(a)) } function Ho(a, e, t, i) { t = void 0 !== t && t, i = void 0 === i ? 0 : i, a.eb ? (a.ka = e, a.Bd = t, a.zd = i) : (ld(a.f, e, t, i), Jo(a)) } function qo(a, e) { a.eb ? a.ja = e : (ud(a.f, e, !0, 0, !1), $o(a)) } function zo(a) { var e = a.Jc(); if (a.v && a.V && a.o) { var t = a.K; t.g = e, Da(t), Go(a) } a.dispatchEvent(new be("buffering", { buffering: e })) } function Go(a) { if (a.v && a.V) { var e = a.v.a; a.V.a == 0 ? Ro(e, "buffering") : a.a.paused ? Ro(e, "paused") : a.a.ended ? Ro(e, "ended") : Ro(e, "playing") } } function Xo(a, e) { try { rs(a, e) } catch (e) { return a.Ha(e), null } var t = e.filter(function (t) { return Fn(t) }); return t = a.Rb.create(t), a.j.setVariants(Array.from(t.values())), a.j.chooseVariant() } function Wo(a, e) { var t = Xo(a, e.variants); t && (jo(a, e, t, !0), Ho(a, t, !0)), (t = Hn(e.textStreams, a.Ka, a.yb)[0] || null) && (a.b.streaming.alwaysStreamText || a.Mc()) && (da(a.F, e, t), Po(a.v.b, t, !0), qo(a, t)), Yo(a) } function Yo(t) { ds(t, new be("adaptation")) } function Qo(t) { ds(t, new be("trackschanged")) } function Jo(t) { ds(t, new be("variantchanged")) } function $o(t) { ds(t, new be("textchanged")) } function Zo(t) { ds(t, new be("texttrackvisibility")) } function es(t) { ds(t, new be("abrstatuschanged", { sg: t.b.abr.enabled })) } function ts(a, e, t) { a.dispatchEvent(new be(e, { detail: { schemeIdUri: t.schemeIdUri, value: t.value, startTime: t.startTime, endTime: t.endTime, id: t.id, eventElement: t.eventElement } })) } function as(a) { if (!a.a.error) return null; var e = a.a.error.code; if (1 == e) return null; var t = a.a.error.msExtendedCode; return t && (0 > t && (t += Math.pow(2, 32)), t = t.toString(16)), new le(2, 3, 3016, e, t, a.a.error.message) } function ns(d, o) { if (d.f) { var e = ps(d), t = !1, n = Object.keys(o), s = 1 == n.length && "00" == n[0]; n.length && e.variants.forEach(function (a) { (function (a) { var e = []; return a.audio && e.push(a.audio), a.video && e.push(a.video), e })(a).forEach(function (e) { var r = a.allowedByKeySystem; e.keyId && (e = o[s ? "00" : e.keyId], a.allowedByKeySystem = !!e && !Rs.includes(e)), r != a.allowedByKeySystem && (t = !0) }) }), (n = zn(n = Jr(d.f), $r(d.f), e.variants)) && !n.allowedByKeySystem && Wo(d, e), t && (Qo(d), Xo(d, e.variants)) } } function is(a, e, t) { a.m && a.m.onExpirationUpdated && a.m.onExpirationUpdated(e, t), a.dispatchEvent(new be("expirationupdated")) } function rs(p, e) { var t = p.h ? He(p.h.S) : {}, n = Object.keys(t); n = n.length && "00" == n[0]; for (var f = !1, m = !1, g = [], o = [], s = id(e), u = s.next(), y; !u.done; u = s.next()) { y = [], (u = u.value).audio && y.push(u.audio), u.video && y.push(u.video); for (var b = (y = id(y)).next(); !b.done; b = y.next())if ((b = b.value).keyId) { var v = t[n ? "00" : b.keyId]; v ? Rs.includes(v) && (o.includes(v) || o.push(v)) : g.includes(b.keyId) || g.push(b.keyId) } u.allowedByApplication ? u.allowedByKeySystem && (f = !0) : m = !0 } if (!f) throw new le(2, 4, 4012, { hasAppRestrictions: m, missingKeys: g, restrictedKeyStatuses: o }) } function ds(a, e) { rd(function t() { return od(t, function (t) { switch (t.l) { case 1: return dd(t, Promise.resolve(), 2); case 2: a.g != Ls && a.dispatchEvent(e), E(t); } }) }) } function os(a) { for (var i = new Set, t = (a = id(a)).next(); !t.done; t = a.next())(t = t.value).language ? i.add(_n(t.language)) : i.add("und"); return i } function ss(d) { for (var o = new Map, t = (d = id(d)).next(), s; !t.done; t = d.next()) { s = t.value, t = "und"; var p = []; for (s.language && (t = _n(s.language)), (p = "variant" == s.type ? s.audioRoles : s.roles) && p.length || (p = [""]), o.has(t) || o.set(t, new Set), p = (s = id(p)).next(); !p.done; p = s.next())p = p.value, o.get(t).add(p) } var l = []; return o.forEach(function (a, e) { for (var t = id(a), n = t.next(); !n.done; n = t.next())l.push({ language: e, role: n.value }) }), l } function ps(a) { for (var i = a.o.i(), t = null, d = (a = id(a.c.periods)).next(); !d.done; d = a.next())(d = d.value).startTime <= i && (t = d); return t } function ls(a) { var e = ps(a); return pa(a.F, e).variant } function us() { return new le(2, 7, 7e3) } function cs(d, e, t, n, r, i) { return n == d && r.u == i.u && r.uri == i.uri && r.mimeType == i.mimeType && r.va == i.va ? e : t } function fs(a) { return new Promise(function (e, t) { a.Ua = function () { return t(us()) }, a.fc = function () { return e() }, a.onError = function (a) { return t(a) }, a.hc = function () { return t(us()) } }) } function ms(a, e) { var t = uo(new lo(a.ra(), a.$()), e.periods[0], new vi(null, 0)), i = e.appMetadata || {}; return t = gs(t), { offlineUri: a.toString(), originalManifestUri: e.originalManifestUri, duration: e.duration, size: e.size, expiration: e.expiration, tracks: t, appMetadata: i } } function gs(a) { for (var i = [], t = function (t) { return t.filter(function (t) { return Fn(t) }) }(a.variants), d = (t = id(t)).next(); !d.done; d = t.next())i.push(Mn(d.value)); for (t = (a = id(a.textStreams)).next(); !t.done; t = a.next())i.push(Un(t.value)); return i } function ys() { this.a = {} } function bs(a, e) { var t = a.a[e]; return null == t && (t = 0), t } function hs(t) { this.a = !1, this.b = new ue, this.c = t } function vs(a) { var d = new Es; a.periods.forEach(function (t, e) { var a = ks(t.variants); if (0 == e) for (var n = (a = id(a.a)).next(); !n.done; n = a.next())d.add(n.value); else !function (a, n) { a.a = a.a.filter(function (t) { return xs(n, t) }) }(d, a) }); for (var t = (a = id(a.periods)).next(); !t.done; t = a.next())(t = t.value).variants = t.variants.filter(function (t) { return xs(d, new Ts(t)) }) } function Ts(a) { var n = a.audio; a = a.video, this.b = n ? n.mimeType : null, this.a = n ? n.codecs.split(".")[0] : null, this.f = a ? a.mimeType : null, this.c = a ? a.codecs.split(".")[0] : null } function Es() { this.a = [] } function xs(a, n) { return a.a.some(function (t) { return n.b == t.b && n.a == t.a && n.f == t.f && n.c == t.c }) } function ks(a) { for (var i = new Es, t = (a = id(a)).next(); !t.done; t = a.next())i.add(new Ts(t.value)); return i } function Ss(a) { var n = this; if (a && a.constructor != Oo) throw new le(2, 9, 9008); this.b = this.a = null, a ? (this.a = a.b, this.b = a.Bb()) : (this.a = Co(), this.b = new Ae), this.f = !1, this.c = [], this.g = []; this.h = new hs(function () { return rd(function t() { var a; return od(t, function (t) { switch (t.l) { case 1: return a = function () { }, dd(t, Promise.all(n.g.map(function (t) { return t.then(a, a) })), 2); case 2: if (!!t) { t.A(3); break } return dd(t, n.b.destroy(), 3); case 3: n.a = null, n.b = null, E(t); } }) }) }) } function Is() { if (Xe()) e: { for (var a = id(eo.values()), n = a.next(); !n.done; n = a.next())if (n = (n = n.value)()) { n.destroy(), a = !0; break e } a = !1 } else a = !1; return a } function As(d, e) { for (var t = [], n = id(d.periods), r = n.next(); !r.done; r = n.next())for (var o = (r = id(r.value.streams)).next(); !o.done; o = r.next())o = o.value, e && "video" == o.contentType ? t.push({ contentType: qe(o.mimeType, o.codecs), robustness: d.drmInfo.videoRobustness }) : e || "audio" != o.contentType || t.push({ contentType: qe(o.mimeType, o.codecs), robustness: d.drmInfo.audioRobustness }); return t } function Cs(a, e, t) { return rd(function n() { return od(n, function (n) { switch (n.l) { case 1: return dd(n, function (d, e, t, n) { return rd(function r() { var p, l, u; return od(r, function (a) { switch (a.l) { case 1: return n.drmInfo ? (p = function (a) { var e = Array.from(a.a.keys()); if (!e.length) throw new le(2, 9, 9e3, "No supported storage mechanisms found"); return a.a.get(e[0]).getEmeSessionCell() }(t), l = n.sessionIds.map(function (t) { return { sessionId: t, keySystem: n.drmInfo.keySystem, licenseUri: n.drmInfo.licenseServerUri, serverCertificate: n.drmInfo.serverCertificate, audioCapabilities: As(n, !1), videoCapabilities: As(n, !0) } }), dd(a, yo(e, d, l), 2)) : a.return(); case 2: return u = a.s, dd(a, p.remove(u), 3); case 3: return dd(a, p.add(l.filter(function (t) { return -1 == u.indexOf(t.sessionId) })), 0); } }) }) }(a.b, a.a.drm, t, e), 0); } }) }) } function _s(d, e, t, n) { function r() { o += 1, d.a.offline.progressCallback(p, o / a) } var i = function (a) { var n = []; return a.periods.forEach(function (t) { t.streams.forEach(function (t) { null != t.initSegmentKey && n.push(t.initSegmentKey), t.segments.forEach(function (t) { n.push(t.dataKey) }) }) }), n }(n), a = i.length + 1, o = 0, p = ms(t, n); return Promise.all([e.removeSegments(i, r), e.removeManifests([t.key()], r)]) } function ws(d, e, p, t, n, r) { var a = { id: r.id, originalId: r.originalId, primary: r.primary, presentationTimeOffset: r.presentationTimeOffset || 0, contentType: r.type, mimeType: r.mimeType, codecs: r.codecs, frameRate: r.frameRate, kind: r.kind, language: r.language, label: r.label, width: r.width || null, height: r.height || null, initSegmentKey: null, encrypted: r.encrypted, keyId: r.keyId, segments: [], variantIds: [] }; n = n.presentationTimeline.Db(); var o = r.id; return function (a, e, i) { for (var n = null == (e = a.findSegmentPosition(e)) ? null : a.getSegmentReference(e); n;)i(n), n = a.getSegmentReference(++e) }(r, n, function (n) { var i = yi(n.c(), n.b, n.a, d.a.streaming.retryParameters); Nd(e, o, i, function (a, e, t) { return t = t.endTime - t.startTime, bs(a, e) * t }(t, r.id, n), function (e) { return p.addSegments([{ data: e }]).then(function (e) { d.c.push(e[0]), a.segments.push({ startTime: n.startTime, endTime: n.endTime, dataKey: e[0] }) }) }) }), (n = r.initSegmentReference) && (n = yi(n.c(), n.b, n.a, d.a.streaming.retryParameters), Nd(e, o, n, .5 * bs(t, r.id), function (e) { return p.addSegments([{ data: e }]).then(function (e) { d.c.push(e[0]), a.initSegmentKey = e[0] }) })), a } function Ds(t) { if (t.h.a) throw new le(2, 9, 7001) } function Ps() { if (!Is()) throw new le(2, 9, 9e3) } function Ns(a, e) { return rd(function t() { return od(t, function (t) { switch (t.l) { case 1: return a.g.push(e), h(t, 2), dd(t, e, 4); case 4: return t.return(t.s); case 2: k(t), xe(a.g, e), S(t, 0); } }) }) } function Ms(a) { for (var d = new Set, t = (a = id(a.periods)).next(); !t.done; t = a.next()) { for (var o = id((t = t.value).textStreams), s = o.next(); !s.done; s = o.next())d.add(s.value); for (o = (t = id(t.variants)).next(); !o.done; o = t.next())(o = o.value).audio && d.add(o.audio), o.video && d.add(o.video) } return d } function Us(a) { a.variants.map(function (t) { return t.video }); var d = new Set(a.variants.map(function (t) { return t.audio })); a = a.textStreams; for (var o = id(d), s = o.next(); !s.done; s = o.next())for (var p = (s = id(d)).next(); !p.done; p = s.next()); for (o = (d = id(a)).next(); !o.done; o = d.next())for (s = (o = id(a)).next(); !s.done; s = o.next()); } function Bs(a, e) { for (var i = { priority: e = e || 0, pe: a }, n = 0; n < pl.length; n++)if (pl[n].priority < e) return void pl.splice(n, 0, i); pl.push(i) } function js(a) { var e = a.type.replace(/^(webkit|moz|MS)/, "").toLowerCase(); if ("function" == typeof Event) var t = new Event(e, a); else (t = document.createEvent("Event")).initEvent(e, a.bubbles, a.cancelable); a.target.dispatchEvent(t) } function Fs(a, i, t) { if ("input" == a) switch (this.type) { case "range": a = "change"; }HTMLInputElement.prototype.originalAddEventListener.call(this, a, i, t) } function Vs() { var t = MediaSource.prototype.addSourceBuffer; MediaSource.prototype.addSourceBuffer = function () { for (var e = [], a = 0; a < arguments.length; ++a)e[a] = arguments[a]; return (e = t.apply(this, e)).abort = function () { }, e } } function Ks(a) { var i = a.target, t = i.mediaSource_; if (t.Cd) { for (a.preventDefault(), a.stopPropagation(), a.stopImmediatePropagation(), i.td = !0, a = 0; a < t.sourceBuffers.length; ++a)if (0 == t.sourceBuffers[a].td) return; t.Cd = !1 } } function Hs(a) { a = a.target; for (var n = 0; n < a.sourceBuffers.length; ++n)a.sourceBuffers[n].removeEventListener("updateend", Ks, !1); a.removeEventListener("sourceclose", Hs, !1) } function qs(a, e) { try { var t = new zs(a, e); return Promise.resolve(t) } catch (t) { return Promise.reject(t) } } function zs(d, e) { if (this.keySystem = d, d.startsWith("com.apple.fps")) for (var t = id(e), p = t.next(), l; !p.done; p = t.next()) { if (l = p.value, "required" == l.persistentState) p = null; else { p = { audioCapabilities: [], videoCapabilities: [], persistentState: "optional", distinctiveIdentifier: "optional", initDataTypes: l.initDataTypes, sessionTypes: ["temporary"], label: l.label }; var f = !1, m = !1; if (l.audioCapabilities) for (var g = id(l.audioCapabilities), y = g.next(); !y.done; y = g.next())if ((y = y.value).contentType) { f = !0; var b = y.contentType.split(";")[0]; WebKitMediaKeys.isTypeSupported(this.keySystem, b) && (p.audioCapabilities.push(y), m = !0) } if (l.videoCapabilities) for (y = (l = id(l.videoCapabilities)).next(); !y.done; y = l.next())(g = y.value).contentType && (f = !0, y = g.contentType.split(";")[0], WebKitMediaKeys.isTypeSupported(this.keySystem, y) && (p.videoCapabilities.push(g), m = !0)); f || (m = WebKitMediaKeys.isTypeSupported(this.keySystem, "video/mp4")), p = m ? p : null } if (p) return void (this.a = p) } throw (t = Error("Unsupported keySystem")).name = "NotSupportedError", t.code = DOMException.NOT_SUPPORTED_ERR, t } function Gs(a) { var e = this.mediaKeys; return e && e != a && Ws(e, null), delete this.mediaKeys, (this.mediaKeys = a) ? Ws(a, this) : Promise.resolve() } function Xs(t) { this.b = new WebKitMediaKeys(t), this.a = new Le, this.c = null } function Ws(a, e) { if (Oe(a.a), !e) return Promise.resolve(); De(a.a, e, "webkitneedkey", Qs); try { return 1 <= e.readyState ? e.webkitSetMediaKeys(a.b) : Pe(a.a, e, "loadedmetadata", function () { e.webkitSetMediaKeys(a.b) }), Promise.resolve() } catch (t) { return Promise.reject(t) } } function Ys(t) { ve.call(this), this.c = null, this.g = t, this.b = this.a = null, this.f = new Le, this.sessionId = "", this.expiration = NaN, this.closed = new ue, this.keyStatuses = new $s } function Qs(a) { var e = this.mediaKeys.c, t = new Event("encrypted"); t.initDataType = "cenc", t.initData = function (d, e) { function t(t) { new DataView(s.buffer).setUint32(a, t.byteLength, !0), a += 4, s.set(t, a), a += t.byteLength } var n = new Uint8Array(d); if (new DataView(n.buffer).getUint32(0, !0) + 4 != n.byteLength) throw Error("Malformed init data!"); var r = $e(n.slice(4), !0); r = new K(r).oa, r = new Uint8Array(at(r, !0)); var s = new Uint8Array(n.byteLength + 4 + r.byteLength + 4 + e.byteLength), a = 0; return s.set(n, a), a += n.byteLength, t(r), t(new Uint8Array(e)), s }(a.initData, e), this.dispatchEvent(t) } function Js(a, e) { var t = a.keyStatuses; t.size = null == e ? 0 : 1, t.a = e, a.dispatchEvent(new be("keystatuseschange")) } function $s() { this.size = 0, this.a = void 0 } function Zs(t) { this.f = [], this.b = [], this.a = [], new Vr().ca("pssh", this.c.bind(this)).parse(t.buffer) } function ep(a, e) { try { var t = new tp(a, e); return Promise.resolve(t) } catch (t) { return Promise.reject(t) } } function tp(d, e) { this.keySystem = d; for (var t = !1, p = 0; p < e.length; ++p) { var l = e[p], i = { audioCapabilities: [], videoCapabilities: [], persistentState: "optional", distinctiveIdentifier: "optional", initDataTypes: l.initDataTypes, sessionTypes: ["temporary"], label: l.label }, a = !1; if (l.audioCapabilities) for (var f = 0, m; f < l.audioCapabilities.length; ++f)if (m = l.audioCapabilities[f], m.contentType) { a = !0; var g = m.contentType.split(";")[0]; MSMediaKeys.isTypeSupported(this.keySystem, g) && (i.audioCapabilities.push(m), t = !0) } if (l.videoCapabilities) for (f = 0; f < l.videoCapabilities.length; ++f)(m = l.videoCapabilities[f]).contentType && (a = !0, g = m.contentType.split(";")[0], MSMediaKeys.isTypeSupported(this.keySystem, g) && (i.videoCapabilities.push(m), t = !0)); if (a || (t = MSMediaKeys.isTypeSupported(this.keySystem, "video/mp4")), "required" == l.persistentState && (t = !1), t) return void (this.a = i) } throw (t = Error("Unsupported keySystem")).name = "NotSupportedError", t.code = DOMException.NOT_SUPPORTED_ERR, t } function ap(a) { var e = this.mediaKeys; return e && e != a && ip(e, null), delete this.mediaKeys, (this.mediaKeys = a) ? ip(a, this) : Promise.resolve() } function np(t) { this.a = new MSMediaKeys(t), this.b = new Le } function ip(a, i) { if (Oe(a.b), !i) return Promise.resolve(); De(a.b, i, "msneedkey", dp); var t = a; try { return 1 <= i.readyState ? i.msSetMediaKeys(a.a) : i.addEventListener("loadedmetadata", function a() { i.msSetMediaKeys(t.a), i.removeEventListener("loadedmetadata", a) }), Promise.resolve() } catch (t) { return Promise.reject(t) } } function rp(t) { ve.call(this), this.c = null, this.g = t, this.b = this.a = null, this.f = new Le, this.sessionId = "", this.expiration = NaN, this.closed = new ue, this.keyStatuses = new sp } function dp(a) { if (a.initData) { var e = document.createEvent("CustomEvent"); e.initCustomEvent("encrypted", !1, !1, null), e.initDataType = "cenc", e.initData = function (a) { if (!a) return a; var i = new Zs(a); if (1 >= i.a.length) return a; for (var d = [], o = 0; o < i.a.length; o++)d.push(a.subarray(i.a[o].start, i.a[o].end + 1)); for (a = [], i = {}, o = id(d), d = o.next(); !d.done; i = { dc: i.dc }, d = o.next())i.dc = d.value, a.some(function (a) { return function (e) { return ut(e, a.dc) } }(i)) || a.push(i.dc); for (i = 0, o = id(a), d = o.next(); !d.done; d = o.next())i += d.value.length; for (i = new Uint8Array(i), o = 0, a = id(a), d = a.next(); !d.done; d = a.next())d = d.value, i.set(d, o), o += d.length; return i }(a.initData), this.dispatchEvent(e) } } function op(a, e) { var t = a.keyStatuses; t.size = null == e ? 0 : 1, t.a = e, a.dispatchEvent(new be("keystatuseschange")) } function sp() { this.size = 0, this.a = void 0 } function pp() { return Promise.reject(Error("The key system specified is not supported.")) } function lp(t) { return null == t ? Promise.resolve() : Promise.reject(Error("MediaKeys not supported.")) } function up() { throw new TypeError("Illegal constructor.") } function cp() { throw new TypeError("Illegal constructor.") } function fp(t) { return cl ? cl + t.charAt(0).toUpperCase() + t.slice(1) : t } function mp(a, e) { try { var t = new yp(a, e); return Promise.resolve(t) } catch (t) { return Promise.reject(t) } } function gp(a) { var e = this.mediaKeys; return e && e != a && hp(e, null), delete this.mediaKeys, (this.mediaKeys = a) && hp(a, this), Promise.resolve() } function yp(d, e) { this.a = this.keySystem = d; var t = !1; "org.w3.clearkey" == d && (this.a = "webkit-org.w3.clearkey", t = !1); var p = !1, m = document.getElementsByTagName("video"); m = m.length ? m[0] : document.createElement("video"); for (var g = 0; g < e.length; ++g) { var y = e[g], o = { audioCapabilities: [], videoCapabilities: [], persistentState: "optional", distinctiveIdentifier: "optional", initDataTypes: y.initDataTypes, sessionTypes: ["temporary"], label: y.label }, s = !1; if (y.audioCapabilities) for (var b = 0, h; b < y.audioCapabilities.length; ++b)if (h = y.audioCapabilities[b], h.contentType) { s = !0; var v = h.contentType.split(";")[0]; m.canPlayType(v, this.a) && (o.audioCapabilities.push(h), p = !0) } if (y.videoCapabilities) for (b = 0; b < y.videoCapabilities.length; ++b)(h = y.videoCapabilities[b]).contentType && (s = !0, m.canPlayType(h.contentType, this.a) && (o.videoCapabilities.push(h), p = !0)); if (s || (p = m.canPlayType("video/mp4", this.a) || m.canPlayType("video/webm", this.a)), "required" == y.persistentState && (t ? (o.persistentState = "required", o.sessionTypes = ["persistent-license"]) : p = !1), p) return void (this.b = o) } throw t = "Unsupported keySystem", "org.w3.clearkey" != d && "com.widevine.alpha" != d || (t = "None of the requested configurations were supported."), (t = Error(t)).name = "NotSupportedError", t.code = DOMException.NOT_SUPPORTED_ERR, t } function bp(t) { this.g = t, this.b = null, this.a = new Le, this.c = [], this.f = {} } function hp(a, e) { a.b = e, Oe(a.a); var t = cl; e && (De(a.a, e, t + "needkey", a.qf.bind(a)), De(a.a, e, t + "keymessage", a.$f.bind(a)), De(a.a, e, t + "keyadded", a.Yf.bind(a)), De(a.a, e, t + "keyerror", a.Zf.bind(a))) } function vp(a, e) { var t = a.f[e]; return t || ((t = a.c.shift()) ? (t.sessionId = e, a.f[e] = t) : null) } function Tp(a, e, t) { ve.call(this), this.f = a, this.h = !1, this.a = this.b = null, this.c = e, this.g = t, this.sessionId = "", this.expiration = NaN, this.closed = new ue, this.keyStatuses = new kp } function Ep(d, e, t) { if (d.h) return Promise.reject(Error("The session is already initialized.")); d.h = !0; try { if (!("persistent-license" == d.g)) n = new Uint8Array(e); else if (t) var n = new Uint8Array(et("LOAD_SESSION|" + t)); else { var s = et("PERSISTENT|"), i = new Uint8Array(s.byteLength + e.byteLength); i.set(new Uint8Array(s), 0), i.set(new Uint8Array(e), s.byteLength), n = i } } catch (t) { return Promise.reject(t) } d.b = new ue; var a = fp("generateKeyRequest"); try { d.f[a](d.c, n) } catch (e) { if ("InvalidStateError" != e.name) return d.b = null, Promise.reject(e); new ee(function () { try { d.f[a](d.c, n) } catch (e) { d.b.reject(e), d.b = null } }).O(.01) } return d.b } function xp(a, e) { var t = a.keyStatuses; t.size = null == e ? 0 : 1, t.a = e, a.dispatchEvent(new be("keystatuseschange")) } function kp() { this.size = 0, this.a = void 0 } function Sp(a) { if ("picture-in-picture" == (a = a.target).webkitPresentationMode) { document.pictureInPictureElement = a; var n = new Event("enterpictureinpicture"); a.dispatchEvent(n) } else document.pictureInPictureElement == a && (document.pictureInPictureElement = null), n = new Event("leavepictureinpicture"), a.dispatchEvent(n) } function Ip() { return this.webkitSupportsPresentationMode("picture-in-picture") ? (this.webkitSetPresentationMode("picture-in-picture"), document.pictureInPictureElement = this, Promise.resolve()) : Promise.reject(Error("PiP not allowed by video element")) } function Ap() { var t = document.pictureInPictureElement; return t ? (t.webkitSetPresentationMode("inline"), document.pictureInPictureElement = null, Promise.resolve()) : Promise.reject(Error("No picture in picture element found")) } function Cp() { return { droppedVideoFrames: this.webkitDroppedFrameCount, totalVideoFrames: this.webkitDecodedFrameCount, corruptedVideoFrames: 0, creationTime: NaN, totalFrameDelay: 0 } } function _p(e, t, a) { return new ed.TextTrackCue(e, t, a) } function wp(e, t, a) { return new ed.TextTrackCue(e + "-" + t + "-" + a, e, t, a) } function Rp() { } function Lp(a) { var e = []; if (!a) return e; for (var d = a.childNodes, n = 0, o; n < d.length; n++)o = "span" == d[n].nodeName && "p" == a.nodeName, d[n].nodeType != Node.ELEMENT_NODE || "br" == d[n].nodeName || o || (o = Lp(d[n]), e = e.concat(o)); return e.length || e.push(a), e } function Dp(d, e, p, f, m, i, g, y) { if (!d.hasAttribute("begin") && !d.hasAttribute("end") && /^\s*$/.test(d.textContent)) return null; !function d(e, t) { for (var n = e.childNodes, r = 0; r < n.length; r++)if ("br" == n[r].nodeName && 0 < r) n[r - 1].textContent += "\n"; else if (0 < n[r].childNodes.length) d(n[r], t); else if (t) { var o = n[r].textContent.trim(); o = o.replace(/\s+/g, " "), n[r].textContent = o } }(d, y), y = Bp(d.getAttribute("begin"), p); var b = Bp(d.getAttribute("end"), p); p = Bp(d.getAttribute("dur"), p); var h = d.textContent; if (null == b && null != p && (b = y + p), null == y || null == b) throw new le(2, 2, 2001); if (e = new Ht(y + e, b + e, h), (i = Up(d, "region", i, "")) && i.getAttribute("xml:id")) { var c = i.getAttribute("xml:id"); g = g.filter(function (t) { return t.id == c }), e.region = g[0] } return function (d, e, s, p, l) { "rtl" == Np(e, s, l, "direction") && (d.direction = "rtl"); var i = Np(e, s, l, "writingMode"); if ("tb" == i || "tblr" == i ? d.writingMode = "vertical-lr" : "tbrl" == i ? d.writingMode = "vertical-rl" : "rltb" == i || "rl" == i ? d.direction = "rtl" : i && (d.direction = "ltr"), (i = Np(e, s, l, "textAlign")) && (d.positionAlign = Sl[i], d.lineAlign = kl[i], d.textAlign = Jt[i.toUpperCase()]), (i = Np(e, s, l, "displayAlign")) && (d.displayAlign = Zt[i.toUpperCase()]), (i = Np(e, s, l, "color")) && (d.color = i), (i = Np(e, s, l, "backgroundColor")) && (d.backgroundColor = i), (i = Np(e, s, l, "fontFamily")) && (d.fontFamily = i), (i = Np(e, s, l, "fontWeight")) && "bold" == i && (d.fontWeight = 700), (i = Np(e, s, l, "wrapOption")) && "noWrap" == i && (d.wrapLine = !1), (i = Np(e, s, l, "lineHeight")) && i.match(gl) && (d.lineHeight = i), (i = Np(e, s, l, "fontSize")) && i.match(gl) && (d.fontSize = i), (i = Np(e, s, l, "fontStyle")) && (d.fontStyle = un[i.toUpperCase()]), p) { i = p.getAttribute("imagetype"); var u = p.getAttribute("encoding"); p = p.textContent, "PNG" == i && "Base64" == u && p && (d.backgroundImage = "data:image/png;base64," + p) } (s = Op(s, l, "textDecoration")) && Pp(d, s), (e = Mp(e, l, "textDecoration")) && Pp(d, e) }(e, d, i, f = Up(d, "smpte:backgroundImage", f, "#"), m), e } function Pp(a, e) { for (var t = e.split(" "), n = 0; n < t.length; n++)switch (t[n]) { case "underline": a.textDecoration.includes("underline") || a.textDecoration.push("underline"); break; case "noUnderline": a.textDecoration.includes("underline") && xe(a.textDecoration, "underline"); break; case "lineThrough": a.textDecoration.includes("lineThrough") || a.textDecoration.push("lineThrough"); break; case "noLineThrough": a.textDecoration.includes("lineThrough") && xe(a.textDecoration, "lineThrough"); break; case "overline": a.textDecoration.includes("overline") || a.textDecoration.push("overline"); break; case "noOverline": a.textDecoration.includes("overline") && xe(a.textDecoration, "overline"); } } function Np(a, i, t, n) { return (a = Mp(a, t, n)) ? a : Op(i, t, n) } function Op(d, o, t) { for (var n = Lp(d), r = 0, s; r < n.length; r++)if (s = _r.getAttributeNS(n[r], "http://www.w3.org/ns/ttml#styling", t), s) return s; return (d = Up(d, "style", o, "")) ? _r.getAttributeNS(d, "http://www.w3.org/ns/ttml#styling", t) : null } function Mp(a, i, t) { return (a = Up(a, "style", i, "")) ? _r.getAttributeNS(a, "http://www.w3.org/ns/ttml#styling", t) : null } function Up(d, o, s, n) { if (!d || 1 > s.length) return null; var r = null, p = d; for (d = null; p && !(d = p.getAttribute(o)) && (p = p.parentNode) instanceof Element;); if (o = d) for (d = 0; d < s.length; d++)if (n + s[d].getAttribute("xml:id") == o) { r = s[d]; break } return r } function Bp(d, e) { var t = null; if (bl.test(d)) { t = bl.exec(d); var s = +t[1], r = +t[2], i = +t[3], p = +t[4]; t = (i += (p += (+t[5] || 0) / e.b) / e.frameRate) + 60 * r + 3600 * s } else hl.test(d) ? t = jp(hl, d) : vl.test(d) ? t = jp(vl, d) : Tl.test(d) ? (t = Tl.exec(d), t = +t[1] / e.frameRate) : El.test(d) ? (t = El.exec(d), t = +t[1] / e.a) : xl.test(d) && (t = jp(xl, d)); return t } function jp(a, e) { var t = a.exec(e); return null == t || "" == t[0] ? null : (+t[4] || 0) / 1e3 + (+t[3] || 0) + 60 * (+t[2] || 0) + 3600 * (+t[1] || 0) } function Fp(a, i, t, n) { this.frameRate = +a || 30, this.b = +i || 1, this.a = +n, 0 == this.a && (this.a = a ? this.frameRate * this.b : 1), t && (a = /^(\d+) (\d+)$/g.exec(t)) && (this.frameRate *= +a[1] / +a[2]) } function Vp() { this.a = new Rp } function Kp() { } function Hp(a, e, i) { var d; (d = /^align:(start|middle|center|end|left|right)$/.exec(e)) ? (e = d[1], a.textAlign = "middle" == e ? "center" : Jt[e.toUpperCase()]) : (d = /^vertical:(lr|rl)$/.exec(e)) ? a.writingMode = "lr" == d[1] ? "vertical-lr" : "vertical-rl" : (d = /^size:([\d.]+)%$/.exec(e)) ? a.size = +d[1] : (d = /^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(e)) ? (a.position = +d[1], d[2] && (e = d[2], a.positionAlign = "line-left" == e || "start" == e ? "line-left" : "line-right" == e || "end" == e ? "line-right" : "center")) : (d = /^region:(.*)$/.exec(e)) ? (e = function (a, i) { var e = a.filter(function (t) { return t.id == i }); return e.length ? e[0] : null }(i, d[1])) && (a.region = e) : (i = /^line:([\d.]+)%(?:,(start|end|center))?$/.exec(e)) ? (a.lineInterpretation = 1, a.line = +i[1], i[2] && (a.lineAlign = an[i[2].toUpperCase()])) : (i = /^line:(-?\d+)(?:,(start|end|center))?$/.exec(e)) && (a.lineInterpretation = 0, a.line = +i[1], i[2] && (a.lineAlign = an[i[2].toUpperCase()])) } function qp(a) { if (null == (a = Li(a, /(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g))) return null; var i = +a[2], t = +a[3]; return 59 < i || 59 < t ? null : +a[4] / 1e3 + t + 60 * i + 3600 * (+a[1] || 0) } function zp() { this.a = null } function Gp(d, e, t) { var n, o, s; return new Vr().G("payl", Gr(function (t) { n = Qe(t) })).G("iden", Gr(function (t) { o = Qe(t) })).G("sttg", Gr(function (t) { s = Qe(t) })).parse(d), n ? function (a, d, o, s, r) { if (a = new Ht(s, r, a), d && (a.id = d), o) for (d = new Ni(o), o = Di(d); o;)Hp(a, o, []), Oi(d), o = Di(d); return a }(n, o, s, e, t) : null } var Xp = "function" == typeof Object.defineProperties ? Object.defineProperty : function (a, e, t) { a != Array.prototype && a != Object.prototype && (a[e] = t.value) }, Wp = void 0 !== ed && ed === this ? this : void 0 !== e && null != e ? e : this, i = (s = 0, function (t) { return "jscomp_symbol_" + (t || "") + s++ }), r, s; t("Promise", function (i) { function d(a) { this.b = 0, this.g = void 0, this.a = []; var n = this.c(); try { a(n.resolve, n.reject) } catch (t) { n.reject(t) } } function e() { this.a = null } function p(a) { return a instanceof d ? a : new d(function (e) { e(a) }) } if (i) return i; e.prototype.b = function (t) { null == this.a && (this.a = [], this.f()), this.a.push(t) }, e.prototype.f = function () { var t = this; this.c(function () { t.h() }) }; var t = Wp.setTimeout; e.prototype.c = function (a) { t(a, 0) }, e.prototype.h = function () { for (; this.a && this.a.length;) { var a = this.a; this.a = []; for (var e = 0, i; e < a.length; ++e) { i = a[e], a[e] = null; try { i() } catch (t) { this.g(t) } } } this.a = null }, e.prototype.g = function (t) { this.c(function () { throw t }) }, d.prototype.c = function () { function a(a) { return function (e) { t || (t = !0, a.call(i, e)) } } var i = this, t = !1; return { resolve: a(this.o), reject: a(this.f) } }, d.prototype.o = function (t) { if (t === this) this.f(new TypeError("A Promise cannot resolve to itself")); else if (t instanceof d) this.v(t); else { e: switch (typeof t) { case "object": var e = null != t; break e; case "function": e = !0; break e; default: e = !1; }e ? this.m(t) : this.h(t) } }, d.prototype.m = function (a) { var e; try { e = a.then } catch (t) { return void this.f(t) } "function" == typeof e ? this.w(e, a) : this.h(a) }, d.prototype.f = function (t) { this.i(2, t) }, d.prototype.h = function (t) { this.i(1, t) }, d.prototype.i = function (a, e) { if (0 != this.b) throw Error("Cannot settle(" + a + ", " + e + "): Promise already settled in state" + this.b); this.b = a, this.g = e, this.j() }, d.prototype.j = function () { if (null != this.a) { for (var t = 0; t < this.a.length; ++t)a.b(this.a[t]); this.a = null } }; var a = new e; return d.prototype.v = function (a) { var e = this.c(); a.Vb(e.resolve, e.reject) }, d.prototype.w = function (a, e) { var t = this.c(); try { a.call(e, t.resolve, t.reject) } catch (a) { t.reject(a) } }, d.prototype.then = function (t, e) { function n(a, e) { return "function" == typeof a ? function (e) { try { o(a(e)) } catch (t) { s(t) } } : e } var r = new d(function (a, e) { o = a, s = e }), o, s; return this.Vb(n(t, o), n(e, s)), r }, d.prototype.catch = function (t) { return this.then(void 0, t) }, d.prototype.Vb = function (i, e) { function t() { switch (n.b) { case 1: i(n.g); break; case 2: e(n.g); break; default: throw Error("Unexpected state: " + n.b); } } var n = this; null == this.a ? a.b(t) : this.a.push(t) }, d.resolve = p, d.reject = function (a) { return new d(function (e, t) { t(a) }) }, d.race = function (r) { return new d(function (e, t) { for (var n = id(r), i = n.next(); !i.done; i = n.next())p(i.value).Vb(e, t) }) }, d.all = function (t) { var e = id(t), n = e.next(); return n.done ? p([]) : new d(function (i, r) { function t(e) { return function (t) { a[e] = t, 0 == --d && i(a) } } var a = [], d = 0; do a.push(void 0), d++ , p(n.value).Vb(t(a.length - 1), r), n = e.next(); while (!n.done) }) }, d }), t("Promise.prototype.finally", function (t) { return t || function (a) { return this.then(function (e) { return Promise.resolve(a()).then(function () { return e }) }, function (e) { return Promise.resolve(a()).then(function () { throw e }) }) } }); var Yp = "function" == typeof Object.create ? Object.create : function (a) { function e() { } return e.prototype = a, new e }, v; if ("function" == typeof Object.setPrototypeOf) v = Object.setPrototypeOf; else { var Qp; e: { var Jp = {}; try { Jp.__proto__ = { le: !0 }, Qp = Jp.le; break e } catch (e) { } Qp = !1 } v = Qp ? function (a, e) { if (a.__proto__ = e, a.__proto__ !== e) throw new TypeError(a + " is not extensible"); return a } : null } var y = v; d.prototype.h = function (t) { this.s = t }, d.prototype.return = function (t) { this.a = { return: t }, this.l = this.b }, d.prototype.A = function (t) { this.l = t }, t("WeakMap", function (a) { function e(a) { if (this.a = (i += Math.random() + 1).toString(), a) { td(), ad(), a = id(a); for (var n; !(n = a.next()).done;)n = n.value, this.set(n[0], n[1]) } } function r(t) { w(t, n) || Xp(t, n, { value: {} }) } function t(a) { var n = Object[a]; n && (Object[a] = function (t) { return r(t), n(t) }) } if (function () { if (!a || !Object.seal) return !1; try { var e = Object.seal({}), t = Object.seal({}), n = new a([[e, 2], [t, 3]]); return 2 == n.get(e) && 3 == n.get(t) && (n.delete(e), n.set(t, 4), !n.has(e) && 4 == n.get(t)) } catch (t) { return !1 } }()) return a; var n = "$jscomp_hidden_" + Math.random(); t("freeze"), t("preventExtensions"), t("seal"); var i = 0; return e.prototype.set = function (a, e) { if (r(a), !w(a, n)) throw Error("WeakMap key fail: " + a); return a[n][this.a] = e, this }, e.prototype.get = function (t) { return w(t, n) ? t[n][this.a] : void 0 }, e.prototype.has = function (t) { return w(t, n) && w(t[n], this.a) }, e.prototype.delete = function (t) { return w(t, n) && w(t[n], this.a) && delete t[n][this.a] }, e }), t("Map", function (a) { function d() { var t = {}; return t.Aa = t.next = t.head = t } function e(a, e) { var t = a.a; return c(function () { if (t) { for (; t.head != a.a;)t = t.Aa; for (; t.next != t.head;)return t = t.next, { done: !1, value: e(t) }; t = null } return { done: !0, value: void 0 } }) } function p(d, e) { var t = e && typeof e; "object" == t || "function" == t ? l.has(e) ? t = l.get(e) : (t = "" + ++o, l.set(e, t)) : t = "p_" + e; var s = d.b[t]; if (s && w(d.b, t)) for (var r = 0, p; r < s.length; r++)if (p = s[r], e != e && p.key != p.key || e === p.key) return { id: t, list: s, index: r, X: p }; return { id: t, list: s, index: -1, X: void 0 } } function t(t) { if (this.b = {}, this.a = d(), this.size = 0, t) { t = id(t); for (var a; !(a = t.next()).done;)a = a.value, this.set(a[0], a[1]) } } if (function () { if (!a || "function" != typeof a || !a.prototype.entries || "function" != typeof Object.seal) return !1; try { var e = Object.seal({ x: 4 }), t = new a(id([[e, "s"]])); if ("s" != t.get(e) || 1 != t.size || t.get({ x: 4 }) || t.set({ x: 4 }, "t") != t || 2 != t.size) return !1; var n = t.entries(), r = n.next(); return !r.done && r.value[0] == e && "s" == r.value[1] && !(r = n.next()).done && 4 == r.value[0].x && "t" == r.value[1] && n.next().done } catch (t) { return !1 } }()) return a; td(), ad(); var l = new WeakMap; t.prototype.set = function (a, e) { var t = p(this, a); return t.list || (t.list = this.b[t.id] = []), t.X ? t.X.value = e : (t.X = { next: this.a, Aa: this.a.Aa, head: this.a, key: a, value: e }, t.list.push(t.X), this.a.Aa.next = t.X, this.a.Aa = t.X, this.size++), this }, t.prototype.delete = function (t) { return (t = p(this, t)).X && t.list && (t.list.splice(t.index, 1), t.list.length || delete this.b[t.id], t.X.Aa.next = t.X.next, t.X.next.Aa = t.X.Aa, t.X.head = null, this.size-- , !0) }, t.prototype.clear = function () { this.b = {}, this.a = this.a.Aa = d(), this.size = 0 }, t.prototype.has = function (t) { return !!p(this, t).X }, t.prototype.get = function (t) { return (t = p(this, t).X) && t.value }, t.prototype.entries = function () { return e(this, function (t) { return [t.key, t.value] }) }, t.prototype.keys = function () { return e(this, function (t) { return t.key }) }, t.prototype.values = function () { return e(this, function (t) { return t.value }) }, t.prototype.forEach = function (a, e) { for (var t = this.entries(), i; !(i = t.next()).done;)i = i.value, a.call(e, i[1], i[0], this) }, t.prototype[Symbol.iterator] = t.prototype.entries; var o = 0; return t }), t("Set", function (a) { function e(a) { if (this.a = new Map, a) { a = id(a); for (var n; !(n = a.next()).done;)this.add(n.value) } this.size = this.a.size } return function () { if (!a || "function" != typeof a || !a.prototype.entries || "function" != typeof Object.seal) return !1; try { var e = Object.seal({ x: 4 }), t = new a(id([e])); if (!t.has(e) || 1 != t.size || t.add(e) != t || 1 != t.size || t.add({ x: 4 }) != t || 2 != t.size) return !1; var n = t.entries(), r = n.next(); return !r.done && r.value[0] == e && r.value[1] == e && !(r = n.next()).done && r.value[0] != e && 4 == r.value[0].x && r.value[1] == r.value[0] && n.next().done } catch (t) { return !1 } }() ? a : (td(), ad(), e.prototype.add = function (t) { return this.a.set(t, t), this.size = this.a.size, this }, e.prototype.delete = function (t) { return t = this.a.delete(t), this.size = this.a.size, t }, e.prototype.clear = function () { this.a.clear(), this.size = 0 }, e.prototype.has = function (t) { return this.a.has(t) }, e.prototype.entries = function () { return this.a.entries() }, e.prototype.values = function () { return this.a.values() }, e.prototype.keys = e.prototype.values, e.prototype[Symbol.iterator] = e.prototype.values, e.prototype.forEach = function (a, e) { var t = this; this.a.forEach(function (n) { return a.call(e, n, n, t) }) }, e) }), t("Array.prototype.findIndex", function (t) { return t || function (a, e) { return R(this, a, e).Ad } }), t("Array.prototype.keys", function (t) { return t || function () { return function (a, d) { ad(), a instanceof String && (a += ""); var t = 0, o = { next: function () { if (t < a.length) { var e = t++; return { value: d(e, a[e]), done: !1 } } return o.next = function () { return { done: !0, value: void 0 } }, o.next() } }; return o[Symbol.iterator] = function () { return o }, o }(this, function (t) { return t }) } }), t("Object.is", function (t) { return t || function (a, e) { return a === e ? 0 !== a || 1 / a == 1 / e : a != a && e != e } }), t("Array.prototype.includes", function (t) { return t || function (d, e) { var t = this; t instanceof String && (t = t + ""); var o = t.length, r = e || 0; for (0 > r && (r = Math.max(r + o, 0)); r < o; r++) { var s = t[r]; if (s === d || Object.is(s, d)) return !0 } return !1 } }), t("String.prototype.includes", function (t) { return t || function (a, e) { return -1 !== L(this, a, "includes").indexOf(a, e || 0) } }), t("Array.from", function (t) { return t || function (d, o, s) { ad(), o = null == o ? function (t) { return t } : o; var n = [], r = d[Symbol.iterator]; if ("function" == typeof r) for (d = r.call(d); !(r = d.next()).done;)n.push(o.call(s, r.value)); else { r = d.length; for (var p = 0; p < r; p++)n.push(o.call(s, d[p])) } return n } }), t("String.prototype.startsWith", function (t) { return t || function (d, e) { for (var t = L(this, d, "startsWith"), n = t.length, r = d.length, i = Math.max(0, Math.min(0 | e, t.length)), s = 0; s < r && i < n;)if (t[i++] != d[s++]) return !1; return s >= r } }), t("Array.prototype.find", function (t) { return t || function (a, e) { return R(this, a, e).ge } }); var g = this; g.a = !0, B.prototype.getBandwidthEstimate = function (t) { return 128e3 > this.a ? t : Math.min(M(this.b), M(this.c)) }, ed.console && ed.console.log.bind && (F = console.warn.bind(console), j = console.error.bind(console)); var U = /^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/; (r = K.prototype).sa = "", r.Xa = "", r.oa = "", r.tb = null, r.fa = "", r.Oa = "", r.toString = function () { var a = [], e = this.sa; if (e && a.push(Q(e, W, !0), ":"), e = this.oa) { a.push("//"); var i = this.Xa; i && a.push(Q(i, W, !0), "@"), a.push(encodeURIComponent(e).replace(/%25([0-9a-fA-F]{2})/g, "%$1")), null != (e = this.tb) && a.push(":", e + "") } return (e = this.fa) && (this.oa && "/" != e.charAt(0) && a.push("/"), a.push(Q(e, "/" == e.charAt(0) ? re : ne, !0))), (e = this.a.toString()) && a.push("?", e), (e = this.Oa) && a.push("#", Q(e, ae)), a.join("") }, r.resolve = function (d) { var e = this.clone(); "data" === e.sa && (e = new K); var p = !!d.sa; p ? H(e, d.sa) : p = !!d.Xa, p ? e.Xa = d.Xa : p = !!d.oa, p ? e.oa = d.oa : p = null != d.tb; var l = d.fa; if (p) q(e, d.tb); else if (p = !!d.fa) { if ("/" != l.charAt(0)) if (this.oa && !this.fa) l = "/" + l; else { var u = e.fa.lastIndexOf("/"); -1 != u && (l = e.fa.substr(0, u + 1) + l) } if (".." == l || "." == l) l = ""; else if (-1 != l.indexOf("./") || -1 != l.indexOf("/.")) { u = 0 == l.lastIndexOf("/", 0), l = l.split("/"); for (var c = [], a = 0, f; a < l.length;)f = l[a++], "." == f ? u && a == l.length && c.push("") : ".." == f ? ((1 < c.length || 1 == c.length && "" != c[0]) && c.pop(), u && a == l.length && c.push("")) : (c.push(f), u = !0); l = c.join("/") } } return p ? e.fa = l : p = "" !== d.a.toString(), p ? X(e, d.a.clone()) : p = !!d.Oa, p && (e.Oa = d.Oa), e }, r.clone = function () { return new K(this) }; var W = /[#\/\?@]/g, ne = /[#\?:]/g, re = /[#\?]/g, ie = /[#\?@]/g, ae = /#/g; (r = $.prototype).ea = null, r.Xb = null, r.add = function (d, e) { if (!this.ea && (this.ea = {}, this.Xb = 0, this.a)) for (var t = this.a.split("&"), s = 0; s < t.length; s++) { var p = t[s].indexOf("="), i = null; if (0 <= p) { var l = t[s].substring(0, p); i = t[s].substring(p + 1) } else l = t[s]; l = decodeURIComponent(l.replace(/\+/g, " ")), i = i || "", this.add(l, decodeURIComponent(i.replace(/\+/g, " "))) } return this.a = null, (t = this.ea.hasOwnProperty(d) && this.ea[d]) || (this.ea[d] = t = []), t.push(e), this.Xb++ , this }, r.toString = function () { if (this.a) return this.a; if (!this.ea) return ""; var d = [], t; for (t in this.ea) for (var o = encodeURIComponent(t), n = this.ea[t], r = 0, s; r < n.length; r++)s = o, "" !== n[r] && (s += "=" + encodeURIComponent(n[r])), d.push(s); return this.a = d.join("&") }, r.clone = function () { var a = new $; if (a.a = this.a, this.ea) { var e = {}, n; for (n in this.ea) e[n] = this.ea[n].concat(); a.ea = e, a.Xb = this.Xb } return a }, Z.prototype.O = function (e) { var t = this; this.stop(); var a = !0, n = null; return this.a = function () { ed.clearTimeout(n), a = !1 }, n = ed.setTimeout(function () { a && t.b() }, 1e3 * e), this }, Z.prototype.stop = function () { this.a && (this.a(), this.a = null) }, D("shaka.util.Timer", ee), ee.prototype.oc = function () { return this.stop(), this.b(), this }, ee.prototype.tickNow = ee.prototype.oc, ee.prototype.O = function (a) { var e = this; return this.stop(), this.a = new Z(function () { e.b() }).O(a), this }, ee.prototype.tickAfter = ee.prototype.O, ee.prototype.Ia = function (a) { var e = this; return this.stop(), this.a = new Z(function () { e.a.O(a), e.b() }).O(a), this }, ee.prototype.tickEvery = ee.prototype.Ia, ee.prototype.stop = function () { this.a && (this.a.stop(), this.a = null) }, ee.prototype.stop = ee.prototype.stop, D("shaka.util.Error", le), le.prototype.toString = function () { return "shaka.util.Error " + JSON.stringify(this, null, "  ") }, le.Severity = { RECOVERABLE: 1, CRITICAL: 2 }, le.Category = { NETWORK: 1, TEXT: 2, MEDIA: 3, MANIFEST: 4, STREAMING: 5, DRM: 6, PLAYER: 7, CAST: 8, STORAGE: 9 }, le.Code = { UNSUPPORTED_SCHEME: 1e3, BAD_HTTP_STATUS: 1001, HTTP_ERROR: 1002, TIMEOUT: 1003, MALFORMED_DATA_URI: 1004, UNKNOWN_DATA_URI_ENCODING: 1005, REQUEST_FILTER_ERROR: 1006, RESPONSE_FILTER_ERROR: 1007, MALFORMED_TEST_URI: 1008, UNEXPECTED_TEST_REQUEST: 1009, INVALID_TEXT_HEADER: 2e3, INVALID_TEXT_CUE: 2001, UNABLE_TO_DETECT_ENCODING: 2003, BAD_ENCODING: 2004, INVALID_XML: 2005, INVALID_MP4_TTML: 2007, INVALID_MP4_VTT: 2008, UNABLE_TO_EXTRACT_CUE_START_TIME: 2009, BUFFER_READ_OUT_OF_BOUNDS: 3e3, JS_INTEGER_OVERFLOW: 3001, EBML_OVERFLOW: 3002, EBML_BAD_FLOATING_POINT_SIZE: 3003, MP4_SIDX_WRONG_BOX_TYPE: 3004, MP4_SIDX_INVALID_TIMESCALE: 3005, MP4_SIDX_TYPE_NOT_SUPPORTED: 3006, WEBM_CUES_ELEMENT_MISSING: 3007, WEBM_EBML_HEADER_ELEMENT_MISSING: 3008, WEBM_SEGMENT_ELEMENT_MISSING: 3009, WEBM_INFO_ELEMENT_MISSING: 3010, WEBM_DURATION_ELEMENT_MISSING: 3011, WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING: 3012, WEBM_CUE_TIME_ELEMENT_MISSING: 3013, MEDIA_SOURCE_OPERATION_FAILED: 3014, MEDIA_SOURCE_OPERATION_THREW: 3015, VIDEO_ERROR: 3016, QUOTA_EXCEEDED_ERROR: 3017, TRANSMUXING_FAILED: 3018, UNABLE_TO_GUESS_MANIFEST_TYPE: 4e3, DASH_INVALID_XML: 4001, DASH_NO_SEGMENT_INFO: 4002, DASH_EMPTY_ADAPTATION_SET: 4003, DASH_EMPTY_PERIOD: 4004, DASH_WEBM_MISSING_INIT: 4005, DASH_UNSUPPORTED_CONTAINER: 4006, DASH_PSSH_BAD_ENCODING: 4007, DASH_NO_COMMON_KEY_SYSTEM: 4008, DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED: 4009, DASH_CONFLICTING_KEY_IDS: 4010, UNPLAYABLE_PERIOD: 4011, RESTRICTIONS_CANNOT_BE_MET: 4012, NO_PERIODS: 4014, HLS_PLAYLIST_HEADER_MISSING: 4015, INVALID_HLS_TAG: 4016, HLS_INVALID_PLAYLIST_HIERARCHY: 4017, DASH_DUPLICATE_REPRESENTATION_ID: 4018, HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND: 4020, HLS_COULD_NOT_GUESS_MIME_TYPE: 4021, HLS_MASTER_PLAYLIST_NOT_PROVIDED: 4022, HLS_REQUIRED_ATTRIBUTE_MISSING: 4023, HLS_REQUIRED_TAG_MISSING: 4024, HLS_COULD_NOT_GUESS_CODECS: 4025, HLS_KEYFORMATS_NOT_SUPPORTED: 4026, DASH_UNSUPPORTED_XLINK_ACTUATE: 4027, DASH_XLINK_DEPTH_LIMIT: 4028, HLS_COULD_NOT_PARSE_SEGMENT_START_TIME: 4030, CONTENT_UNSUPPORTED_BY_BROWSER: 4032, CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM: 4033, HLS_AES_128_ENCRYPTION_NOT_SUPPORTED: 4034, INVALID_STREAMS_CHOSEN: 5005, NO_RECOGNIZED_KEY_SYSTEMS: 6e3, REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE: 6001, FAILED_TO_CREATE_CDM: 6002, FAILED_TO_ATTACH_TO_VIDEO: 6003, INVALID_SERVER_CERTIFICATE: 6004, FAILED_TO_CREATE_SESSION: 6005, FAILED_TO_GENERATE_LICENSE_REQUEST: 6006, LICENSE_REQUEST_FAILED: 6007, LICENSE_RESPONSE_REJECTED: 6008, ENCRYPTED_CONTENT_WITHOUT_DRM_INFO: 6010, NO_LICENSE_SERVER_GIVEN: 6012, OFFLINE_SESSION_REMOVED: 6013, EXPIRED: 6014, LOAD_INTERRUPTED: 7e3, OPERATION_ABORTED: 7001, NO_VIDEO_ELEMENT: 7002, CAST_API_UNAVAILABLE: 8e3, NO_CAST_RECEIVERS: 8001, ALREADY_CASTING: 8002, UNEXPECTED_CAST_ERROR: 8003, CAST_CANCELED_BY_USER: 8004, CAST_CONNECTION_TIMED_OUT: 8005, CAST_RECEIVER_APP_UNAVAILABLE: 8006, STORAGE_NOT_SUPPORTED: 9e3, INDEXED_DB_ERROR: 9001, DEPRECATED_OPERATION_ABORTED: 9002, REQUESTED_ITEM_NOT_FOUND: 9003, MALFORMED_OFFLINE_URI: 9004, CANNOT_STORE_LIVE_OFFLINE: 9005, STORE_ALREADY_IN_PROGRESS: 9006, NO_INIT_DATA_FOR_OFFLINE: 9007, LOCAL_PLAYER_INSTANCE_REQUIRED: 9008, NEW_KEY_OPERATION_NOT_SUPPORTED: 9011, KEY_NOT_FOUND: 9012, MISSING_STORAGE_CELL: 9013 }, ue.prototype.resolve = function () { }, ue.prototype.reject = function () { }, D("shaka.util.AbortableOperation", de), de.failed = pe, de.aborted = ce, de.completed = fe, de.notAbortable = me, de.prototype.abort = function () { return this.a = !0, this.Hd() }, de.prototype.abort = de.prototype.abort, de.all = ge, de.prototype.finally = function (t) { return this.promise.then(function () { return t(!0) }, function () { return t(!1) }), this }, de.prototype.finally = de.prototype.finally, de.prototype.T = function (a, d) { function o() { return r.reject(new le(2, 7, 7001)), e.abort() } var e = this, r = new ue; return this.promise.then(function (n) { e.a ? r.reject(new le(2, 7, 7001)) : a ? o = ye(a, n, r) : r.resolve(n) }, function (t) { d ? o = ye(d, t, r) : r.reject(t) }), new de(r, function () { return o() }) }, de.prototype.chain = de.prototype.T, be.prototype.preventDefault = function () { this.cancelable && (this.defaultPrevented = !0) }, be.prototype.stopImmediatePropagation = function () { this.a = !0 }, be.prototype.stopPropagation = function () { }, (r = he.prototype).push = function (a, e) { this.a.hasOwnProperty(a) ? this.a[a].push(e) : this.a[a] = [e] }, r.get = function (t) { return (t = this.a[t]) ? t.slice() : null }, r.getAll = function () { var a = [], t; for (t in this.a) a.push.apply(a, this.a[t]); return a }, r.remove = function (a, e) { var t = this.a[a]; if (t) for (var n = 0; n < t.length; ++n)t[n] == e && (t.splice(n, 1), --n) }, r.forEach = function (a) { for (var e in this.a) a(e, this.a[e]) }, ve.prototype.addEventListener = function (a, e) { this.xc.push(a, e) }, ve.prototype.removeEventListener = function (a, e) { this.xc.remove(a, e) }, ve.prototype.dispatchEvent = function (a) { for (var e = this.xc.get(a.type) || [], t = 0; t < e.length; ++t) { a.target = this.Sb, a.currentTarget = this.Sb; var i = e[t]; try { i.handleEvent ? i.handleEvent(a) : i.call(this, a) } catch (t) { } if (a.a) break } return a.defaultPrevented }, Se.prototype.destroy = function () { var a = []; return this.a.forEach(function (e) { e.promise.catch(function () { }), a.push(e.abort()) }), this.a = [], Promise.all(a) }, P(Ae, ve), D("shaka.net.NetworkingEngine", Ae); var oe = { MANIFEST: 0, SEGMENT: 1, LICENSE: 2, APP: 3, TIMING: 4 }; Ae.RequestType = oe, Ae.PluginPriority = { FALLBACK: 1, PREFERRED: 2, APPLICATION: 3 }; var Me = {}; Ae.registerScheme = Ce, Ae.unregisterScheme = function (t) { delete Me[t] }, Ae.prototype.yf = function (t) { this.a.add(t) }, Ae.prototype.registerRequestFilter = Ae.prototype.yf, Ae.prototype.dg = function (t) { this.a.delete(t) }, Ae.prototype.unregisterRequestFilter = Ae.prototype.dg, Ae.prototype.te = function () { this.a.clear() }, Ae.prototype.clearAllRequestFilters = Ae.prototype.te, Ae.prototype.zf = function (t) { this.b.add(t) }, Ae.prototype.registerResponseFilter = Ae.prototype.zf, Ae.prototype.eg = function (t) { this.b.delete(t) }, Ae.prototype.unregisterResponseFilter = Ae.prototype.eg, Ae.prototype.ue = function () { this.b.clear() }, Ae.prototype.clearAllResponseFilters = Ae.prototype.ue, Ae.prototype.destroy = function () { return this.f = !0, this.a.clear(), this.b.clear(), this.g.destroy() }, Ae.prototype.destroy = Ae.prototype.destroy, Ae.prototype.request = function (d, e) { var p = this, t = new we; if (this.f) { var n = Promise.reject(new le(2, 7, 7001)); return n.catch(function () { }), new Re(n, function () { return Promise.resolve() }, t) } e.method = e.method || "GET", e.headers = e.headers || {}, e.retryParameters = e.retryParameters ? Te(e.retryParameters) : { maxAttempts: 2, baseDelay: 1e3, backoffFactor: 2, fuzzFactor: .5, timeout: 0 }, e.uris = Te(e.uris); var r = (n = function (d, o, t) { for (var n = fe(void 0), s = {}, p = (d = id(d.a)).next(); !p.done; s = { bd: s.bd }, p = d.next())s.bd = p.value, n = n.T(function (a) { return function () { return a.bd(o, t) } }(s)); return n.T(void 0, function (t) { if (t && 7001 == t.code) throw t; throw new le(2, 1, 1006, t) }) }(this, d, e)).T(function () { return function d(p, t, e, n, i, r, o) { var s = new K(e.uris[i]), u = s.sa, m = !1; u || (u = location.protocol, u = u.slice(0, -1), H(s, u), e.uris[i] = s.toString()); var g = (u = Me[u]) ? u.wf : null; if (!g) return pe(new le(2, 1, 1e3, s)); var f; return me(se(n)).T(function () { return p.f ? ce() : (f = Date.now(), g(e.uris[i], e, t, function (a, e, n) { p.c && 1 == t && (p.c(a, e), m = !0, o.a = n) })) }).T(function (t) { return null == t.timeMs && (t.timeMs = Date.now() - f), { response: t, We: m } }, function (a) { if (a && 7001 == a.code) throw a; if (p.f) return ce(); if (a && 1 == a.severity) return p.dispatchEvent(new be("retry", { error: a instanceof le ? a : null })), i = (i + 1) % e.uris.length, d(p, t, e, n, i, a, o); throw a || r }) }(p, d, e, new te(e.retryParameters, !1), 0, null, t) }), a = r.T(function (e) { return function (a, d, t) { for (var n = fe(void 0), o = (a = id(a.b)).next(); !o.done; o = a.next())n = n.T(o.value.bind(null, d, t.response)); return n.T(function () { return t }, function (a) { if (a && 7001 == a.code) throw a; var e = 2; throw a instanceof le && (e = a.severity), new le(e, 1, 1007, a) }) }(p, d, e) }), o = Date.now(), s = 0; n.promise.then(function () { s = Date.now() - o }, function () { }); var l = 0; return r.promise.then(function () { l = Date.now() }, function () { }), n = new Re((n = a.T(function (e) { var t = Date.now() - l, a = e.response; return a.timeMs += s, a.timeMs += t, e.We || !p.c || a.fromCache || 1 != d || p.c(a.timeMs, a.data.byteLength), a }, function (t) { throw t && (t.severity = 2), t })).promise, n.Hd, t), Ie(this.g, n), n }, Ae.prototype.request = Ae.prototype.request, Ae.NumBytesRemainingClass = we; var Ne = Re; if (Ne.prototype = Yp(de.prototype), Ne.prototype.constructor = Ne, y) y(Ne, de); else for (var je in de) if ("prototype" != je) if (Object.defineProperties) { var Ue = Object.getOwnPropertyDescriptor(de, je); Ue && Object.defineProperty(Ne, je, Ue) } else Ne[je] = de[je]; Ne.bg = de.prototype, Ae.PendingRequest = Re, Re.all = ge, Re.notAbortable = me, Re.completed = fe, Re.aborted = ce, Re.failed = pe, Le.prototype.a = function () { Oe(this), this.b = null }, Le.prototype.ma = function (a, e, t) { if (this.b) for (var n = this.b.get(e) || [], d = (n = id(n)).next(); !d.done; d = n.next())(d = d.value).target != a || t != d.listener && t || (d.ma(), this.b.remove(e, d)) }, Fe.prototype.ma = function () { this.target.removeEventListener(this.type, this.listener, this.a), this.listener = this.target = null, this.a = !1 }; var Be = void 0, $p = new Map().set("codecs", "codecs").set("frameRate", "framerate").set("bandwidth", "bitrate").set("width", "width").set("height", "height").set("channelsCount", "channels"), Je = null, Zp = null; D("shaka.util.StringUtils.fromUTF8", Qe), D("shaka.util.StringUtils.fromUTF16", $e), D("shaka.util.StringUtils.fromBytesAutoDetect", Ze), D("shaka.util.StringUtils.toUTF8", et), D("shaka.util.StringUtils.toUTF16", at), D("shaka.util.Uint8ArrayUtils.toBase64", rt), D("shaka.util.Uint8ArrayUtils.fromBase64", ot), D("shaka.util.Uint8ArrayUtils.fromHex", st), D("shaka.util.Uint8ArrayUtils.toHex", lt), D("shaka.util.Uint8ArrayUtils.equal", ut), D("shaka.util.Uint8ArrayUtils.concat", dt), (r = pt.prototype).destroy = function () { var a = this; return rd(function e() { return od(e, function (e) { switch (e.l) { case 1: return a.c ? dd(e, a.W, 0) : (a.c = !0, dd(e, function (a) { return rd(function e() { var i; return od(e, function (e) { switch (e.l) { case 1: return a.i.a(), a.i = null, a.j.reject(), a.V.stop(), a.V = null, a.K.stop(), a.K = null, i = Array.from(a.b.keys()), a.b.clear(), dd(e, Promise.all(i.map(function (a) { return Promise.resolve().then(function () { return rd(function e() { return od(e, function (e) { switch (e.l) { case 1: return b(e, 2), dd(e, function (a) { return rd(function e() { var i; return od(e, function (e) { switch (e.l) { case 1: return i = new Promise(function (t) { new ee(t).O(el) }), dd(e, Promise.race([a.close().then(function () { return !0 }), i.then(function () { return !1 })]), 2); case 2: E(e); } }) }) }(a), 4); case 4: T(e, 0); break; case 2: x(e), E(e); } }) }) }) })), 2); case 2: if (!a.m) { e.A(3); break } return b(e, 4), dd(e, a.m.setMediaKeys(null), 6); case 6: T(e, 5); break; case 4: x(e); case 5: a.m = null; case 3: a.a = null, a.v.clear(), a.h = null, a.o = [], a.f = null, a.g = null, a.w = null, E(e); } }) }) }(a), 4)); case 4: a.W.resolve(), e.A(0); } }) }) }, r.configure = function (t) { this.f = t }, r.zb = function (a) { var i = this; if (!this.h) return Pe(this.i, a, "encrypted", function () { i.g(new le(2, 6, 6010)) }), Promise.resolve(); this.m = a, Pe(this.i, this.m, "play", function () { for (var t = 0; t < i.F.length; t++)xt(i, i.F[t]); i.ja = !0, i.F = [] }), a = (a = this.m.setMediaKeys(this.h)).catch(function (t) { return Promise.reject(new le(2, 6, 6003, t.message)) }); var t = mt(this); return Promise.all([a, t]).then(function () { return i.c ? Promise.reject() : void (gt(i), i.a.initData.length || i.o.length || De(i.i, i.m, "encrypted", function (t) { return yt(i, t.initDataType, new Uint8Array(t.initData)) })) }).catch(function (t) { if (!i.c) return Promise.reject(t) }) }, r.keySystem = function () { return this.a ? this.a.keySystem : "" }, r.bc = function () { for (var a = 1 / 0, i = this.b.keys(), r = (i = id(i)).next(); !r.done; r = i.next())r = r.value, isNaN(r.expiration) || (a = Math.min(a, r.expiration)); return a }, r.Pd = function (t) { this.f.delayLicenseRequestUntilPlayed && this.m.paused && !this.ja ? this.F.push(t) : xt(this, t) }, r.Nd = function (a) { a = a.target; var d = this.b.get(a), t = !1; a.keyStatuses.forEach(function (n, p) { if ("string" == typeof p) { var l = p; p = n, n = l } if ("com.microsoft.playready" == this.a.keySystem && 16 == p.byteLength && !Ye("Tizen")) { var u = (l = new DataView(p)).getUint32(0, !0), a = l.getUint16(4, !0), o = l.getUint16(6, !0); l.setUint32(0, u, !1), l.setUint16(4, a, !1), l.setUint16(6, o, !1) } "com.microsoft.playready" == this.a.keySystem && "status-pending" == n && (n = "usable"), "status-pending" != n && (d.loaded = !0), "expired" == n && (t = !0), l = lt(new Uint8Array(p)), this.ka.set(l, n) }.bind(this)); var i = a.expiration - Date.now(); (0 > i || t && 1e3 > i) && d && !d.ua && (this.b.delete(a), a.close().catch(function () { })), At(this) && (this.j.resolve(), this.K.O(Rt)) }; var el = 1, Nt = 5, Rt = .5; _t.prototype.init = function (a) { var n = muxjs.mp4.probe; a = new Uint8Array(a), this.g = n.videoTrackIds(a), this.f = n.timescale(a), this.a.init() }, _t.prototype.b = function (a, e) { var t = new Uint8Array(a); (t = this.a.parse(t, this.g, this.f)) && t.captions && e(t.captions), this.a.clearParsedCaptions() }, _t.prototype.c = function () { this.a.resetCaptionStream() }, wt.prototype.init = function () { }, wt.prototype.b = function () { }, wt.prototype.c = function () { }; var Ot = { ve: function (a, e) { return a.reduce(function (a, e, t) { return e.catch(a.bind(null, t)) }.bind(null, e), Promise.reject()) }, uc: function (a, e) { return a.concat(e) }, Gb: function () { }, Da: function (t) { return null != t } }, Vt = { La: "video", wb: "audio", na: "text", lg: "application" }, qt = 1 / 15; jt.prototype.destroy = function () { return this.a.dispose(), this.a = null, Promise.resolve() }, jt.prototype.i = function (a) { this.c = a.captions; var e = new Uint8Array(a.data.byteLength + a.initSegment.byteLength); e.set(a.initSegment, 0), e.set(a.data, a.initSegment.byteLength), this.g.push(e) }, jt.prototype.h = function () { var t = { data: dt.apply(null, this.g), captions: this.c }; this.b.resolve(t), this.f = !1 }, D("shaka.text.Cue", Ht); var zt = "auto"; Ht.positionAlign = { LEFT: "line-left", RIGHT: "line-right", CENTER: "center", AUTO: "auto" }; var $t = "center", Jt = { LEFT: "left", RIGHT: "right", CENTER: "center", START: "start", END: "end" }; Ht.textAlign = Jt; var Qt = "after", Zt = { BEFORE: "before", CENTER: "center", AFTER: "after" }; Ht.displayAlign = Zt; var en = "ltr"; Ht.direction = { HORIZONTAL_LEFT_TO_RIGHT: "ltr", HORIZONTAL_RIGHT_TO_LEFT: "rtl" }; var tn = "horizontal-tb"; Ht.writingMode = { HORIZONTAL_TOP_TO_BOTTOM: "horizontal-tb", VERTICAL_LEFT_TO_RIGHT: "vertical-lr", VERTICAL_RIGHT_TO_LEFT: "vertical-rl" }; var nn = 0; Ht.lineInterpretation = { LINE_NUMBER: 0, PERCENTAGE: 1 }; var rn = "start", an = { CENTER: "center", START: "start", END: "end" }; Ht.lineAlign = an; var on = 400; Ht.fontWeight = { NORMAL: 400, BOLD: 700 }; var sn = "normal", un = { NORMAL: "normal", ITALIC: "italic", OBLIQUE: "oblique" }; Ht.fontStyle = un, Ht.textDecoration = { UNDERLINE: "underline", LINE_THROUGH: "lineThrough", OVERLINE: "overline" }, D("shaka.text.CueRegion", Gt); var cn = 1; Gt.units = { PX: 0, PERCENTAGE: 1, LINES: 2 }; var fn = ""; Gt.scrollMode = { NONE: "", UP: "up" }; var hn = {}; D("shaka.text.TextEngine.registerParser", function (a, e) { hn[a] = e }), D("shaka.text.TextEngine.unregisterParser", function (t) { delete hn[t] }), Xt.prototype.destroy = function () { return this.c = this.g = null, this.i.clear(), Promise.resolve() }, Xt.prototype.Hc = function (t) { try { return this.g.parseMedia(new Uint8Array(t), { periodStart: 0, segmentStart: null, segmentEnd: 0 })[0].startTime } catch (t) { throw new le(2, 2, 2009, t) } }, Xt.prototype.remove = function (a, e) { return Promise.resolve().then(function () { !this.c || !this.c.remove(a, e) || null == this.a || e <= this.a || a >= this.b || (a <= this.a && e >= this.b ? this.a = this.b = null : a <= this.a && e < this.b ? this.a = e : a > this.a && e >= this.b && (this.b = a)) }.bind(this)) }, Xt.prototype.oe = function (t) { this.c.append(t) }, Xt.prototype.appendCues = Xt.prototype.oe, Xt.prototype.nc = function (a, d) { this.j = a; var e = this.i.get(a); if (e) for (var t = id(e.keys()), n = t.next(); !n.done; n = t.next())(n = e.get(n.value)) && (n = n.filter(function (t) { return t.endTime <= d }), this.c.append(n)) }, Xt.prototype.setSelectedClosedCaptionId = Xt.prototype.nc; var pn = ed.URL.createObjectURL; (r = ln.prototype).destroy = function () { var d = this; this.v = !0; var e = [], n; for (n in this.c) { var o = this.c[n], r = o[0]; for (this.c[n] = o.slice(0, 1), r && e.push(r.p.catch(Ot.Gb)), r = 1; r < o.length; ++r)o[r].p.catch(Ot.Gb), o[r].p.reject() } for (var s in this.a && e.push(this.a.destroy()), this.h && e.push(this.h.destroy()), this.j) e.push(this.j[s].destroy()); return Promise.all(e).then(function () { d.i && (d.i.a(), d.i = null), d.f && (d.f.removeAttribute("src"), d.f.load(), d.f = null), d.g = null, d.a = null, d.h = null, d.b = {}, d.j = {}, d.m = null, d.c = {} }) }, r.init = function (a, d) { var t = this; return rd(function e() { var n; return od(e, function (e) { switch (e.l) { case 1: return n = Vt, dd(e, t.o, 2); case 2: a.forEach(function (i, e) { var r = qe(i.mimeType, i.codecs); e == n.na ? gn(t, r) : (!d && MediaSource.isTypeSupported(r) || !Ft(r, e) || (t.j[e] = new jt, r = Kt(e, r)), r = t.g.addSourceBuffer(r), De(t.i, r, "error", t.Uf.bind(t, e)), De(t.i, r, "updateend", t.qb.bind(t, e)), t.b[e] = r, t.c[e] = []) }), E(e); } }) }) }, r.Ec = function (a) { if (a.total = Mt(this.f.buffered), a.audio = Mt(Tn(this, "audio")), a.video = Mt(Tn(this, "video")), a.text = [], this.a) { var e = this.a.a, t = this.a.b; null != e && null != t && a.text.push({ start: e, end: t }) } }, r.nc = function (a) { var e = vn(this, "video") || 0; this.a.nc(a, e) }, r.remove = function (a, e, t) { return "text" == a ? this.a.remove(e, t) : kn(this, a, this.de.bind(this, a, e, t)) }, r.flush = function (t) { return "text" == t ? Promise.resolve() : kn(this, t, this.ze.bind(this, t)) }, r.endOfStream = function (t) { return Sn(this, function () { t ? this.g.endOfStream(t) : this.g.endOfStream() }.bind(this)) }, r.ta = function (t) { return Sn(this, function () { this.g.duration = t }.bind(this)) }, r.Y = function () { return this.g.duration }, r.ce = function (a, e) { this.b[a].appendBuffer(e) }, r.de = function (a, e, t) { t <= e ? this.qb(a) : this.b[a].remove(e, t) }, r.me = function (a) { var e = this.b[a].appendWindowStart, t = this.b[a].appendWindowEnd; this.b[a].abort(), this.b[a].appendWindowStart = e, this.b[a].appendWindowEnd = t, this.qb(a) }, r.ze = function (t) { this.f.currentTime -= .001, this.qb(t) }, r.Pf = function (a, e) { 0 > e && (e += .001), this.b[a].timestampOffset = e, this.qb(a) }, r.Mf = function (a, e, t) { this.b[a].appendWindowStart = 0, this.b[a].appendWindowEnd = t, this.b[a].appendWindowStart = e, this.qb(a) }, r.Uf = function (t) { this.c[t][0].p.reject(new le(2, 3, 3014, this.f.error ? this.f.error.code : 0)) }, r.qb = function (a) { var e = this.c[a][0]; e && (e.p.resolve(), In(this, a)) }; var bn = new Map([["aar", "aa"], ["abk", "ab"], ["afr", "af"], ["aka", "ak"], ["alb", "sq"], ["amh", "am"], ["ara", "ar"], ["arg", "an"], ["arm", "hy"], ["asm", "as"], ["ava", "av"], ["ave", "ae"], ["aym", "ay"], ["aze", "az"], ["bak", "ba"], ["bam", "bm"], ["baq", "eu"], ["bel", "be"], ["ben", "bn"], ["bih", "bh"], ["bis", "bi"], ["bod", "bo"], ["bos", "bs"], ["bre", "br"], ["bul", "bg"], ["bur", "my"], ["cat", "ca"], ["ces", "cs"], ["cha", "ch"], ["che", "ce"], ["chi", "zh"], ["chu", "cu"], ["chv", "cv"], ["cor", "kw"], ["cos", "co"], ["cre", "cr"], ["cym", "cy"], ["cze", "cs"], ["dan", "da"], ["deu", "de"], ["div", "dv"], ["dut", "nl"], ["dzo", "dz"], ["ell", "el"], ["eng", "en"], ["epo", "eo"], ["est", "et"], ["eus", "eu"], ["ewe", "ee"], ["fao", "fo"], ["fas", "fa"], ["fij", "fj"], ["fin", "fi"], ["fra", "fr"], ["fre", "fr"], ["fry", "fy"], ["ful", "ff"], ["geo", "ka"], ["ger", "de"], ["gla", "gd"], ["gle", "ga"], ["glg", "gl"], ["glv", "gv"], ["gre", "el"], ["grn", "gn"], ["guj", "gu"], ["hat", "ht"], ["hau", "ha"], ["heb", "he"], ["her", "hz"], ["hin", "hi"], ["hmo", "ho"], ["hrv", "hr"], ["hun", "hu"], ["hye", "hy"], ["ibo", "ig"], ["ice", "is"], ["ido", "io"], ["iii", "ii"], ["iku", "iu"], ["ile", "ie"], ["ina", "ia"], ["ind", "id"], ["ipk", "ik"], ["isl", "is"], ["ita", "it"], ["jav", "jv"], ["jpn", "ja"], ["kal", "kl"], ["kan", "kn"], ["kas", "ks"], ["kat", "ka"], ["kau", "kr"], ["kaz", "kk"], ["khm", "km"], ["kik", "ki"], ["kin", "rw"], ["kir", "ky"], ["kom", "kv"], ["kon", "kg"], ["kor", "ko"], ["kua", "kj"], ["kur", "ku"], ["lao", "lo"], ["lat", "la"], ["lav", "lv"], ["lim", "li"], ["lin", "ln"], ["lit", "lt"], ["ltz", "lb"], ["lub", "lu"], ["lug", "lg"], ["mac", "mk"], ["mah", "mh"], ["mal", "ml"], ["mao", "mi"], ["mar", "mr"], ["may", "ms"], ["mkd", "mk"], ["mlg", "mg"], ["mlt", "mt"], ["mon", "mn"], ["mri", "mi"], ["msa", "ms"], ["mya", "my"], ["nau", "na"], ["nav", "nv"], ["nbl", "nr"], ["nde", "nd"], ["ndo", "ng"], ["nep", "ne"], ["nld", "nl"], ["nno", "nn"], ["nob", "nb"], ["nor", "no"], ["nya", "ny"], ["oci", "oc"], ["oji", "oj"], ["ori", "or"], ["orm", "om"], ["oss", "os"], ["pan", "pa"], ["per", "fa"], ["pli", "pi"], ["pol", "pl"], ["por", "pt"], ["pus", "ps"], ["que", "qu"], ["roh", "rm"], ["ron", "ro"], ["rum", "ro"], ["run", "rn"], ["rus", "ru"], ["sag", "sg"], ["san", "sa"], ["sin", "si"], ["slk", "sk"], ["slo", "sk"], ["slv", "sl"], ["sme", "se"], ["smo", "sm"], ["sna", "sn"], ["snd", "sd"], ["som", "so"], ["sot", "st"], ["spa", "es"], ["sqi", "sq"], ["srd", "sc"], ["srp", "sr"], ["ssw", "ss"], ["sun", "su"], ["swa", "sw"], ["swe", "sv"], ["tah", "ty"], ["tam", "ta"], ["tat", "tt"], ["tel", "te"], ["tgk", "tg"], ["tgl", "tl"], ["tha", "th"], ["tib", "bo"], ["tir", "ti"], ["ton", "to"], ["tsn", "tn"], ["tso", "ts"], ["tuk", "tk"], ["tur", "tr"], ["twi", "tw"], ["uig", "ug"], ["ukr", "uk"], ["urd", "ur"], ["uzb", "uz"], ["ven", "ve"], ["vie", "vi"], ["vol", "vo"], ["wel", "cy"], ["wln", "wa"], ["wol", "wo"], ["xho", "xh"], ["yid", "yi"], ["yor", "yo"], ["zha", "za"], ["zho", "zh"], ["zul", "zu"]]), Ln = 0; D("shaka.abr.SimpleAbrManager", Gn), Gn.prototype.stop = function () { this.h = null, this.f = !1, this.c = [], this.g = null }, Gn.prototype.stop = Gn.prototype.stop, Gn.prototype.init = function (t) { this.h = t }, Gn.prototype.init = Gn.prototype.init, Gn.prototype.chooseVariant = function () { var d = Xn(this.a.restrictions, this.c), o = this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate); this.c.length && !d.length && (d = [(d = Xn(null, this.c))[0]]); for (var t = d[0] || null, s = 0; s < d.length; ++s) { var p = d[s], i = (d[s + 1] || { bandwidth: 1 / 0 }).bandwidth / this.a.bandwidthUpgradeTarget; o >= p.bandwidth / this.a.bandwidthDowngradeTarget && o <= i && (t = p) } return this.g = Date.now(), t }, Gn.prototype.chooseVariant = Gn.prototype.chooseVariant, Gn.prototype.enable = function () { this.f = !0 }, Gn.prototype.enable = Gn.prototype.enable, Gn.prototype.disable = function () { this.f = !1 }, Gn.prototype.disable = Gn.prototype.disable, Gn.prototype.segmentDownloaded = function (a, e) { var t = this.b; if (!(16e3 > e)) { var d = 8e3 * e / a, r = a / 1e3; t.a += e, O(t.b, r, d), O(t.c, r, d) } if (null != this.g && this.f) e: { if (!this.i) { if (!(128e3 <= this.b.a)) break e; this.i = !0 } else if (Date.now() - this.g < 1e3 * this.a.switchInterval) break e; t = this.chooseVariant(), this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate), this.h(t) } }, Gn.prototype.segmentDownloaded = Gn.prototype.segmentDownloaded, Gn.prototype.getBandwidthEstimate = function () { return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate) }, Gn.prototype.getBandwidthEstimate = Gn.prototype.getBandwidthEstimate, Gn.prototype.setVariants = function (t) { this.c = t }, Gn.prototype.setVariants = Gn.prototype.setVariants, Gn.prototype.configure = function (t) { this.a = t }, Gn.prototype.configure = Gn.prototype.configure, Wn.prototype.toString = function () { return "v" + this.a + "." + this.b }; var tl = null, al = ["ended", "play", "playing", "pause", "pausing", "ratechange", "seeked", "seeking", "timeupdate", "volumechange"], rr = ["buffered", "currentTime", "duration", "ended", "loop", "muted", "paused", "playbackRate", "seeking", "videoHeight", "videoWidth", "volume"], ir = ["loop", "playbackRate"], ar = ["pause", "play"], or = ["abrstatuschanged", "adaptation", "buffering", "emsg", "error", "loading", "streaming", "texttrackvisibility", "timelineregionadded", "timelineregionenter", "timelineregionexit", "trackschanged", "unloading", "variantchanged", "textchanged"], sr = { getAssetUri: 2, getAudioLanguages: 2, getAudioLanguagesAndRoles: 2, getBufferedInfo: 2, getConfiguration: 2, getExpiration: 2, getPlaybackRate: 2, getTextLanguages: 2, getTextLanguagesAndRoles: 2, getTextTracks: 2, getStats: 5, getVariantTracks: 2, isAudioOnly: 10, isBuffering: 1, isInProgress: 1, isLive: 10, isTextTrackVisible: 1, keySystem: 10, seekRange: 1, usingEmbeddedTextTrack: 2, getLoadMode: 10 }, ur = { getPlayheadTimeAsDate: 1, getPresentationStartTimeAsDate: 20 }, cr = [["getConfiguration", "configure"]], lr = [["isTextTrackVisible", "setTextTrackVisibility"]], fr = ["addTextTrack", "cancelTrickPlay", "configure", "resetConfiguration", "retryStreaming", "selectAudioLanguage", "selectEmbeddedTextTrack", "selectTextLanguage", "selectTextTrack", "selectVariantTrack", "setTextTrackVisibility", "trickPlay"], hr = ["attach", "detach", "load", "unload"], dr = !1, nl = null; (r = er.prototype).destroy = function () { return pr(this), nl && tr(this), this.f && (this.f.stop(), this.f = null), this.K = this.F = null, this.b = this.h = !1, this.o = this.m = this.g = this.c = this.a = this.i = null, Promise.resolve() }, r.da = function () { return this.b }, r.Zc = function () { return this.C }, r.init = function () { if (ed.chrome && chrome.cast && chrome.cast.isAvailable) { delete ed.__onGCastApiAvailable, this.h = !0, this.f.oc(); var e = new chrome.cast.SessionRequest(this.N); e = new chrome.cast.ApiConfig(e, this.Md.bind(this), this.lf.bind(this), "origin_scoped"), chrome.cast.initialize(e, function () { }, function () { }), dr && this.f.O(.02), (e = nl) && e.status != chrome.cast.SessionStatus.STOPPED ? this.Md(e) : nl = null } else ed.__onGCastApiAvailable = function (t) { t && this.init() }.bind(this) }, r.ed = function (t) { this.i = t, this.b && mr({ type: "appData", appData: this.i }) }, r.cast = function (t) { return this.h ? dr ? this.b ? Promise.reject(new le(1, 8, 8002)) : (this.g = new ue, chrome.cast.requestSession(this.Wc.bind(this, t), this.Kd.bind(this)), this.g) : Promise.reject(new le(1, 8, 8001)) : Promise.reject(new le(1, 8, 8e3)) }, r.Zb = function () { this.b && (pr(this), nl && (tr(this), nl.stop(function () { }, function () { }), nl = null)) }, r.get = function (a, e) { if ("video" == a) { if (ar.includes(e)) return this.Wd.bind(this, a, e); } else if ("player" == a) { if (ur[e] && !this.get("player", "isLive")()) return function () { }; if (fr.includes(e)) return this.Wd.bind(this, a, e); if (hr.includes(e)) return this.Bf.bind(this, a, e); if (sr[e]) return this.Td.bind(this, a, e) } return this.Td(a, e) }, r.set = function (a, e, t) { this.a[a][e] = t, mr({ type: "set", targetName: a, property: e, value: t }) }, r.Wc = function (a, e) { nl = e, e.addUpdateListener(this.m), e.addMessageListener("urn:x-cast:com.google.shaka.v2", this.o), this.Ld(), mr({ type: "init", initState: a, appData: this.i }), this.g.resolve() }, r.Kd = function (a) { var e = 8003; switch (a.code) { case "cancel": e = 8004; break; case "timeout": e = 8005; break; case "receiver_unavailable": e = 8006; }this.g.reject(new le(2, 8, e, a)) }, r.Td = function (a, e) { return this.a[a][e] }, r.Wd = function (a, e) { for (var t = [], n = 2; n < arguments.length; ++n)t[n - 2] = arguments[n]; mr({ type: "call", targetName: a, methodName: e, args: t }) }, r.Bf = function (n, e) { for (var t = [], r = 2; r < arguments.length; ++r)t[r - 2] = arguments[r]; r = new ue; var d = this.v.toString(); return this.v++ , this.c[d] = r, mr({ type: "asyncCall", targetName: n, methodName: e, args: t, id: d }), r }, r.Md = function (a) { var e = this.w(); this.g = new ue, this.j = !0, this.Wc(e, a) }, r.lf = function (t) { dr = "available" == t, this.f.oc() }, r.Ld = function () { var a = !!nl && "connected" == nl.status; if (this.b && !a) { for (var e in this.K(), this.a) this.a[e] = {}; pr(this) } this.C = (this.b = a) ? nl.receiver.friendlyName : "", this.f.oc() }, r.gf = function (d, e) { var t = Zn(e); switch (t.type) { case "event": var o = t.event; this.F(t.targetName, new be(o.type, o)); break; case "update": for (var s in o = t.update) for (var p in t = this.a[s] || {}, o[s]) t[p] = o[s][p]; this.j && (this.S(), this.j = !1); break; case "asyncComplete": if (s = t.id, t = t.error, p = this.c[s], delete this.c[s], p) if (t) { for (o in s = new le(t.severity, t.category, t.code), t) s[o] = t[o]; p.reject(s) } else p.resolve(); } }, P(br, ve), D("shaka.cast.CastProxy", br), br.prototype.destroy = function (t) { return t && this.a && this.a.Zb(), this.i && (this.i.a(), this.i = null), t = [], this.b && (t.push(this.b.destroy()), this.b = null), this.a && (t.push(this.a.destroy()), this.a = null), this.j = this.h = this.c = null, Promise.all(t) }, br.prototype.destroy = br.prototype.destroy, br.prototype.Ve = function () { return this.h }, br.prototype.getVideo = br.prototype.Ve, br.prototype.Oe = function () { return this.j }, br.prototype.getPlayer = br.prototype.Oe, br.prototype.qe = function () { return !!this.a && this.a.h && dr }, br.prototype.canCast = br.prototype.qe, br.prototype.da = function () { return !!this.a && this.a.da() }, br.prototype.isCasting = br.prototype.da, br.prototype.Zc = function () { return this.a ? this.a.Zc() : "" }, br.prototype.receiverName = br.prototype.Zc, br.prototype.cast = function () { var t = this.yd(); return this.a.cast(t).then(function () { if (this.b) return this.b.nd() }.bind(this)) }, br.prototype.cast = br.prototype.cast, br.prototype.ed = function (t) { this.a.ed(t) }, br.prototype.setAppData = br.prototype.ed, br.prototype.ag = function () { var a = this.a; if (a.b) { var e = a.w(); chrome.cast.requestSession(a.Wc.bind(a, e), a.Kd.bind(a)) } }, br.prototype.suggestDisconnect = br.prototype.ag, br.prototype.Zb = function () { this.a.Zb() }, br.prototype.forceDisconnect = br.prototype.Zb, (r = br.prototype).yd = function () { var a = { video: {}, player: {}, playerAfterLoad: {}, manifest: this.b.$b(), startTime: null }; return this.c.pause(), ir.forEach(function (e) { a.video[e] = this.c[e] }.bind(this)), this.c.ended || (a.startTime = this.c.currentTime), cr.forEach(function (e) { var i = e[1]; e = this.b[e[0]](), a.player[i] = e }.bind(this)), lr.forEach(function (e) { var i = e[1]; e = this.b[e[0]](), a.playerAfterLoad[i] = e }.bind(this)), a }, r.Qf = function () { this.dispatchEvent(new be("caststatuschanged")) }, r.Rf = function () { this.f.dispatchEvent(new be(this.h.paused ? "pause" : "play")) }, r.Tf = function () { var d = this; cr.forEach(function (a) { var n = a[1]; a = this.a.get("player", a[0])(), this.b[n](a) }.bind(this)); var e = this.a.get("player", "getAssetUri")(), t = this.a.get("video", "ended"), n = Promise.resolve(), s = this.c.autoplay, i = null; t || (i = this.a.get("video", "currentTime")), e && (this.c.autoplay = !1, n = this.b.load(e, i)); var p = {}; ir.forEach(function (t) { p[t] = this.a.get("video", t) }.bind(this)), n.then(function () { d.c && (ir.forEach(function (t) { this.c[t] = p[t] }.bind(d)), lr.forEach(function (a) { var n = a[1]; a = this.a.get("player", a[0])(), this.b[n](a) }.bind(d)), d.c.autoplay = s, e && d.c.play()) }, function (e) { d.b.dispatchEvent(new be("error", { detail: e })) }) }, r.ig = function (a) { if ("addEventListener" == a) return this.f.addEventListener.bind(this.f); if ("removeEventListener" == a) return this.f.removeEventListener.bind(this.f); if (this.a.da() && 0 == Object.keys(this.a.a.video).length) { var n = this.c[a]; if ("function" != typeof n) return n } return this.a.da() ? this.a.get("video", a) : ("function" == typeof (a = this.c[a]) && (a = a.bind(this.c)), a) }, r.kg = function (a, e) { this.a.da() ? this.a.set("video", a, e) : this.c[a] = e }, r.jg = function (t) { this.a.da() || this.f.dispatchEvent(new be(t.type, t)) }, r.Sd = function (t) { if ("addEventListener" == t) return this.g.addEventListener.bind(this.g); if ("removeEventListener" == t) return this.g.removeEventListener.bind(this.g); if ("getMediaElement" == t) return function () { return this.h }.bind(this); if ("getSharedConfiguration" == t) return this.a.get("player", "getConfiguration"); if ("getNetworkingEngine" == t) return this.b.Bb.bind(this.b); if (this.a.da()) { if ("getManifest" == t || "drmInfo" == t) return function () { return F(t + "() does not work while casting!"), null }; if ("getManifestUri" == t) return Yn("getManifestUri", "Please use \"getAssetUri\" instead."), this.Sd("getAssetUri"); if ("attach" == t || "detach" == t) return function () { return F(t + "() does not work while casting!"), Promise.resolve() } } return this.a.da() && 0 == Object.keys(this.a.a.video).length && sr[t] || !this.a.da() ? this.b[t].bind(this.b) : this.a.get("player", t) }, r.vf = function (t) { this.a.da() || this.g.dispatchEvent(t) }, r.Sf = function (a, e) { this.a.da() && ("video" == a ? this.f.dispatchEvent(e) : "player" == a && this.g.dispatchEvent(e)) }, P(vr, ve), D("shaka.cast.CastReceiver", vr), vr.prototype.isConnected = function () { return this.o }, vr.prototype.isConnected = vr.prototype.isConnected, vr.prototype.Ze = function () { return this.h }, vr.prototype.isIdle = vr.prototype.Ze, vr.prototype.destroy = function () { var a = this; return rd(function e() { var i; return od(e, function (e) { switch (e.l) { case 1: return a.c && (a.c.a(), a.c = null), i = [], a.b && (i.push(a.b.destroy()), a.b = null), a.v && (a.v.stop(), a.v = null), a.a = null, a.w = null, a.C = null, a.o = !1, a.h = !0, a.f = null, a.i = null, dd(e, Promise.all(i), 2); case 2: cast.receiver.CastReceiverManager.getInstance().stop(), E(e); } }) }) }, vr.prototype.destroy = vr.prototype.destroy, (r = vr.prototype).Od = function () { this.g = 0, this.j = !0, this.o = 0 != cast.receiver.CastReceiverManager.getInstance().getSenders().length, Tr(this) }, r.Ud = function (a, e) { this.b && (Er(this), Sr(this, { type: "event", targetName: a, event: e }, this.f)) }, r.ye = function () { var t = cast.receiver.CastReceiverManager.getInstance().getSystemVolume(); t && Sr(this, { type: "update", update: { video: { volume: t.level, muted: t.muted } } }, this.f), Sr(this, { type: "event", targetName: "video", event: { type: "volumechange" } }, this.f) }, r.nf = function (d) { var o = Zn(d.data); switch (o.type) { case "init": this.g = 0, this.m = !1, this.j = !0, function (a, e, t) { for (var d in e.player) a.b[d](e.player[d]); a.C(t), t = Promise.resolve(); var o = a.a.autoplay; e.manifest && (a.a.autoplay = !1, t = a.b.load(e.manifest, e.startTime)), t.then(function () { if (a.b) { for (var t in e.video) a.a[t] = e.video[t]; for (var n in e.playerAfterLoad) a.b[n](e.playerAfterLoad[n]); a.a.autoplay = o, e.manifest && (a.a.play(), Ir(a, 0)) } }, function (e) { a.b.dispatchEvent(new be("error", { detail: e })) }) }(this, o.initState, o.appData), Er(this); break; case "appData": this.C(o.appData); break; case "set": var s = o.targetName, p = o.property; if (o = o.value, "video" == s) { var l = cast.receiver.CastReceiverManager.getInstance(); if ("volume" == p) { l.setSystemVolumeLevel(o); break } if ("muted" == p) { l.setSystemVolumeMuted(o); break } } this.w[s][p] = o; break; case "call": (s = this.w[o.targetName])[o.methodName].apply(s, o.args); break; case "asyncCall": s = o.targetName, p = o.methodName, "player" == s && "load" == p && (this.g = 0, this.m = !1), l = o.id, d = d.senderId; var u = this.w[s]; o = u[p].apply(u, o.args), "player" == s && "load" == p && (o = o.then(function () { this.j = !0 }.bind(this))), o.then(this.$d.bind(this, d, l, null), this.$d.bind(this, d, l)); } }, r.bf = function (a) { var d = Zn(a.data); switch (d.type) { case "PLAY": this.a.play(), Ir(this, 0); break; case "PAUSE": this.a.pause(), Ir(this, 0); break; case "SEEK": a = d.currentTime; var t = d.resumeState; null != a && (this.a.currentTime = +a), t && "PLAYBACK_START" == t ? (this.a.play(), Ir(this, 0)) : t && "PLAYBACK_PAUSE" == t && (this.a.pause(), Ir(this, 0)); break; case "STOP": this.b.nd().then(function () { this.b && Ir(this, 0) }.bind(this)); break; case "GET_STATUS": Ir(this, +d.requestId); break; case "VOLUME": a = (t = d.volume).level, t = t.muted; var o = this.a.volume, r = this.a.muted; null != a && (this.a.volume = +a), null != t && (this.a.muted = t), o == this.a.volume && r == this.a.muted || Ir(this, 0); break; case "LOAD": this.g = 0, this.j = this.m = !1, a = d.currentTime, t = this.F(d.media.contentId), this.a.autoplay = !0, this.b.load(t, a).then(function () { this.b && kr(this) }.bind(this)).catch(function (t) { var e = "LOAD_FAILED"; 7 == t.category && 7e3 == t.code && (e = "LOAD_CANCELLED"), Sr(this, { requestId: +d.requestId, type: e }, this.i) }.bind(this)); break; default: Sr(this, { requestId: +d.requestId, type: "INVALID_REQUEST", reason: "INVALID_COMMAND" }, this.i); } }, r.$d = function (a, e, t) { this.b && Sr(this, { type: "asyncComplete", id: e, error: t }, this.f, a) }; var il = { IDLE: "IDLE", ke: "PLAYING", he: "BUFFERING", je: "PAUSED" }, _r = { Yb: function (a, e) { var t = _r.P(a, e); return 1 == t.length ? t[0] : null }, vd: function (a, i, t) { return 1 == (a = _r.wd(a, i, t)).length ? a[0] : null }, P: function (a, n) { return Array.prototype.filter.call(a.childNodes, function (t) { return t instanceof Element && t.tagName == n }) }, wd: function (a, i, t) { return Array.prototype.filter.call(a.childNodes, function (a) { return a instanceof Element && a.localName == t && a.namespaceURI == i }) }, getAttributeNS: function (a, e, t) { return a.hasAttributeNS(e, t) ? a.getAttributeNS(e, t) : null }, ac: function (t) { return Array.prototype.every.call(t.childNodes, function (t) { return t.nodeType == Node.TEXT_NODE || t.nodeType == Node.CDATA_SECTION_NODE }) ? t.textContent.trim() : null }, H: function (a, d, t, n) { n = void 0 === n ? null : n; var o = null; return null != (a = a.getAttribute(d)) && (o = t(a)), null == o ? n : o }, sf: function (t) { return t ? (/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t) && (t += "Z"), t = Date.parse(t), isNaN(t) ? null : Math.floor(t / 1e3)) : null }, za: function (t) { return t && (t = /^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(t)) ? (t = 31536e3 * +(t[1] || null) + 2592e3 * +(t[2] || null) + 86400 * +(t[3] || null) + 3600 * +(t[4] || null) + 60 * +(t[5] || null) + +(t[6] || null), isFinite(t) ? t : null) : null }, kc: function (a) { var n = /([0-9]+)-([0-9]+)/.exec(a); return n ? (a = +n[1], isFinite(a) ? (n = +n[2], isFinite(n) ? { start: a, end: n } : null) : null) : null }, parseInt: function (t) { return 0 == (t = +t) % 1 ? t : null }, jc: function (t) { return 0 == (t = +t) % 1 && 0 < t ? t : null }, rb: function (t) { return 0 == (t = +t) % 1 && 0 <= t ? t : null }, parseFloat: function (t) { return t = +t, isNaN(t) ? null : t }, xe: function (a) { var n; return a = (n = a.match(/^(\d+)\/(\d+)$/)) ? +n[1] / +n[2] : +a, isNaN(a) ? null : a }, Rd: function (a, e) { var t = new DOMParser; try { var n = t.parseFromString(a, "text/xml") } catch (t) { } if (n && n.documentElement.tagName == e) var r = n.documentElement; return r && 0 < r.getElementsByTagName("parsererror").length ? null : r }, Qd: function (a, e) { try { var t = Qe(a); return _r.Rd(t, e) } catch (t) { } } }, Mr = new Map().set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b", "org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed", "com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95", "com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb", "com.adobe.primetime"), Nr = new Map().set("com.widevine.alpha", function (t) { return (t = _r.vd(t.node, "urn:microsoft", "laurl")) && t.getAttribute("licenseUrl") || "" }).set("com.microsoft.playready", function (t) { return (t = _r.vd(t.node, "urn:microsoft:playready", "pro")) && (t = function (d) { var e = 0, s = new DataView(d).getUint32(e, !0); if (s !== d.byteLength) return []; e += 6, s = []; for (var p = new DataView(d), r; e < d.byteLength - 1;) { r = p.getUint16(e, !0), e += 2; var l = p.getUint16(e, !0); e += 2; var a = new Uint8Array(d, e, l); s.push({ type: r, value: a }), e += l } return s }((t = ot(t.textContent)).buffer).filter(function (t) { return 1 === t.type })[0]) ? (t = $e(t.value, !0), (t = _r.Rd(t, "WRMHEADER")) ? function (t) { return (t = t.querySelector("DATA > LA_URL")) ? t.textContent : "" }(t) : "") : "" }); D("shaka.media.InitSegmentReference", Ur), Ur.prototype.wc = function () { return this.c() }, Ur.prototype.createUris = Ur.prototype.wc, Ur.prototype.Gc = function () { return this.b }, Ur.prototype.getStartByte = Ur.prototype.Gc, Ur.prototype.Fc = function () { return this.a }, Ur.prototype.getEndByte = Ur.prototype.Fc, D("shaka.media.SegmentReference", Br), Br.prototype.aa = function () { return this.position }, Br.prototype.getPosition = Br.prototype.aa, Br.prototype.Hc = function () { return this.startTime }, Br.prototype.getStartTime = Br.prototype.Hc, Br.prototype.De = function () { return this.endTime }, Br.prototype.getEndTime = Br.prototype.De, Br.prototype.wc = function () { return this.c() }, Br.prototype.createUris = Br.prototype.wc, Br.prototype.Gc = function () { return this.b }, Br.prototype.getStartByte = Br.prototype.Gc, Br.prototype.Fc = function () { return this.a }, Br.prototype.getEndByte = Br.prototype.Fc, D("shaka.util.DataViewReader", jr); var Or = 1, zr; jr.Endianness = { mg: 0, ng: 1 }, jr.prototype.pa = function () { return this.a < this.I.byteLength }, jr.prototype.hasMoreData = jr.prototype.pa, jr.prototype.aa = function () { return this.a }, jr.prototype.getPosition = jr.prototype.aa, jr.prototype.Fe = function () { return this.I.byteLength }, jr.prototype.getLength = jr.prototype.Fe, jr.prototype.ha = function () { try { var t = this.I.getUint8(this.a); return this.a += 1, t } catch (t) { Fr() } }, jr.prototype.readUint8 = jr.prototype.ha, jr.prototype.Jb = function () { try { var t = this.I.getUint16(this.a, this.b); return this.a += 2, t } catch (t) { Fr() } }, jr.prototype.readUint16 = jr.prototype.Jb, jr.prototype.D = function () { try { var t = this.I.getUint32(this.a, this.b); return this.a += 4, t } catch (t) { Fr() } }, jr.prototype.readUint32 = jr.prototype.D, jr.prototype.Vd = function () { try { var t = this.I.getInt32(this.a, this.b); return this.a += 4, t } catch (t) { Fr() } }, jr.prototype.readInt32 = jr.prototype.Vd, jr.prototype.ub = function () { try { if (this.b) var a = this.I.getUint32(this.a, !0), n = this.I.getUint32(this.a + 4, !0); else n = this.I.getUint32(this.a, !1), a = this.I.getUint32(this.a + 4, !1) } catch (t) { Fr() } if (2097151 < n) throw new le(2, 3, 3001); return this.a += 8, n * Math.pow(2, 32) + a }, jr.prototype.readUint64 = jr.prototype.ub, jr.prototype.Va = function (a) { this.a + a > this.I.byteLength && Fr(); var e = new Uint8Array(this.I.buffer, this.I.byteOffset + this.a, a); return this.a += a, new Uint8Array(e) }, jr.prototype.readBytes = jr.prototype.Va, jr.prototype.J = function (t) { this.a + t > this.I.byteLength && Fr(), this.a += t }, jr.prototype.skip = jr.prototype.J, jr.prototype.Yd = function (t) { this.a < t && Fr(), this.a -= t }, jr.prototype.rewind = jr.prototype.Yd, jr.prototype.seek = function (t) { (0 > t || t > this.I.byteLength) && Fr(), this.a = t }, jr.prototype.seek = jr.prototype.seek, jr.prototype.Yc = function () { for (var t = this.a; this.pa() && 0 != this.I.getUint8(this.a);)this.a += 1; return t = new Uint8Array(this.I.buffer, this.I.byteOffset + t, this.a - t), this.a += 1, Qe(t) }, jr.prototype.readTerminatedString = jr.prototype.Yc, D("shaka.util.Mp4Parser", Vr), Vr.prototype.G = function (a, e) { var t = Xr(a); return this.c[t] = 0, this.b[t] = e, this }, Vr.prototype.box = Vr.prototype.G, Vr.prototype.ca = function (a, e) { var t = Xr(a); return this.c[t] = 1, this.b[t] = e, this }, Vr.prototype.fullBox = Vr.prototype.ca, Vr.prototype.stop = function () { this.a = !0 }, Vr.prototype.stop = Vr.prototype.stop, Vr.prototype.parse = function (a, e) { var t = new Uint8Array(a); for (t = new jr(new DataView(t.buffer, t.byteOffset, t.byteLength), 0), this.a = !1; t.pa() && !this.a;)this.ic(0, t, e) }, Vr.prototype.parse = Vr.prototype.parse, Vr.prototype.ic = function (d, e, p) { var n = e.aa(), r = e.D(), l = e.D(); 0 === r ? r = e.I.byteLength - n : 1 === r ? r = e.ub() : void 0; var c = this.b[l]; if (c) { var o = null, f = null; 1 == this.c[l] && (o = (f = e.D()) >>> 24, f &= 16777215), l = n + r, p && l > e.I.byteLength && (l = e.I.byteLength), l -= e.aa(), e = 0 < l ? e.Va(l) : new Uint8Array(0), c({ parser: this, partialOkay: p || !1, version: o, flags: f, reader: e = new jr(new DataView(e.buffer, e.byteOffset, e.byteLength), 0), size: r, start: n + d }) } else e.J(Math.min(n + r - e.aa(), e.I.byteLength - e.aa())) }, Vr.prototype.parseNext = Vr.prototype.ic, Vr.children = Kr, Vr.sampleDescription = Hr, Vr.allData = Gr, Vr.typeToString = Wr, D("shaka.media.SegmentIndex", Qr), Qr.prototype.destroy = function () { return this.a = null, Promise.resolve() }, Qr.prototype.destroy = Qr.prototype.destroy, Qr.prototype.find = function (a) { for (var e = this.a.length - 1, i; 0 <= e; --e)if (i = this.a[e], a >= i.startTime && a < i.endTime) return i.position; return this.a.length && a < this.a[0].startTime ? this.a[0].position : null }, Qr.prototype.find = Qr.prototype.find, Qr.prototype.get = function (t) { return 0 == this.a.length ? null : 0 > (t -= this.a[0].position) || t >= this.a.length ? null : this.a[t] }, Qr.prototype.get = Qr.prototype.get, Qr.prototype.offset = function (a) { for (var e = 0; e < this.a.length; ++e)this.a[e].startTime += a, this.a[e].endTime += a }, Qr.prototype.offset = Qr.prototype.offset, Qr.prototype.Pc = function (d) { for (var e = [], o = 0, s = 0; o < this.a.length && s < d.length;) { var p = this.a[o], l = d[s]; p.startTime < l.startTime ? (e.push(p), o++) : (p.startTime > l.startTime ? 0 == o && e.push(l) : (.1 < Math.abs(p.endTime - l.endTime) ? e.push(new Br(p.position, l.startTime, l.endTime, l.c, l.b, l.a)) : e.push(p), o++), s++) } for (; o < this.a.length;)e.push(this.a[o++]); if (e.length) for (o = e[e.length - 1].position + 1; s < d.length;)p = new Br(o++, (p = d[s++]).startTime, p.endTime, p.c, p.b, p.a), e.push(p); else e = d; this.a = e }, Qr.prototype.merge = Qr.prototype.Pc, Qr.prototype.zc = function (a) { for (var e = 0; e < this.a.length; ++e)if (this.a[e].endTime > a) return void this.a.splice(0, e); this.a = [] }, Qr.prototype.evict = Qr.prototype.zc, ti.prototype.pa = function () { return this.a.pa() }, oi.prototype.parse = function (d, p, l, n) { var r; if (440786851 != ni(p = new ti(new DataView(p))).id) throw new le(2, 3, 3008); var u = ni(p); if (408125543 != u.id) throw new le(2, 3, 3009); for (p = u.a.byteOffset, u = new ti(u.a), r = null; u.pa();) { var c = ni(u); if (357149030 == c.id) { r = c; break } } if (!r) throw new le(2, 3, 3010); for (u = new ti(r.a), r = 1e6, c = null; u.pa();) { var f = ni(u); if (2807729 == f.id) r = ai(f); else if (17545 == f.id) if (4 == (c = f).a.byteLength) c = c.a.getFloat32(0); else { if (8 != c.a.byteLength) throw new le(2, 3, 3003); c = c.a.getFloat64(0) } } if (null == c) throw new le(2, 3, 3011); if (r = c * (u = r / 1e9), 475249515 != (d = ni(new ti(new DataView(d)))).id) throw new le(2, 3, 3007); return function (d, p, t, n, r, i) { function a() { return r } var o = []; d = new ti(d.a); for (var s = null, m = null, g; d.pa();)if (g = ni(d), 187 == g.id) { var y = si(g); y && (g = t * y.gg, y = p + y.Af, null != s && o.push(new Br(o.length, s - i, g - i, a, m, y - 1)), s = g, m = y) } return null != s && o.push(new Br(o.length, s - i, n - i, a, m, null)), o }(d, p, u, r, l, n) }; var rl = { sb: {}, Ib: {}, ad: function (a, e) { rl.Ib[a] = e } }; D("shaka.media.ManifestParser.registerParserByExtension", rl.ad), rl.Kb = function (a, e) { rl.sb[a] = e }, D("shaka.media.ManifestParser.registerParserByMime", rl.Kb), rl.xf = function () { var a = {}; if (Xe()) { for (var e in rl.sb) a[e] = !0; for (var d in rl.Ib) a[d] = !0 } e = { mpd: "application/dash+xml", m3u8: "application/x-mpegurl", ism: "application/vnd.ms-sstr+xml" }; for (var o = (d = id(["application/dash+xml", "application/x-mpegurl", "application/vnd.apple.mpegurl", "application/vnd.ms-sstr+xml"])).next(); !o.done; o = d.next())a[o = o.value] = Xe() ? !!rl.sb[o] : We(o); for (var s in e) a[s] = Xe() ? !!rl.Ib[s] : We(e[s]); return a }, rl.create = function (d, e, t, n) { return rd(function r() { var s, p; return od(r, function (a) { switch (a.l) { case 1: return b(a, 2), dd(a, rl.Ee(d, e, t, n), 4); case 4: return s = a.s, a.return(new s); case 2: throw (p = x(a)).severity = 2, p; } }) }) }, rl.Ee = function (d, e, t, n) { return rd(function r() { var p, l, f, m, g; return od(r, function (a) { switch (a.l) { case 1: if (p = rl, n && (l = p.sb[n.toLowerCase()])) return a.return(l); if ((f = p.getExtension(d)) && (m = p.Ib[f])) return a.return(m); if (n) { a.A(2); break } return dd(a, p.Le(d, e, t), 3); case 3: if ((n = a.s) && (g = rl.sb[n])) return a.return(g); case 2: throw new le(2, 4, 4e3, d); } }) }) }, rl.Le = function (d, e, t) { return rd(function n() { var s, p, l; return od(n, function (a) { switch (a.l) { case 1: return (s = _e([d], t)).method = "HEAD", dd(a, e.request(0, s).promise, 2); case 2: return p = a.s, l = p.headers["content-type"], a.return(l ? l.toLowerCase() : ""); } }) }) }, rl.getExtension = function (t) { return 1 == (t = new K(t).fa.split("/").pop().split(".")).length ? "" : t.pop().toLowerCase() }, rl.isSupported = function (a, e) { return !!Xe() && (e in rl.sb || rl.getExtension(a) in rl.Ib) }, D("shaka.media.PresentationTimeline", vi), vi.prototype.Y = function () { return this.g }, vi.prototype.getDuration = vi.prototype.Y, vi.prototype.ta = function (t) { this.g = t }, vi.prototype.setDuration = vi.prototype.ta, vi.prototype.Qe = function () { return this.f }, vi.prototype.getPresentationStartTime = vi.prototype.Qe, vi.prototype.ae = function (t) { this.j = t }, vi.prototype.setClockOffset = vi.prototype.ae, vi.prototype.Ob = function (t) { this.m = t }, vi.prototype.setStatic = vi.prototype.Ob, vi.prototype.hd = function (t) { this.h = t }, vi.prototype.setSegmentAvailabilityDuration = vi.prototype.hd, vi.prototype.Nf = function (t) { this.lc = t }, vi.prototype.setDelay = vi.prototype.Nf, vi.prototype.Ce = function () { return this.lc }, vi.prototype.getDelay = vi.prototype.Ce, vi.prototype.ob = function (a, e) { if (0 != a.length) { var t = a[a.length - 1].endTime + e; this.Sc(a[0].startTime + e), this.a = a.reduce(function (a, e) { return Math.max(a, e.endTime - e.startTime) }, this.a), this.b = Math.max(this.b, t), null != this.f && this.o && (this.f = (Date.now() + this.j) / 1e3 - this.b - this.a) } }, vi.prototype.notifySegments = vi.prototype.ob, vi.prototype.Sc = function (t) { this.c = null == this.c ? t : Math.min(this.c, t) }, vi.prototype.notifyMinSegmentStartTime = vi.prototype.Sc, vi.prototype.Rc = function (t) { this.a = Math.max(this.a, t) }, vi.prototype.notifyMaxSegmentDuration = vi.prototype.Rc, vi.prototype.offset = function (t) { null != this.c && (this.c += t), null != this.b && (this.b += t) }, vi.prototype.offset = vi.prototype.offset, vi.prototype.U = function () { return 1 / 0 == this.g && !this.m }, vi.prototype.isLive = vi.prototype.U, vi.prototype.Ta = function () { return 1 / 0 != this.g && !this.m }, vi.prototype.isInProgress = vi.prototype.Ta, vi.prototype.Db = function () { if (1 / 0 == this.h) return this.i; var t = this.jb() - this.h; return Math.max(this.i, t) }, vi.prototype.getSegmentAvailabilityStart = vi.prototype.Db, vi.prototype.be = function (t) { this.i = t }, vi.prototype.setUserSeekStart = vi.prototype.be, vi.prototype.jb = function () { return this.U() || this.Ta() ? Math.min(Math.max(0, (Date.now() + this.j) / 1e3 - this.a - this.f), this.g) : this.g }, vi.prototype.getSegmentAvailabilityEnd = vi.prototype.jb, vi.prototype.Cb = function (a) { var i = Math.max(this.c, this.i); if (1 / 0 == this.h) return i; var t = this.jb() - this.h; return a = Math.min(t + a, this.wa()), Math.max(i, a) }, vi.prototype.getSafeSeekRangeStart = vi.prototype.Cb, vi.prototype.ib = function () { return this.Cb(0) }, vi.prototype.getSeekRangeStart = vi.prototype.ib, vi.prototype.wa = function () { var t = this.U() || this.Ta() ? this.lc : 0; return Math.max(0, this.jb() - t) }, vi.prototype.getSeekRangeEnd = vi.prototype.wa, vi.prototype.fe = function () { return null != this.f && null == this.b }, vi.prototype.usingPresentationStartTime = vi.prototype.fe, D("shaka.dash.DashParser", gi), (r = gi.prototype).configure = function (t) { this.b = t }, r.start = function (a, e) { var t = this; return rd(function n() { var d; return od(n, function (n) { switch (n.l) { case 1: return t.f = [a], t.a = e, dd(n, bi(t), 2); case 2: if (d = n.s, t.a && ki(t, d), !t.a) throw new le(2, 7, 7001); return n.return(t.c); } }) }) }, r.stop = function () { return this.b = this.a = null, this.f = [], this.c = null, this.j = [], this.m = {}, null != this.i && (this.i.stop(), this.i = null), this.g.destroy() }, r.update = function () { bi(this).catch(function (t) { this.a && this.a.onError(t) }.bind(this)) }, r.onExpirationUpdated = function () { }, r.rf = function (f, e) { f.ba = xi(e, f.ga, null); var t = !1, m = _r.P(e, "Role"), g = m.map(function (t) { return t.getAttribute("value") }).filter(Ot.Da), y = "text" == f.ba.contentType, b; y && (b = "subtitle"); for (var v = 0, T; v < m.length; v++)if (T = m[v].getAttribute("schemeIdUri"), null == T || "urn:mpeg:dash:role:2011" == T) switch (T = m[v].getAttribute("value"), T) { case "main": t = !0; break; case "caption": case "subtitle": b = T; }var E = null, x = !1; _r.P(e, "EssentialProperty").forEach(function (t) { "http://dashif.org/guidelines/trickmode" == t.getAttribute("schemeIdUri") ? E = t.getAttribute("value") : x = !0 }), v = _r.P(e, "Accessibility"); var k = new Map; for (m = {}, T = (v = id(v)).next(); !T.done; m = { Ab: m.Ab }, T = v.next()) { var h = (T = T.value).getAttribute("schemeIdUri"); "urn:scte:dash:cc:cea-608:2015" != h && "urn:scte:dash:cc:cea-708:2015" != h || (m.Ab = 1, null == (T = T.getAttribute("value")) ? k.set("CC1", "und") : T.split(";").forEach(function (a) { return function (e) { if (e.includes("=")) { var i = (e = e.split("="))[0].startsWith("CC") ? e[0] : "CC" + e[0]; e = e[1].split(",")[0].split(":").pop() } else i = "CC" + a.Ab, a.Ab += 2; k.set(i, _n(e)) } }(m))) } if (x) return null; var d = Ar(m = _r.P(e, "ContentProtection"), this.b.dash.customScheme, this.b.dash.ignoreDrmInfo); if (m = _n(e.getAttribute("lang") || "und"), T = e.getAttribute("label"), 0 == (g = (v = _r.P(e, "Representation")).map(this.uf.bind(this, f, d, b, m, T, t, g, k)).filter(function (t) { return !!t })).length) { if (y) return null; throw new le(2, 4, 4003) } return f.ba.contentType && "application" != f.ba.contentType || (f.ba.contentType = Ii(g[0].mimeType, g[0].codecs), g.forEach(function (e) { e.type = f.ba.contentType })), g.forEach(function (a) { d.drmInfos.forEach(function (e) { a.keyId && e.keyIds.push(a.keyId) }) }), y = v.map(function (t) { return t.getAttribute("id") }).filter(Ot.Da), { id: f.ba.id || "__fake__" + this.h++, contentType: f.ba.contentType, language: m, Nc: t, streams: g, drmInfos: d.drmInfos, md: E, Df: y } }, r.uf = function (p, e, t, n, r, i, a, o, s) { if (p.B = xi(s, p.ba, null), !function (a) { var e = a.Lb ? 1 : 0; return e += a.Ga ? 1 : 0, 0 == (e += a.Nb ? 1 : 0) ? "text" == a.contentType || "application" == a.contentType : (1 != e && (a.Lb && (a.Ga = null), a.Nb = null), !0) }(p.B)) return null; p.bandwidth = _r.H(s, "bandwidth", _r.jc) || 0; var m = p.B.contentType; m = "text" == m || "application" == m; try { var g = this.Ef.bind(this); if (p.B.Lb) var l = function (d, e) { var t = +Lr(d, li, "presentationTimeOffset") || 0, p = Lr(d, li, "timescale"), l = 1; p && (l = _r.jc(p) || 1), t = t / l || 0, p = ui(d, li); var c = d.B.contentType; if (l = d.B.mimeType.split("/")[1], "text" != c && "mp4" != l && "webm" != l) throw new le(2, 4, 4006); if ("webm" == l && !p) throw new le(2, 4, 4005); c = Dr(d, li, "RepresentationIndex"); var f = Lr(d, li, "indexRange"), m = d.B.la; if (f = _r.kc(f || ""), c) { var g = c.getAttribute("sourceURL"); g && (m = Ut(d.B.la, [g])), f = _r.H(c, "range", _r.kc, f) } if (!f) throw new le(2, 4, 4002); return { createSegmentIndex: (l = ci(d, e, p, m, f.start, f.end, l, t)).createSegmentIndex, findSegmentPosition: l.findSegmentPosition, getSegmentReference: l.getSegmentReference, initSegmentReference: p, ia: t } }(p, g); else if (p.B.Ga) l = fi(p, this.m); else if (p.B.Nb) l = di(p, g, this.m, !!this.c); else { var y = p.B.la, b = p.R.duration || 0; l = { createSegmentIndex: Promise.resolve.bind(Promise), findSegmentPosition: function (t) { return 0 <= t && t < b ? 1 : null }, getSegmentReference: function (t) { return 1 == t ? new Br(1, 0, b, function () { return y }, 0, null) : null }, initSegmentReference: null, ia: 0 } } } catch (t) { if (m && 4002 == t.code) return null; throw t } return s = function (a, d, o, n) { var r = Ar(a, d, n); if (o.xd) a = 1 == o.drmInfos.length && !o.drmInfos[0].keySystem, d = 0 == r.drmInfos.length, (0 == o.drmInfos.length || a && !d) && (o.drmInfos = r.drmInfos), o.xd = !1; else if (0 < r.drmInfos.length && (o.drmInfos = o.drmInfos.filter(function (a) { return r.drmInfos.some(function (e) { return e.keySystem == a.keySystem }) }), 0 == o.drmInfos.length)) throw new le(2, 4, 4008); return r.sd || o.sd }(s = _r.P(s, "ContentProtection"), this.b.dash.customScheme, e, this.b.dash.ignoreDrmInfo), { id: this.h++, originalId: p.B.id, createSegmentIndex: l.createSegmentIndex, findSegmentPosition: l.findSegmentPosition, getSegmentReference: l.getSegmentReference, initSegmentReference: l.initSegmentReference, presentationTimeOffset: l.ia, mimeType: p.B.mimeType, codecs: p.B.codecs, frameRate: p.B.frameRate, bandwidth: p.bandwidth, width: p.B.width, height: p.B.height, kind: t, encrypted: 0 < e.drmInfos.length, keyId: s, language: n, label: r, type: p.ba.contentType, primary: i, trickModeVideo: null, emsgSchemeIdUris: p.B.emsgSchemeIdUris, roles: a, channelsCount: p.B.Tc, closedCaptions: o } }, r.tf = function (d, e, t) { var p = _r.rb, r = t.getAttribute("schemeIdUri") || "", i = t.getAttribute("value") || "", a = _r.H(t, "timescale", p) || 1; _r.P(t, "Event").forEach(function (t) { var o = _r.H(t, "presentationTime", p) || 0, l = _r.H(t, "duration", p) || 0; l = (o = o / a + d) + l / a, null != e && (o = Math.min(o, d + e), l = Math.min(l, d + e)), t = { schemeIdUri: r, value: i, startTime: o, endTime: l, id: t.getAttribute("id") || "", eventElement: t }, this.a.onTimelineRegionAdded(t) }.bind(this)) }, r.Ef = function (a, i, t) { return a = yi(a, i, t, this.b.retryParameters), a = this.a.networkingEngine.request(1, a), Ie(this.g, a), a.promise.then(function (t) { return t.data }) }, rl.ad("mpd", gi), rl.Kb("application/dash+xml", gi), Ci.prototype.toString = function () { var a = "#" + this.name, n = this.a ? this.a.map(function (t) { return t.name + "=" + (isNaN(+t.value) ? "\"" + t.value + "\"" : t.value) }) : []; return this.value && n.unshift(this.value), 0 < n.length && (a += ":" + n.join(",")), a }, Ci.prototype.getAttribute = function (a) { var e = this.a.filter(function (e) { return e.name == a }); return e.length ? e[0] : null }; var mi = { hb: function (a, n) { return a.filter(function (t) { return t.name == n }) }, Pa: function (a, e) { var t = mi.hb(a, e); return t.length ? t[0] : null }, Cc: function (a, i, t) { return a.filter(function (a) { var n = a.getAttribute("TYPE"); return a = a.getAttribute("GROUP-ID"), n.value == i && a.value == t }) }, vc: function (a, e) { return Ut([a], [e])[0] }, Kc: function (t) { return /^#(?!EXT)/m.test(t) } }, Ri = ["EXT-X-TARGETDURATION", "EXT-X-MEDIA-SEQUENCE", "EXT-X-DISCONTINUITY-SEQUENCE", "EXT-X-PLAYLIST-TYPE", "EXT-X-MAP", "EXT-X-I-FRAMES-ONLY", "EXT-X-ENDLIST"], Hi = ["EXTINF", "EXT-X-BYTERANGE", "EXT-X-DISCONTINUITY", "EXT-X-PROGRAM-DATE-TIME", "EXT-X-KEY", "EXT-X-DATERANGE"]; D("shaka.net.DataUriPlugin", Vi), Vi.parse = function (e) { var a = e.split(":"); if (2 > a.length || "data" != a[0]) throw new le(2, 1, 1004, e); if (2 > (a = a.slice(1).join(":").split(",")).length) throw new le(2, 1, 1004, e); var d = a[0]; a = ed.decodeURIComponent(a.slice(1).join(",")); var o = null; if (1 < (d = d.split(";")).length && (o = d[1]), "base64" == o) e = ot(a).buffer; else { if (o) throw new le(2, 1, 1005, e); e = et(a) } return { data: e, contentType: d[0] } }, Ce("data", Vi), D("shaka.hls.HlsParser", qi), (r = qi.prototype).configure = function (t) { this.c = t }, r.start = function (d, e) { var t = this; return rd(function n() { var o, s; return od(n, function (a) { switch (a.l) { case 1: return t.g = e, dd(a, ia(t, d), 2); case 2: return o = a.s, t.v = o.uri, dd(a, function (d, e) { return rd(function t() { var f, g, b, T, x, n, m, y, k, S, I; return od(t, function (t) { switch (t.l) { case 1: if (0 != (f = Ui(d.o, e, d.v)).type) throw new le(2, 4, 4022); return dd(t, function (d, f) { return rd(function e() { var t, g, y, b, T, E, x, k, S, I, A, C; return od(e, function (e) { switch (e.l) { case 1: return t = mi, g = Ot, y = f.a, b = t.hb(f.a, "EXT-X-MEDIA"), T = b.filter(function (t) { return "SUBTITLES" == na(t, "TYPE") }.bind(d)), E = T.map(function (t) { return function (a, e) { return rd(function t() { var i; return od(t, function (t) { switch (t.l) { case 1: return na(e, "TYPE"), dd(t, Wi(a, e, []), 2); case 2: return i = t.s, t.return(i.stream); } }) }) }(this, t) }.bind(d)), x = b.filter(function (t) { return "CLOSED-CAPTIONS" == na(t, "TYPE") }), function (d, e) { for (var t = id(e), n = t.next(); !n.done; n = t.next()) { na(n = n.value, "TYPE"); var o = _i(n, "LANGUAGE") || "und"; o = _n(o); var s = na(n, "GROUP-ID"); n = na(n, "INSTREAM-ID"), d.j.get(s) || d.j.set(s, new Map), d.j.get(s).set(n, o) } }(d, x), dd(e, Promise.all(E), 2); case 2: return k = e.s, S = t.hb(y, "EXT-X-STREAM-INF"), I = S.map(function (t) { return function (d, e, t) { return rd(function n() { var f, E, R, L, D, O, U, B, j, F, V, K, H, q, z, G, X, W, Y, Q, J, $, Z, ee, te, ae; return od(n, function (a) { switch (a.l) { case 1: return f = Vt, E = mi, R = _i(e, "CODECS", "avc1.42E01E,mp4a.40.2"), L = function (a) { for (var d = new Set, t = [], n = (a = id(a)).next(), o; !n.done; n = a.next())o = Ge(n = n.value)[0], d.has(o) || (t.push(n), d.add(o)); return t }(R.split(/\s*,\s*/)), D = e.getAttribute("RESOLUTION"), U = O = null, B = _i(e, "FRAME-RATE"), j = +na(e, "BANDWIDTH"), D && (F = D.value.split("x"), O = F[0], U = F[1]), V = (V = (V = E.hb(t.a, "EXT-X-MEDIA")).filter(function (t) { return "CLOSED-CAPTIONS" != na(t, "TYPE") })).filter(function (a) { var e = _i(a, "URI") || ""; return "SUBTITLES" == (_i(a, "TYPE") || "") || "" != e }), K = _i(e, "AUDIO"), H = _i(e, "VIDEO"), K ? V = E.Cc(V, "AUDIO", K) : H && (V = E.Cc(V, "VIDEO", H)), (q = ta(f.na, L)) && ((z = _i(e, "SUBTITLES")) && (G = E.Cc(V, "SUBTITLES", z)).length && (d.C.get(G[0].id).stream.codecs = q), xe(L, q)), X = V.map(function (t) { return Wi(this, t, L) }.bind(d)), W = [], Y = [], dd(a, Promise.all(X), 2); case 2: if (J = (J = a.s).filter(function (t) { return null != t }), K ? W = J : H && (Y = J), Z = !1, W.length || Y.length ? W.length ? (te = na(e, "URI"), ae = W[0].pc, te == ae ? ($ = f.wb, Z = !0) : $ = f.La) : $ = f.wb : 1 == L.length ? (ee = ta(f.La, L), $ = D || B || ee ? f.La : f.wb) : ($ = f.La, L = [L.join(",")]), Z) { a.A(3); break } return dd(a, function (d, e, t, n) { return rd(function r() { var p, l, f, m, g; return od(r, function (a) { switch (a.l) { case 1: return p = Vt, l = na(e, "URI"), d.a.has(l) ? a.return(d.a.get(l)) : (f = _i(e, "CLOSED-CAPTIONS"), m = null, n == p.La && f && "NONE" != f && (m = d.j.get(f)), dd(a, Yi(d, l, t, n, "und", !1, null, null, m), 2)); case 2: return null == (g = a.s) ? a.return(null) : d.a.has(l) ? a.return(d.a.get(l)) : (d.a.set(l, g), a.return(g)); } }) }) }(d, e, L, $), 4); case 4: Q = a.s; case 3: if (Q) Q.stream.type == f.wb ? W = [Q] : Y = [Q]; else if (null === Q) return a.return([]); return Y && Gi(Y), W && Gi(W), a.return(function (f, e, g, y, r, i, a) { g.forEach(function (t) { (t = t.stream) && (t.width = +r || void 0, t.height = +i || void 0, t.frameRate = +a || void 0) }.bind(f)), e.length || (e = [null]), g.length || (g = [null]); for (var o = [], s = (e = id(e)).next(); !s.done; s = e.next()) { s = s.value; for (var b = id(g), c = b.next(), T; !c.done; c = b.next()) { T = c.value, c = s ? s.stream : null; var E = T ? T.stream : null, d = s ? s.drmInfos : null, p = T ? T.drmInfos : null; T = (T ? T.pc : "") + " - " + (s ? s.pc : ""); var v = void 0; if (c && E) { if (d.length && p.length && !(0 < It(d, p).length)) continue; v = It(d, p) } else c ? v = d : E && (v = p); f.S.has(T) || (c = Xi(f, c, E, y, v), o.push(c), f.S.add(T)) } } return o }(d, W, Y, j, O, U, B)); } }) }) }(this, t, f) }.bind(d)), dd(e, Promise.all(I), 3); case 3: return A = e.s, C = (C = A.reduce(g.uc, [])).filter(function (t) { return null != t }), e.return({ startTime: 0, variants: C, textStreams: k }); } }) }) }(d, f), 2); case 2: if (g = t.s, !d.g) throw new le(2, 7, 7001); if (d.V && 0 == g.variants.length) throw new le(2, 4, 4034); d.g.filterAllPeriods([g]), b = 1 / 0, T = 0, x = 1 / 0; for (var a = id(d.a.values()), i = a.next(); !i.done; i = a.next())n = i.value, b = Math.min(b, n.Qc), T = Math.max(T, n.Qc), "text" != n.stream.type && (x = Math.min(x, n.duration)); if (d.f == fa.Ma ? (d.b = new vi(null, 0), d.b.Ob(!0)) : (d.b = new vi(0, 3 * d.w), d.b.Ob(!1)), Qi(d), d.f != fa.Ma) { for (d.N = d.F, m = fa, d.f == m.pd && (y = d.b.lc, isNaN(d.c.availabilityWindowOverride) || (y = d.c.availabilityWindowOverride), d.b.hd(y)), k = 0; 95443.7176888889 <= T;)k += 95443.7176888889, T -= 95443.7176888889; if (k) for (i = (a = id(d.a.values())).next(); !i.done; i = a.next())95443.7176888889 > (S = i.value).Qc && (S.stream.presentationTimeOffset = -k, S.Mb.offset(k)) } else for (d.b.ta(x), d.b.offset(-b), i = (a = id(d.a.values())).next(); !i.done; i = a.next())(I = i.value).stream.presentationTimeOffset = b, I.Mb.offset(-b), ei(I.Mb, x); d.m = { presentationTimeline: d.b, periods: [g], offlineSessionIds: [], minBufferTime: 0 }, E(t); } }) }) }(t, o.data), 3); case 3: return 0 < (s = t.N) && t.h.O(s), a.return(t.m); } }) }) }, r.stop = function () { this.h && (this.h.stop(), this.h = null); var t = []; return this.i && (t.push(this.i.destroy()), this.i = null), this.c = this.g = null, this.C.clear(), this.S.clear(), this.a.clear(), this.m = null, Promise.all(t) }, r.update = function () { if (this.f != fa.Ma) { for (var a = [], e = id(this.a.values()), t = e.next(); !t.done; t = e.next())a.push(zi(this, t.value)); return Promise.all(a) } }, r.onExpirationUpdated = function () { }; var Ki = { audio: [/^vorbis$/, /^opus$/, /^flac$/, /^mp4a/, /^[ae]c-3$/], video: [/^avc/, /^hev/, /^hvc/, /^vp0?[89]/, /^av1$/], text: [/^vtt$/, /^wvtt/, /^stpp/] }, oa = { audio: { mp4: "audio/mp4", m4s: "audio/mp4", m4i: "audio/mp4", m4a: "audio/mp4", ts: "video/mp2t" }, video: { mp4: "video/mp4", m4s: "video/mp4", m4i: "video/mp4", m4v: "video/mp4", ts: "video/mp2t" }, text: { mp4: "application/mp4", m4s: "application/mp4", m4i: "application/mp4", vtt: "text/vtt", ttml: "application/ttml+xml" } }, sa = { "urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed": function (a) { var n = na(a, "METHOD"); return Yn("HLS SAMPLE-AES-CENC", "SAMPLE-AES-CENC will no longer be supported, see Issue #1227"), ["SAMPLE-AES", "SAMPLE-AES-CTR", "SAMPLE-AES-CENC"].includes(n) ? (n = na(a, "URI"), n = Vi.parse(n), n = Bt("com.widevine.alpha", [{ initDataType: "cenc", initData: n = new Uint8Array(n.data) }]), (a = _i(a, "KEYID")) && (n.keyIds = [a.substr(2).toLowerCase()]), n) : null } }, la = "VOD", fa = { Ma: la, ie: "EVENT", pd: "LIVE" }; rl.ad("m3u8", qi), rl.Kb("application/x-mpegurl", qi), rl.Kb("application/vnd.apple.mpegurl", qi), ma.prototype.add = function (t) { return !!ya(this.a, t) && (this.b.add(t), !0) }, ma.prototype.values = function () { return this.b.values() }, wa.prototype.create = function (a) { var i = this, e = a.filter(function (t) { return ya(i.a, t) }); return e.length ? new ma(e[0], e) : this.b.create(a) }, Ta.prototype.create = function (a) { var i = []; i = function (a, e) { var t = Rn(_n(e), a.map(function (t) { return wn(t) })); return t ? a.filter(function (a) { return t == wn(a) }) : [] }(a, this.c); var r = a.filter(function (t) { return t.primary }); for (i = i.length ? i : r.length ? r : a, this.b && (a = function (a, i) { return a.filter(function (t) { var a = t.audio; return t = t.video, a && 0 <= a.roles.indexOf(i) || t && 0 <= t.roles.indexOf(i) }) }(i, this.b)).length && (i = a), this.a && (a = Vn(i, this.a)).length && (i = a), a = new ma(i[0]), r = (i = id(i)).next(); !r.done; r = i.next())r = r.value, ya(a.a, r) && a.add(r); return a }; var ha = 0, xa = 1; ka.prototype.a = function () { this.g = null, this.b = function () { } }, Ca.prototype.a = function () { this.g && (this.g.a(), this.g = null), null != this.h && (this.h.stop(), this.h = null), this.c && (this.c.a(), this.c = null), this.b = this.w = this.m = null }, Ca.prototype.Vc = function () { this.i = !0, Pa(this) }, _a.prototype.a = function () { this.c.stop(); for (var a = id(this.b), e = a.next(); !e.done; e = a.next())e.value.a(); this.b.clear() }, Oa.prototype.a = function () { this.b = this.f = null, this.c = function () { } }, Oa.prototype.h = function (a) { var i = this.b, t = this.f.periods; i != (a = Ra(t, a) || t[0]) && this.c(a), this.b = a }, La.prototype.a = function () { this.c && (this.c.stop(), this.c = null), this.b = null }, La.prototype.set = function (t) { this.f = t, Da(this) }, ja.prototype.a = function () { this.c && (this.c.a(), this.c = null), null != this.f && (this.f.a(), this.f = null), this.g = function () { }, this.b = null }, Ha.prototype.a = function () { this.b && (this.b.stop(), this.b = null), this.c = null }, qa.prototype.a = function () { this.f && (this.f.a(), this.f = null), this.b = null }, qa.prototype.o = function (t) { this.c = this.g ? this.c : t }, qa.prototype.i = function () { return (this.g ? this.b.currentTime : this.c) || 0 }, qa.prototype.v = function () { }, za.prototype.a = function () { this.f && (this.f.a(), this.f = null), this.g && (this.g.a(), this.g = null), this.j && (this.j.stop(), this.j = null), this.c = this.f = this.b = this.h = null, this.w = function () { } }, za.prototype.o = function (a) { var e = this.f; 0 < e.b.readyState ? Ka(e.f, a) : Ba(e, a) }, za.prototype.i = function () { var t = Ua(this.f); return 0 < this.c.readyState && !this.c.paused ? Wa(this, t) : t }, za.prototype.v = function () { this.g.Vc() }, Ya.prototype.a = function () { this.c = function () { }, this.b.clear() }, $a.prototype.a = function () { this.i = null, this.g.clear(), this.b = function () { }, this.c = function () { }, this.f = function () { } }, $a.prototype.h = function (d, e) { for (var t = id(this.i.b), n = t.next(); !n.done; n = t.next()) { n = n.value; var p = this.g.get(n), i = d < n.startTime ? Sa : d > n.endTime ? Za : Qa; this.g.set(n, i); for (var a = id(this.j), o = a.next(); !o.done; o = a.next())(o = o.value).Za == p && o.Ya == i && o.Sa(n, e) } }; var Sa = 1, Qa = 2, Za = 3; Ja.prototype.destroy = function () { for (var a = id(this.b.values()), e = a.next(); !e.done; e = a.next())Cd(e.value); return this.b.clear(), this.i.clear(), this.g = this.h = this.v = this.c = this.a = null, this.f = !0, Promise.resolve() }, Ja.prototype.configure = function (t) { this.g = t, this.F = new te({ maxAttempts: Math.max(t.retryParameters.maxAttempts, 2), baseDelay: t.retryParameters.baseDelay, backoffFactor: t.retryParameters.backoffFactor, fuzzFactor: t.retryParameters.fuzzFactor, timeout: 0 }, !0) }, Ja.prototype.start = function () { var a = this; return rd(function e() { var d, o, s; return od(e, function (e) { switch (e.l) { case 1: return d = a.a.Qa(), o = xd(a, d), (s = a.a.Jd(a.c.periods[o])).variant || s.text ? dd(e, fd(a, s.variant ? s.variant.audio : null, s.variant ? s.variant.video : null, s.text, d), 2) : e.return(new le(2, 5, 5005)); case 2: if (a.f) return e.return(); a.a && a.a.df && a.a.df(), E(e); } }) }) }, Ja.prototype.K = function (d, p, t, n) { var l = n.reader.Yc(), i = n.reader.Yc(), a = n.reader.D(), o = n.reader.D(), s = n.reader.D(), u = n.reader.D(); n = n.reader.Va(n.reader.I.byteLength - n.reader.aa()), d = d.startTime + p.startTime + o / a, t.includes(l) && ("urn:mpeg:dash:event:2012" == l ? this.a.ef() : this.a.onEvent(new be("emsg", { detail: { startTime: d, endTime: d + s / a, schemeIdUri: l, value: i, timescale: a, presentationTimeDelta: o, eventDuration: s, id: u, messageData: n } }))) }, D("shaka.net.HttpFetchPlugin", Rd), Rd.j = function (d, e, t, n, o) { return rd(function i() { var r, k, S, I, A, C, _, w, R, L, D, P; return od(i, function (i) { switch (i.l) { case 1: return r = Rd.g, k = Rd.c, C = A = 0, _ = Date.now(), b(i, 2), dd(i, r(d, t), 4); case 4: return S = i.s, w = S.clone().body.getReader(), L = (R = S.headers.get("Content-Length")) ? parseInt(R, 10) : 0, new k({ start: function (i) { !function e() { return rd(function t() { var d, s; return od(t, function (t) { switch (t.l) { case 1: return b(t, 2), dd(t, w.read(), 4); case 4: d = t.s, T(t, 3); break; case 2: return x(t), t.return(); case 3: d.done || (A += d.value.byteLength), (100 < (s = Date.now()) - _ || d.done) && (o(s - _, A - C, L - A), C = A, _ = s), d.done ? i.close() : (i.enqueue(d.value), e()), E(t); } }) }) }() } }), dd(i, S.arrayBuffer(), 5); case 5: I = i.s, T(i, 3); break; case 2: if (D = x(i), n.rd) throw new le(1, 1, 7001, d, e); if (n.ee) throw new le(1, 1, 1003, d, e); throw new le(1, 1, 1002, d, D, e); case 3: return P = {}, S.headers.forEach(function (a, e) { P[e.trim()] = a }), i.return(wd(P, I, S.status, d, S.url, e)); } }) }) }, Rd.isSupported = function () { if (!ed.ReadableStream) return !1; try { new ReadableStream({}) } catch (t) { return !1 } return ed.fetch && ed.AbortController }, Rd.isSupported = Rd.isSupported, Rd.g = ed.fetch, Rd.a = ed.AbortController, Rd.c = ed.ReadableStream, Rd.b = ed.Headers, Rd.isSupported() && (Ce("http", Rd, 2), Ce("https", Rd, 2)), D("shaka.net.HttpXHRPlugin", Ld), Ld.f = ed.XMLHttpRequest, Ce("http", Ld, 1), Ce("https", Ld, 1), Dd.prototype.close = function (a, e) { if (this.c.has(a)) { var t = this.c.get(a); this.c.delete(a), this.f += t, this.a += e } }, Pd.prototype.destroy = function () { return this.c = !0, Promise.all(this.b.values()).then(function () { }, function () { }) }, Od.prototype.abort = function () { try { this.c.abort() } catch (t) { } return this.a.catch(function () { }) }, Od.prototype.store = function () { return this.b }, Od.prototype.promise = function () { return this.a }, Ud.prototype.destroy = function () { return Promise.all(this.a.map(function (t) { return t.abort() })) }, Vd.prototype.destroy = function () { return this.a.destroy() }, Vd.prototype.getAll = function () { var a = this; return rd(function e() { var i, d; return od(e, function (e) { switch (e.l) { case 1: return i = Bd(a.a, "session-ids"), d = [], dd(e, Md(i, function (a, e) { d.push(e) }), 2); case 2: return dd(e, i.promise(), 3); case 3: return e.return(d); } }) }) }, Vd.prototype.add = function (a) { for (var i = jd(this.a, "session-ids"), t = i.store(), n = (a = id(a)).next(); !n.done; n = a.next())t.add(n.value); return i.promise() }, Vd.prototype.remove = function (a) { var e = this; return rd(function t() { var i; return od(t, function (t) { switch (t.l) { case 1: return dd(t, Md(i = jd(e.a, "session-ids"), function (e, t, n) { 0 <= a.indexOf(t.sessionId) && n.delete() }), 2); case 2: return dd(t, i.promise(), 0); } }) }) }, Kd.prototype.destroy = function () { for (var a = [], e = id(this.a.values()), t = e.next(); !t.done; t = e.next())a.push(t.value.destroy()); return this.a.clear(), Promise.all(a) }, Kd.prototype.init = function () { var a = this; eo.forEach(function (e, t) { var n = e(); n && a.a.set(t, n) }); for (var e = [], t = id(this.a.values()), n = t.next(); !n.done; n = t.next())e.push(n.value.init()); return Promise.all(e) }, Kd.prototype.erase = function () { var a = this; return rd(function e() { var i, d; return od(e, function (e) { switch (e.l) { case 1: return i = Array.from(a.a.values()), (d = 0 < i.length) || eo.forEach(function (t) { (t = t()) && i.push(t) }), dd(e, Promise.all(i.map(function (t) { return t.erase() })), 2); case 2: if (!d) return dd(e, Promise.all(i.map(function (t) { return t.destroy() })), 0); e.A(0); } }) }) }, D("shaka.offline.StorageMuxer.register", qd), D("shaka.offline.StorageMuxer.unregister", function (t) { eo.delete(t) }); var eo = new Map; (r = zd.prototype).destroy = function () { return this.a.destroy() }, r.hasFixedKeySpace = function () { return !0 }, r.addSegments = function () { return Gd("segment") }, r.removeSegments = function (a, e) { return Xd(this, "segment", a, e) }, r.getSegments = function (t) { return Wd(this, "segment", t).then(function (t) { return t.map(Zd) }) }, r.addManifests = function () { return Gd("manifest") }, r.updateManifestExpiration = function (a, e) { var t = jd(this.a, "manifest"), d = t.store(), r = new ue; return d.get(a).onsuccess = function (t) { (t = t.target.result) ? (t.expiration = e, d.put(t), r.resolve()) : r.reject(new le(2, 9, 9012, "Could not find values for " + a)) }, t.promise().then(function () { return r }) }, r.removeManifests = function (a, e) { return Xd(this, "manifest", a, e) }, r.getManifests = function (t) { return Wd(this, "manifest", t).then(function (t) { return t.map(Yd) }) }, r.getAllManifests = function () { var a = this; return rd(function e() { var i, d; return od(e, function (e) { switch (e.l) { case 1: return i = Bd(a.a, "manifest"), d = new Map, dd(e, Md(i, function (a, e) { d.set(a, Yd(e)) }), 2); case 2: return dd(e, i.promise(), 3); case 3: return e.return(d); } }) }) }, (r = ao.prototype).destroy = function () { return this.a.destroy() }, r.hasFixedKeySpace = function () { return this.f }, r.addSegments = function (t) { return no(this, this.c, t) }, r.removeSegments = function (a, e) { return io(this, this.c, a, e) }, r.getSegments = function (t) { return ro(this, this.c, t) }, r.addManifests = function (t) { return no(this, this.b, t) }, r.updateManifestExpiration = function (a, e) { var t = jd(this.a, this.b), i = t.store(); return i.get(a).onsuccess = function (t) { (t = t.target.result) && (t.expiration = e, i.put(t, a)) }, t.promise() }, r.removeManifests = function (a, e) { return io(this, this.b, a, e) }, r.getManifests = function (t) { return ro(this, this.b, t) }, r.getAllManifests = function () { var a = this; return rd(function e() { var i, d; return od(e, function (e) { switch (e.l) { case 1: return i = Bd(a.a, a.b), d = new Map, dd(e, Md(i, function (a, e) { d.set(a, e) }), 2); case 2: return dd(e, i.promise(), 3); case 3: return e.return(d); } }) }) }, (r = oo.prototype).init = function () { var a = this, t = new ue, n = ed.indexedDB.open("shaka_offline_db", 4); return n.onsuccess = function (n) { n = n.target.result, a.f = n; var i = n.objectStoreNames; i = i.contains("manifest") && i.contains("segment") ? new zd(n) : null, a.a = i, i = (i = n.objectStoreNames).contains("manifest-v2") && i.contains("segment-v2") ? new ao(n, "segment-v2", "manifest-v2", !0) : null, a.b = i, i = (i = n.objectStoreNames).contains("manifest-v3") && i.contains("segment-v3") ? new ao(n, "segment-v3", "manifest-v3", !1) : null, a.c = i, n = n.objectStoreNames.contains("session-ids") ? new Vd(n) : null, a.g = n, t.resolve() }, n.onupgradeneeded = function (a) { a = a.target.result; for (var i = id(["segment-v3", "manifest-v3", "session-ids"]), t = i.next(); !t.done; t = i.next())t = t.value, a.objectStoreNames.contains(t) || a.createObjectStore(t, { autoIncrement: !0 }) }, n.onerror = function (a) { t.reject(new le(2, 9, 9001, n.error)), a.preventDefault() }, t }, r.destroy = function () { var a = this; return rd(function e() { return od(e, function (e) { switch (e.l) { case 1: if (!a.a) { e.A(2); break } return dd(e, a.a.destroy(), 2); case 2: if (!a.b) { e.A(4); break } return dd(e, a.b.destroy(), 4); case 4: if (!a.c) { e.A(6); break } return dd(e, a.c.destroy(), 6); case 6: if (!a.g) { e.A(8); break } return dd(e, a.g.destroy(), 8); case 8: a.f && a.f.close(), E(e); } }) }) }, r.getCells = function () { var t = new Map; return this.a && t.set("v1", this.a), this.b && t.set("v2", this.b), this.c && t.set("v3", this.c), t }, r.getEmeSessionCell = function () { return this.g }, r.erase = function () { var e = this; return rd(function t() { return od(t, function (t) { switch (t.l) { case 1: if (!e.a) { t.A(2); break } return dd(t, e.a.destroy(), 2); case 2: if (!e.b) { t.A(4); break } return dd(t, e.b.destroy(), 4); case 4: if (!e.c) { t.A(6); break } return dd(t, e.c.destroy(), 6); case 6: return e.f && e.f.close(), dd(t, function () { var a = new ue, t = ed.indexedDB.deleteDatabase("shaka_offline_db"); return t.onblocked = function () { }, t.onsuccess = function () { a.resolve() }, t.onerror = function (n) { a.reject(new le(2, 9, 9001, t.error)), n.preventDefault() }, a }(), 8); case 8: return e.f = null, e.a = null, e.b = null, e.c = null, dd(t, e.init(), 0); } }) }) }, qd("idb", function () { return ed.indexedDB ? new oo : null }), so.prototype.ra = function () { return this.g }, so.prototype.$ = function () { return this.f }, so.prototype.key = function () { return this.c }, so.prototype.toString = function () { return this.b }, (r = mo.prototype).configure = function () { }, r.start = function (d) { var e = this; return rd(function t() { var p, l, u, c, f; return od(t, function (t) { switch (t.l) { case 1: return p = po(d), e.a = p, null == p || "manifest" != p.a ? t.return(Promise.reject(new le(2, 1, 9004, p))) : (l = new Kd, h(t, 2), dd(t, l.init(), 4)); case 4: return dd(t, Hd(l, p.ra(), p.$()), 5); case 5: return dd(t, t.s.getManifests([p.key()]), 6); case 6: return u = t.s, c = u[0], f = new lo(p.ra(), p.$()), t.return(function (a, e) { var d = new vi(null, 0); d.ta(e.duration); var t = e.periods.map(function (e) { return uo(a, e, d) }), n = e.drmInfo ? [e.drmInfo] : []; return e.drmInfo && t.forEach(function (t) { t.variants.forEach(function (t) { t.drmInfos = n }) }), { presentationTimeline: d, minBufferTime: 2, offlineSessionIds: e.sessionIds, periods: t } }(f, c)); case 2: return k(t), dd(t, l.destroy(), 7); case 7: S(t, 0); } }) }) }, r.stop = function () { return Promise.resolve() }, r.update = function () { }, r.onExpirationUpdated = function (d, e) { var t = this; return rd(function n() { var p, f, m, g, y, h, v; return od(n, function (a) { switch (a.l) { case 1: return p = t.a, f = new Kd, b(a, 2, 3), dd(a, f.init(), 5); case 5: return dd(a, Hd(f, p.ra(), p.$()), 6); case 6: return dd(a, (m = a.s).getManifests([p.key()]), 7); case 7: if (g = a.s, y = g[0], h = y.sessionIds.includes(d), v = null == y.expiration || y.expiration > e, !h || !v) { a.A(3); break } return dd(a, m.updateManifestExpiration(p.key(), e), 3); case 3: return k(a), dd(a, f.destroy(), 10); case 10: S(a, 0); break; case 2: x(a), a.A(3); } }) }) }, rl.Kb("application/x-offline-manifest", mo), D("shaka.offline.OfflineScheme", go), go.h = function (t) { return fe(t = { uri: t, Xc: t, data: new ArrayBuffer(0), headers: { "content-type": "application/x-offline-manifest" } }) }, go.i = function (a, i) { var e = new Kd; return fe(void 0).T(function () { return e.init() }).T(function () { return Hd(e, i.ra(), i.$()) }).T(function (t) { return t.getSegments([i.key()]) }).T(function (t) { return { uri: i, Xc: i, data: t[0].data, headers: {} } }).finally(function () { return e.destroy() }) }, Ce("offline", go), ho.prototype.destroy = function () { var a = this; return rd(function e() { return od(e, function (e) { switch (e.l) { case 1: return a.j = !1, a.b && a.b.abort(), To(a), dd(e, a.m, 2); case 2: a.a && a.a.qa.Ua(); for (var t = id(a.f), n = t.next(); !n.done; n = t.next())n.value.qa.Ua(); a.a = null, a.f = [], a.g = null, E(e); } }) }) }, D("shaka.text.SimpleTextDisplayer", Eo), Eo.prototype.remove = function (a, e) { return !!this.a && (ko(this.a, function (t) { return t.startTime < e && t.endTime > a }), !0) }, Eo.prototype.remove = Eo.prototype.remove, Eo.prototype.append = function (t) { for (var a = [], e = 0, n; e < t.length; e++)n = xo(t[e]), n && a.push(n); a.slice().sort(function (n, e) { return n.startTime == e.startTime ? n.endTime == e.endTime ? a.indexOf(e) - a.indexOf(n) : n.endTime - e.startTime : n.startTime - e.startTime }).forEach(function (t) { this.a.addCue(t) }.bind(this)) }, Eo.prototype.append = Eo.prototype.append, Eo.prototype.destroy = function () { return this.a && ko(this.a, function () { return !0 }), this.a = null, Promise.resolve() }, Eo.prototype.destroy = Eo.prototype.destroy, Eo.prototype.isTextVisible = function () { return "showing" == this.a.mode }, Eo.prototype.isTextVisible = Eo.prototype.isTextVisible, Eo.prototype.setTextVisibility = function (t) { this.a.mode = t ? "showing" : "hidden" }, Eo.prototype.setTextVisibility = Eo.prototype.setTextVisibility, D("shaka.util.ConfigUtils.mergeConfigObjects", So), D("shaka.util.ConfigUtils.convertToConfigObject", Io), D("shaka.util.PlayerConfiguration", Ao), Ao.mergeConfigObjects = _o, P(Oo, ve), D("shaka.Player", Oo), Oo.prototype.destroy = function () { var a = this; return rd(function e() { var i; return od(e, function (e) { switch (e.l) { case 1: return a.g == Ls ? e.return() : (a.g = Ls, i = vo(a.fb, function () { return { node: a.w, payload: { va: null, u: null, mimeType: null, startTime: null, kd: null, uri: null }, Ra: !1 } }), dd(e, new Promise(function (t) { i.pb = function () { }, i.fc = function () { t() }, i.Ua = function () { t() }, i.onError = function () { t() }, i.hc = function () { t() } }), 2)); case 2: return dd(e, a.fb.destroy(), 3); case 3: if (a.i && (a.i.a(), a.i = null), a.rc = null, a.j = null, a.b = null, !a.N) { e.A(0); break } return dd(e, a.N.destroy(), 5); case 5: a.N = null, E(e); } }) }) }, Oo.prototype.destroy = Oo.prototype.destroy, Oo.version = "v2.5.2"; var Ko = ["2", "5"]; tl = new function (t) { this.a = t, this.c = Qn, this.b = Jn }(new Wn(+Ko[0], +Ko[1])); var Rs = ["output-restricted", "internal-error"], Os = {}; Oo.registerSupportPlugin = function (a, e) { Os[a] = e }, Oo.isBrowserSupported = function () { return !!(ed.Promise && ed.Uint8Array && Array.prototype.forEach && ed.MediaKeys && ed.navigator && ed.navigator.requestMediaKeySystemAccess && ed.MediaKeySystemAccess && ed.MediaKeySystemAccess.prototype.getConfiguration) && (!!Xe() || We("application/x-mpegurl")) }, Oo.probeSupport = function () { return kt().then(function (d) { for (var s = rl.xf(), t = {}, n = id(["video/mp4; codecs=\"avc1.42E01E\"", "video/mp4; codecs=\"avc3.42E01E\"", "video/mp4; codecs=\"hev1.1.6.L93.90\"", "video/mp4; codecs=\"hvc1.1.6.L93.90\"", "video/mp4; codecs=\"hev1.2.4.L153.B0\"; eotf=\"smpte2084\"", "video/mp4; codecs=\"hvc1.2.4.L153.B0\"; eotf=\"smpte2084\"", "video/mp4; codecs=\"vp9\"", "video/mp4; codecs=\"vp09.00.10.08\"", "audio/mp4; codecs=\"mp4a.40.2\"", "audio/mp4; codecs=\"ac-3\"", "audio/mp4; codecs=\"ec-3\"", "audio/mp4; codecs=\"opus\"", "audio/mp4; codecs=\"flac\"", "video/webm; codecs=\"vp8\"", "video/webm; codecs=\"vp9\"", "video/webm; codecs=\"vp09.00.10.08\"", "audio/webm; codecs=\"vorbis\"", "audio/webm; codecs=\"opus\"", "video/mp2t; codecs=\"avc1.42E01E\"", "video/mp2t; codecs=\"avc3.42E01E\"", "video/mp2t; codecs=\"hvc1.1.6.L93.90\"", "video/mp2t; codecs=\"mp4a.40.2\"", "video/mp2t; codecs=\"ac-3\"", "video/mp2t; codecs=\"ec-3\"", "text/vtt", "application/mp4; codecs=\"wvtt\"", "application/ttml+xml", "application/mp4; codecs=\"stpp\""]), r = n.next(); !r.done; r = n.next()) { t[r = r.value] = Xe() ? !!Wt(r) || MediaSource.isTypeSupported(r) || Ft(r) : We(r); var p = r.split(";")[0]; t[p] = t[p] || t[r] } for (var a in d = { manifest: s, media: t, drm: d }, Os) d[a] = Os[a](); return d }) }, Oo.prototype.zb = function (a, e) { if (e = void 0 === e || e, this.g == Ls) return Promise.reject(us()); var d = { va: null, u: null, mimeType: null, startTime: null, kd: null, uri: null }; d.u = a, Xe() || (e = !1); var n = e ? this.ab : this.S, r = vo(this.fb, function () { return { node: n, payload: d, Ra: !1 } }); return r.pb = function () { }, fs(r) }, Oo.prototype.attach = Oo.prototype.zb, Oo.prototype.detach = function () { var a = this; if (this.g == Ls) return Promise.reject(us()); var e = vo(this.fb, function () { return { node: a.w, payload: { va: null, u: null, mimeType: null, startTime: null, kd: null, uri: null }, Ra: !1 } }); return e.pb = function () { }, fs(e) }, Oo.prototype.detach = Oo.prototype.detach, Oo.prototype.nd = function (a) { var d = this; if (a = void 0 === a || a, this.g == Ls) return Promise.reject(us()); Xe() || (a = !1); var t = { va: null, u: null, mimeType: null, startTime: null, kd: null, uri: null }, n = vo(this.fb, function (e) { var n = e.u && a ? d.ab : e.u ? d.S : d.w; return t.u = e.u, { node: n, payload: t, Ra: !1 } }); return n.pb = function () { }, fs(n) }, Oo.prototype.unload = Oo.prototype.nd, Oo.prototype.load = function (d, e, t) { if (this.g == Ls) return Promise.reject(us()); this.dispatchEvent(new be("loading")); var n = { va: null, u: null, mimeType: null, startTime: null, kd: null, uri: null }; n.uri = d, n.kd = Date.now() / 1e3, t && "string" != typeof t && (Yn("Loading with a manifest parser factory", "Please register a manifest parser and for the mime-type."), n.va = function () { return new t }), t && "string" == typeof t && (n.mimeType = t), void 0 !== e && (n.startTime = e); var r = function (a) { if (a.va) return !1; if (!Xe()) return !0; var n = a.mimeType; return a = a.uri || "", n || (n = { mp4: "video/mp4", m4v: "video/mp4", m4a: "audio/mp4", webm: "video/webm", ts: "video/mp2t", m3u8: "application/x-mpegurl", mp3: "audio/mpeg", aac: "audio/aac", flac: "audio/flac" }[rl.getExtension(a)]), !!n && !!We(n) && (!rl.isSupported(a, n) || !!navigator.vendor && navigator.vendor.includes("Apple")) }(n) ? this.cb : this.W, i = vo(this.fb, function (t) { return null == t.u ? null : (n.u = t.u, { node: r, payload: n, Ra: !0 }) }); return i.pb = function () { }, new Promise(function (a, n) { i.hc = function () { return n(new le(2, 7, 7002)) }, i.fc = function () { return a() }, i.Ua = function () { return n(us()) }, i.onError = function (t) { return n(t) } }) }, Oo.prototype.load = Oo.prototype.load, Oo.prototype.configure = function (a, i) { 2 == arguments.length && "string" == typeof a && (a = Io(a, i)); var t = _o(this.b, a, Fo(this)); return Bo(this), t }, Oo.prototype.configure = Oo.prototype.configure, Oo.prototype.getConfiguration = function () { var t = Fo(this); return _o(t, this.b, Fo(this)), t }, Oo.prototype.getConfiguration = Oo.prototype.getConfiguration, Oo.prototype.Ff = function () { for (var t in this.b) delete this.b[t]; _o(this.b, Fo(this), Fo(this)), Bo(this) }, Oo.prototype.resetConfiguration = Oo.prototype.Ff, Oo.prototype.Ge = function () { return this.g }, Oo.prototype.getLoadMode = Oo.prototype.Ge, Oo.prototype.Ke = function () { return this.a }, Oo.prototype.getMediaElement = Oo.prototype.Ke, Oo.prototype.Bb = function () { return this.N }, Oo.prototype.getNetworkingEngine = Oo.prototype.Bb, Oo.prototype.$b = function () { return this.xb }, Oo.prototype.getAssetUri = Oo.prototype.$b, Oo.prototype.Je = function () { return Yn("getManifestUri", "Please use \"getAssetUri\" instead."), this.$b() }, Oo.prototype.getManifestUri = Oo.prototype.Je, Oo.prototype.U = function () { return this.c ? this.c.presentationTimeline.U() : this.a && this.a.src && 1 / 0 == this.a.duration }, Oo.prototype.isLive = Oo.prototype.U, Oo.prototype.Ta = function () { return !!this.c && this.c.presentationTimeline.Ta() }, Oo.prototype.isInProgress = Oo.prototype.Ta, Oo.prototype.Ye = function () { if (this.c) { if (!this.c.periods.length) return !1; var t = this.c.periods[0].variants; return !!t.length && !t[0].video } return this.a && this.a.src && (this.a.videoTracks ? 0 == this.a.videoTracks.length : 0 == this.a.videoHeight) }, Oo.prototype.isAudioOnly = Oo.prototype.Ye, Oo.prototype.Hf = function () { if (this.c) { var t = this.c.presentationTimeline; return { start: t.ib(), end: t.wa() } } return this.a && this.a.src && (t = this.a.seekable).length ? { start: t.start(0), end: t.end(t.length - 1) } : { start: 0, end: 0 } }, Oo.prototype.seekRange = Oo.prototype.Hf, Oo.prototype.keySystem = function () { return this.h ? this.h.keySystem() : "" }, Oo.prototype.keySystem = Oo.prototype.keySystem, Oo.prototype.drmInfo = function () { return this.h ? this.h.a : null }, Oo.prototype.drmInfo = Oo.prototype.drmInfo, Oo.prototype.bc = function () { return this.h ? this.h.bc() : 1 / 0 }, Oo.prototype.getExpiration = Oo.prototype.bc, Oo.prototype.Jc = function () { return !!this.V && this.V.a == 0 }, Oo.prototype.isBuffering = Oo.prototype.Jc, Oo.prototype.Ne = function () { if (this.K) { var t = this.K; t = t.g ? 0 : t.f } else t = 0; return t }, Oo.prototype.getPlaybackRate = Oo.prototype.Ne, Oo.prototype.cg = function (t) { 0 == t ? F("A trick play rate of 0 is unsupported!") : (this.g == sl && this.K.set(t), this.g == ol && (this.K.set(t), pd(this.f, 1 < Math.abs(t)))) }, Oo.prototype.trickPlay = Oo.prototype.cg, Oo.prototype.se = function () { this.g == sl && this.K.set(1), this.g == ol && (this.K.set(1), pd(this.f, !1)) }, Oo.prototype.cancelTrickPlay = Oo.prototype.se, Oo.prototype.Ic = function () { if (this.c && this.o) { for (var a = ls(this), e = [], t = id(function (t) { return null == (t = ps(t)) ? [] : t.variants.filter(function (t) { return Fn(t) }) }(this)), n = t.next(), d; !n.done; n = t.next())d = Mn(n = n.value), d.active = n == a, e.push(d); return e } return this.a && this.a.audioTracks ? Array.from(this.a.audioTracks).map(function (a) { var e = jn(a); return e.active = a.enabled, e.type = "variant", e.originalAudioId = a.id, "main" == a.kind ? (e.primary = !0, e.roles = ["main"], e.audioRoles = ["main"]) : e.audioRoles = [], e }) : [] }, Oo.prototype.getVariantTracks = Oo.prototype.Ic, Oo.prototype.kb = function () { if (this.c && this.o) { for (var a = function (a) { var e = ps(a); if (null == e) return null; if (!pa(a.F, e).text) { var t = Hn(e.textStreams, a.Ka, a.yb); t.length && da(a.F, e, t[0]) } return pa(a.F, e).text }(this), e = [], t = id(function (a) { var e = ps(a); return null == e ? [] : e.textStreams.filter(function (e) { return !a.Tb.has(e) }) }(this)), n = t.next(), d; !n.done; n = t.next())d = Un(n = n.value), d.active = n == a, e.push(d); return e } return this.a && this.a.src && this.a.textTracks ? Array.from(this.a.textTracks).map(function (a) { var e = jn(a); return e.active = "disabled" != a.mode, e.type = "text", e.originalTextId = a.id, "captions" == a.kind && (e.mimeType = "application/cea-608"), e }) : [] }, Oo.prototype.getTextTracks = Oo.prototype.kb, Oo.prototype.dd = function (a) { if (this.c && this.f) { var e = ps(this), i = e.textStreams.find(function (e) { return e.id == a.id }); i && (da(this.F, e, i), Po(this.v.b, i, !1), qo(this, i), this.Ka = i.language) } else if (this.a && this.a.src && this.a.textTracks) { for (i = (e = id(e = Array.from(this.a.textTracks))).next(); !i.done; i = e.next())i.mode = Bn(i = i.value) == a.id ? this.$a ? "showing" : "hidden" : "disabled"; $o(this) } }, Oo.prototype.selectTextTrack = Oo.prototype.dd, Oo.prototype.Jf = function () { Yn("selectEmbeddedTextTrack", "If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack."); var t = this.kb().filter(function (t) { return "application/cea-608" == t.mimeType }); 0 < t.length && this.dd(t[0]) }, Oo.prototype.selectEmbeddedTextTrack = Oo.prototype.Jf, Oo.prototype.hg = function () { Yn("usingEmbeddedTextTrack", "If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text."); var t = this.kb().filter(function (t) { return t.active })[0]; return !!t && "application/cea-608" == t.mimeType }, Oo.prototype.usingEmbeddedTextTrack = Oo.prototype.hg, Oo.prototype.Lf = function (a, e, d) { if (d = void 0 === d ? 0 : d, this.c && this.f) { var o = ps(this); this.b.abr.enabled && F("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack()."); var r = o.variants.find(function (e) { return e.id == a.id }); r && Fn(r) && (jo(this, o, r, !1), Ho(this, r, e, d), this.Rb = new wa(r), Xo(this, o.variants)) } else if (this.a && this.a.audioTracks) { for (d = (e = id(e = Array.from(this.a.audioTracks))).next(); !d.done; d = e.next())Bn(d = d.value) == a.id && (d.enabled = !0); Jo(this) } }, Oo.prototype.selectVariantTrack = Oo.prototype.Lf, Oo.prototype.Be = function () { return ss(this.Ic()) }, Oo.prototype.getAudioLanguagesAndRoles = Oo.prototype.Be, Oo.prototype.Ue = function () { return ss(this.kb()) }, Oo.prototype.getTextLanguagesAndRoles = Oo.prototype.Ue, Oo.prototype.Ae = function () { return Array.from(os(this.Ic())) }, Oo.prototype.getAudioLanguages = Oo.prototype.Ae, Oo.prototype.Te = function () { return Array.from(os(this.kb())) }, Oo.prototype.getTextLanguages = Oo.prototype.Te, Oo.prototype.If = function (a, e) { if (this.c && this.o) { var t = ps(this); this.Rb = new Ta(a, e || "", 0), Wo(this, t) } else if (this.a && this.a.audioTracks) { for (var i = (t = id(t = Array.from(this.a.audioTracks))).next(); !i.done; i = t.next())(i = i.value).language == a && (i.enabled = !0); Jo(this) } }, Oo.prototype.selectAudioLanguage = Oo.prototype.If, Oo.prototype.Kf = function (a, e) { if (this.c && this.o) { var t = ps(this); this.Ka = a, this.yb = e || "", Wo(this, t) } else (t = this.kb().filter(function (e) { return e.language == a })[0]) && this.dd(t) }, Oo.prototype.selectTextLanguage = Oo.prototype.Kf, Oo.prototype.Mc = function () { var t = this.$a; return this.c ? this.C.h.isTextVisible() : this.a && this.a.src && this.a.textTracks ? Array.from(this.a.textTracks).some(function (t) { return "showing" == t.mode }) : t }, Oo.prototype.isTextTrackVisible = Oo.prototype.Mc, Oo.prototype.Of = function (d) { var e = this; return rd(function t() { var p, n, l, c; return od(t, function (t) { switch (t.l) { case 1: if (e.$a == (p = d)) return t.return(); if (e.$a = p, e.g != ol) { if (e.a && e.a.src && e.a.textTracks) for (var a = id(Array.from(e.a.textTracks)), i = a.next(); !i.done; i = a.next())"disabled" != (n = i.value).mode && (n.mode = d ? "showing" : "hidden"); t.A(2); break } if (e.C.h.setTextVisibility(d), e.b.streaming.alwaysStreamText) { t.A(2); break } if (!d) { (a = e.f).C = !0, (i = a.b.get("text")) && (Cd(i), a.b.delete("text")), t.A(2); break } if (l = ps(e), !(0 < (c = Hn(l.textStreams, e.Ka, e.yb)).length)) { t.A(2); break } return dd(t, sd(e.f, c[0]), 2); case 2: Zo(e), E(t); } }) }) }, Oo.prototype.setTextTrackVisibility = Oo.prototype.Of, Oo.prototype.Pe = function () { if (!this.U()) return null; if (this.c) return new Date(1e3 * (this.c.presentationTimeline.f + this.a.currentTime)); if (this.a && this.a.getStartDate) { var t = this.a.getStartDate(); return isNaN(t.getTime()) ? null : new Date(t.getTime() + 1e3 * this.a.currentTime) } return null }, Oo.prototype.getPlayheadTimeAsDate = Oo.prototype.Pe, Oo.prototype.Re = function () { if (!this.U()) return null; if (this.c) return new Date(1e3 * this.c.presentationTimeline.f); if (this.a && this.a.getStartDate) { var t = this.a.getStartDate(); return isNaN(t.getTime()) ? null : t } return null }, Oo.prototype.getPresentationStartTimeAsDate = Oo.prototype.Re, Oo.prototype.Ec = function () { var t = { total: [], audio: [], video: [], text: [] }; return this.g == sl && (t.total = Mt(this.a.buffered)), this.g == ol && this.C.Ec(t), t }, Oo.prototype.getBufferedInfo = Oo.prototype.Ec, Oo.prototype.getStats = function () { if (this.g != ol && this.g != sl) return { width: NaN, height: NaN, streamBandwidth: NaN, decodedFrames: NaN, droppedFrames: NaN, estimatedBandwidth: NaN, loadLatency: NaN, playTime: NaN, pauseTime: NaN, bufferingTime: NaN, switchHistory: [], stateHistory: [] }; Go(this); var f = this.a; if (f.getVideoPlaybackQuality) { f = f.getVideoPlaybackQuality(); var m = this.v, g = +f.totalVideoFrames; m.i = +f.droppedVideoFrames, m.h = g } this.g == ol && ((f = ls(this)) && (this.v.j = f.bandwidth), f && f.video && (m = this.v, g = f.video.height || NaN, m.m = f.video.width || NaN, m.g = g), f = this.j.getBandwidthEstimate(), this.v.f = f); var y = this.v; f = y.m, m = y.g, g = y.j; for (var b = y.h, i = y.i, a = y.f, o = y.c, s = Lo(y.a, "playing"), u = Lo(y.a, "paused"), c = Lo(y.a, "buffering"), l = function (a) { function e(t) { return { timestamp: t.timestamp, state: t.state, duration: t.duration } } for (var t = [], n = id(a.b), r = n.next(); !r.done; r = n.next())t.push(e(r.value)); return a.a && t.push(e(a.a)), t }(y.a), h = [], d = (y = id(y.b.a)).next(); !d.done; d = y.next())d = d.value, h.push({ timestamp: d.timestamp, id: d.id, type: d.type, fromAdaptation: d.fromAdaptation, bandwidth: d.bandwidth }); return { width: f, height: m, streamBandwidth: g, decodedFrames: b, droppedFrames: i, estimatedBandwidth: a, loadLatency: o, playTime: s, pauseTime: u, bufferingTime: c, stateHistory: l, switchHistory: h } }, Oo.prototype.getStats = Oo.prototype.getStats, Oo.prototype.addTextTrack = function (d, e, t, n, r, i) { var a = this; return rd(function o() { var g, y, b, T, E, x, k, S, I; return od(o, function (d) { switch (d.l) { case 1: if (a.g == sl) throw Error("State error!"); if (a.g != ol) throw Error("State error!"); if (g = ps(a), y = Vt, b = a.c.periods.indexOf(g), E = (T = b + 1) >= a.c.periods.length ? a.c.presentationTimeline.Y() : a.c.periods[T].startTime, 1 / 0 == (x = E - g.startTime)) throw new le(1, 4, 4033); return k = new Br(1, 0, x, function () { return [d] }, 0, null), S = { id: a.Fd++, originalId: null, createSegmentIndex: Promise.resolve.bind(Promise), findSegmentPosition: function () { return 1 }, getSegmentReference: function (t) { return 1 == t ? k : null }, initSegmentReference: null, presentationTimeOffset: 0, mimeType: n, codecs: r || "", kind: t, encrypted: !1, keyId: null, language: e, label: i || null, type: y.na, primary: !1, trickModeVideo: null, emsgSchemeIdUris: null, roles: [], channelsCount: null, closedCaptions: null }, a.Tb.add(S), g.textStreams.push(S), dd(d, sd(a.f, S), 2); case 2: return (I = Zr(a.f, "text")) && da(a.F, g, I), a.Tb.delete(S), Wo(a, g), Qo(a), d.return(Un(S)); } }) }) }, Oo.prototype.addTextTrack = Oo.prototype.addTextTrack, Oo.prototype.fd = function (a, e) { this.Ub.width = a, this.Ub.height = e }, Oo.prototype.setMaxHardwareResolution = Oo.prototype.fd, Oo.prototype.cd = function () { if (this.g == ol) { var a = this.f; if (a.f) a = !1; else if (a.m) a = !1; else { for (var i = id(a.b.values()), t = i.next(); !t.done; t = i.next())(t = t.value).Eb && (t.Eb = !1, Ad(a, t, .1)); a = !0 } } else a = !1; return a }, Oo.prototype.retryStreaming = Oo.prototype.cd, Oo.prototype.He = function () { return this.c }, Oo.prototype.getManifest = Oo.prototype.He, Oo.prototype.Ie = function () { return this.m ? this.m.constructor : null }, Oo.prototype.getManifestParserFactory = Oo.prototype.Ie, (r = Oo.prototype).Bc = function (a) { var d = this.f ? Jr(this.f) : null, o = this.f ? $r(this.f) : null; if (Nn(this.h, d, o, a), !(d = a.variants).some(Fn)) throw new le(2, 4, 4011); if (rs(this, a.variants), Dn(d, this.b.restrictions, this.Ub) && this.f && ps(this) == a && Qo(this), a = this.h ? this.h.a : null) for (o = (d = id(d)).next(); !o.done; o = d.next())for (var s = (o = id(o.value.drmInfos)).next(); !s.done; s = o.next())if ((s = s.value).keySystem == a.keySystem) for (var p = (s = id(s.initData || [])).next(); !p.done; p = s.next())p = p.value, yt(this.h, p.initDataType, p.initData) }, r.af = function (d) { try { this.eb = !0, this.j.disable(), es(this); var p = Xo(this, d.variants), m = Hn(d.textStreams, this.Ka, this.yb)[0] || null; if (this.ka && (d.variants.includes(this.ka) && (p = this.ka), this.ka = null), this.ja && (d.textStreams.includes(this.ja) && (m = this.ja), this.ja = null), p && jo(this, d, p, !0), m) { var g = m; da(this.F, d, g), Po(this.v.b, g, !0) } var r = this.f, i = r.b.get("video"); if (i) var a = r.c.periods[i.ya]; else { var y = r.b.get("audio"); a = y ? r.c.periods[y.ya] : null } var s = p ? p.audio : null; if (!a && m) { var u; if (u = s) { d = m; var b = _n(this.b.preferredTextLanguage), l = _n(s.language), f = _n(d.language); u = An(f, b) && !An(l, f) } u && (this.$a = !0), this.$a && this.C.h.setTextVisibility(!0), Zo(this) } return this.b.streaming.alwaysStreamText || this.Mc() ? { variant: p, text: m } : { variant: p, text: null } } catch (t) { return this.Ha(t), { variant: null, text: null } } }, r.re = function () { this.eb = !1, this.b.abr.enabled && (this.j.enable(), es(this)), this.ka && (ld(this.f, this.ka, this.Bd, this.zd), Jo(this), this.ka = null), this.ja && (ud(this.f, this.ja, !0, 0, !1), $o(this), this.ja = null) }, r.ff = function () { this.m && this.m.update && this.m.update() }, r.mf = function () { this.o && this.o.v() }, r.Ha = function (a) { if (this.g != Ls) { var e = new be("error", { detail: a }); this.dispatchEvent(e), e.defaultPrevented && (a.handled = !0) } }; var Ls = 0, dl = 1, ol = 2, sl = 3; Oo.LoadMode = { DESTROYED: 0, NOT_LOADED: 1, MEDIA_SOURCE: 2, SRC_EQUALS: 3 }, hs.prototype.destroy = function () { var t = this; return this.a ? this.b : (this.a = !0, this.c().then(function () { t.b.resolve() }, function () { t.b.resolve() })) }, Es.prototype.add = function (t) { xs(this, t) || this.a.push(t) }, D("shaka.offline.Storage", Ss), Ss.support = Is, Ss.prototype.destroy = function () { return this.h.destroy() }, Ss.prototype.destroy = Ss.prototype.destroy, Ss.prototype.configure = function (a, i) { 2 == arguments.length && "string" == typeof a && (a = Io(a, i)); var t = a, n = !1; return null != t.trackSelectionCallback && (n = !0, t.offline = t.offline || {}, t.offline.trackSelectionCallback = t.trackSelectionCallback, delete t.trackSelectionCallback), null != t.progressCallback && (n = !0, t.offline = t.offline || {}, t.offline.progressCallback = t.progressCallback, delete t.progressCallback), null != t.usePersistentLicense && (n = !0, t.offline = t.offline || {}, t.offline.usePersistentLicense = t.usePersistentLicense, delete t.usePersistentLicense), n && Yn("Storage.configure with OfflineConfig", "Please configure storage with a player configuration."), _o(this.a, a) }, Ss.prototype.configure = Ss.prototype.configure, Ss.prototype.getConfiguration = function () { var t = Co(); return _o(t, this.a, Co()), t }, Ss.prototype.getConfiguration = Ss.prototype.getConfiguration, Ss.prototype.Bb = function () { return this.b }, Ss.prototype.getNetworkingEngine = Ss.prototype.Bb, Ss.prototype.store = function (d, e, o) { var n = this; return Ns(this, function (d, e, t, n) { return rd(function r() { var f, m, g, y, T, E, I, A, C; return od(r, function (a) { switch (a.l) { case 1: return Ps(), d.f ? a.return(Promise.reject(new le(2, 9, 9006))) : (d.f = !0, dd(a, function (d, e, t) { return rd(function n() { var p, l, f, m, g, y; return od(n, function (a) { switch (a.l) { case 1: return p = null, l = d.b, f = { networkingEngine: l, filterAllPeriods: function () { }, filterNewPeriod: function () { }, onTimelineRegionAdded: function () { }, onEvent: function () { }, onError: function (t) { p = t } }, dd(a, t(), 2); case 2: return (m = a.s).configure(d.a.manifest), Ds(d), h(a, 3), dd(a, m.start(e, f), 5); case 5: return g = a.s, Ds(d), y = Ms(g), dd(a, Promise.all(Array.from(y).map(function (t) { return t.createSegmentIndex() })), 6); case 6: if (Ds(d), p) throw p; return a.return(g); case 3: return k(a), dd(a, m.stop(), 7); case 7: S(a, 0); } }) }) }(d, e, n), 2)); case 2: if (f = a.s, Ds(d), f.presentationTimeline.U() || f.presentationTimeline.Ta()) throw new le(2, 9, 9005, e); return m = null, g = new Kd, T = y = null, b(a, 3, 4), dd(a, function (d, e, t) { return rd(function n() { var s, p, l; return od(n, function (a) { switch (a.l) { case 1: return s = new pt({ nb: d.b, onError: t, gc: function () { }, onExpirationUpdated: function () { }, onEvent: function () { } }), p = Na(e.periods), l = d.a, s.configure(l.drm), dd(a, function (a, e, t) { return a.o = [], a.C = t, ft(a, e) }(s, p, l.offline.usePersistentLicense), 2); case 2: return dd(a, mt(s), 3); case 3: return dd(a, gt(s), 4); case 4: return a.return(s); } }) }) }(d, f, function (t) { T = T || t }), 6); case 6: if (m = a.s, Ds(d), T) throw T; return function (d, e, t) { (function (a, d) { for (var t = { width: 1 / 0, height: 1 / 0 }, e = id(a.periods), n = e.next(); !n.done; n = e.next())(n = n.value).variants = n.variants.filter(function (a) { return Pn(a, d, t) }) })(e, d.a.restrictions), function (a) { for (var n = (a = id(a.periods)).next(); !n.done; n = a.next())(n = n.value).variants = n.variants.filter(function (a) { var e = !0; return a.audio && (e = e && mn(a.audio)), a.video && (e = e && mn(a.video)), e }) }(e), function (a, i) { for (var e = id(a.periods), t = e.next(); !t.done; t = e.next())(t = t.value).variants = t.variants.filter(function (t) { return St(i, t) }) }(e, t), vs(e), function (a, i) { var t = new Es; a.periods.forEach(function (a, e) { 0 < e && (a.variants = a.variants.filter(function (a) { return xs(t, new Ts(a)) })), i(a), t = ks(a.variants) }) }(e, function (e) { for (var t = [], s = id(e.variants), p = s.next(); !p.done; p = s.next())t.push(Mn(p.value)); for (p = (s = id(e.textStreams)).next(); !p.done; p = s.next())t.push(Un(p.value)); t = d.a.offline.trackSelectionCallback(t); var l = new Set, a = new Set; for (s = (t = id(t)).next(); !s.done; s = t.next())"variant" == (s = s.value).type && l.add(s.id), "text" == s.type && a.add(s.id); e.variants = e.variants.filter(function (t) { return l.has(t.id) }), e.textStreams = e.textStreams.filter(function (t) { return a.has(t.id) }) }), function (a) { if (0 == a.periods.length) throw new le(2, 4, 4014); for (var n = (a = id(a.periods)).next(); !n.done; n = a.next())Us(n.value) }(e) }(d, f, m), dd(a, g.init(), 7); case 7: return Ds(d), dd(a, function (a) { var i = null; if (a.a.forEach(function (t, a) { t.getCells().forEach(function (t, e) { t.hasFixedKeySpace() || i || (i = { path: { ra: a, $: e }, $: t }) }) }), i) return i; throw new le(2, 9, 9013, "Could not find a cell that supports add-operations") }(g), 8); case 8: return y = a.s, Ds(d), dd(a, function (d, e, t, n, r, i) { return rd(function a() { var p, f, m, g; return od(a, function (a) { switch (a.l) { case 1: return p = function (a, e, i) { var n = null == e.expiration ? 1 / 0 : e.expiration; return { offlineUri: null, originalManifestUri: a, duration: e.presentationTimeline.Y(), size: 0, expiration: n, tracks: e = gs(e.periods[0]), appMetadata: i } }(r, n, i), f = new Pd(d.b, function (e, t) { p.size = t, d.a.offline.progressCallback(p, e) }), h(a, 2), g = m = function (d, e, t, n, p, i, a) { var o = new ys, r = p.periods.map(function (a) { return function (d, e, t, p, n, i) { n.periods.forEach(function (t) { t.variants.forEach(function (r) { var e = r.audio, t = r.video; if (e && !t && (p.a[e.id] = e.bandwidth || r.bandwidth), !e && t && (p.a[t.id] = t.bandwidth || r.bandwidth), e && t) { var n = e.bandwidth || 393216, i = t.bandwidth || r.bandwidth - n; 0 >= i && (i = r.bandwidth), p.a[e.id] = n, p.a[t.id] = i } }), t.textStreams.forEach(function (t) { p.a[t.id] = 52 }) }); for (var a = Ms(n), r = new Map, s = (a = id(a)).next(); !s.done; s = a.next()) { s = s.value; var l = ws(d, e, t, p, n, s); r.set(s.id, l) } return i.variants.forEach(function (t) { t.audio && r.get(t.audio.id).variantIds.push(t.id), t.video && r.get(t.video.id).variantIds.push(t.id) }), { startTime: i.startTime, streams: Array.from(r.values()) } }(d, e, t, o, p, a) }), s = n.a, u = ht(n); if (s && d.a.offline.usePersistentLicense) { if (!u.length) throw new le(2, 9, 9007, i); s.initData = [] } return { originalManifestUri: i, duration: p.presentationTimeline.Y(), size: 0, expiration: n.bc(), periods: r, sessionIds: d.a.offline.usePersistentLicense ? u : [], drmInfo: s, appMetadata: a } }(d, f, e, t, n, r, i), dd(a, function (a) { return rd(function e() { return od(e, function (e) { switch (e.l) { case 1: return dd(e, Promise.all(a.b.values()), 2); case 2: return e.return(a.a.a); } }) }) }(f), 4); case 4: return g.size = a.s, a.return(m); case 2: return k(a), dd(a, f.destroy(), 5); case 5: S(a, 0); } }) }) }(d, y.$, m, f, e, t), 9); case 9: if (E = a.s, Ds(d), T) throw T; return dd(a, y.$.addManifests([E]), 10); case 10: return I = a.s, Ds(d), A = new so("manifest", y.path.ra, y.path.$, I[0]), a.return(ms(A, E)); case 4: return k(a), d.f = !1, d.c = [], dd(a, g.destroy(), 11); case 11: if (!m) { a.A(12); break } return dd(a, m.destroy(), 12); case 12: S(a, 0); break; case 3: if (C = x(a), !y) { a.A(14); break } return dd(a, y.$.removeSegments(d.c, function () { }), 14); case 14: throw T || C; } }) }) }(this, d, e || {}, function () { return rd(function e() { var r, s; return od(e, function (e) { switch (e.l) { case 1: return o && "string" != typeof o ? (Yn("Storing with a manifest parser factory", "Please register a manifest parser and for the mime-type."), r = o, e.return(new r)) : dd(e, rl.create(d, n.b, n.a.manifest.retryParameters, o), 2); case 2: return s = e.s, e.return(s); } }) }) })) }, Ss.prototype.store = Ss.prototype.store, Ss.prototype.Se = function () { return this.f }, Ss.prototype.getStoreInProgress = Ss.prototype.Se, Ss.prototype.remove = function (t) { return Ns(this, function (d, e) { return rd(function t() { var p, l, c, f, m, g; return od(t, function (t) { switch (t.l) { case 1: return Ps(), null == (p = po(e)) || "manifest" != p.a ? t.return(Promise.reject(new le(2, 9, 9004, e))) : (l = p, c = new Kd, h(t, 2), dd(t, c.init(), 4)); case 4: return dd(t, Hd(c, l.ra(), l.$()), 5); case 5: return dd(t, (f = t.s).getManifests([l.key()]), 6); case 6: return m = t.s, g = m[0], dd(t, Promise.all([Cs(d, g, c), _s(d, f, l, g)]), 2); case 2: return k(t), dd(t, c.destroy(), 8); case 8: S(t, 0); } }) }) }(this, t)) }, Ss.prototype.remove = Ss.prototype.remove, Ss.prototype.Cf = function () { return Ns(this, function (d) { return rd(function e() { var p, f, m, g, t, y, b, v, T; return od(e, function (e) { switch (e.l) { case 1: return Ps(), p = d.b, f = d.a.drm, m = new Kd, g = !1, h(e, 2), dd(e, m.init(), 4); case 4: for (t = [], function (a, n) { a.a.forEach(function (t) { n(t.getEmeSessionCell()) }) }(m, function (a) { return t.push(a) }), y = Promise.resolve(), b = {}, v = id(t), T = v.next(); !T.done; b = { mc: b.mc }, T = v.next())b.mc = T.value, y = y.then(function (a) { return function () { return rd(function e() { var n, r; return od(e, function (e) { switch (e.l) { case 1: return dd(e, a.mc.getAll(), 2); case 2: return n = e.s, dd(e, yo(f, p, n), 3); case 3: return r = e.s, dd(e, a.mc.remove(r), 4); case 4: r.length != n.length && (g = !0), E(e); } }) }) } }(b)); return dd(e, y, 2); case 2: return k(e), dd(e, m.destroy(), 6); case 6: S(e, 3); break; case 3: return e.return(!g); } }) }) }(this)) }, Ss.prototype.removeEmeSessions = Ss.prototype.Cf, Ss.prototype.list = function () { return Ns(this, rd(function a() { var d, i, o; return od(a, function (t) { switch (t.l) { case 1: return Ps(), d = [], i = new Kd, h(t, 2), dd(t, i.init(), 4); case 4: return o = Promise.resolve(), function (a, i) { a.a.forEach(function (t, a) { t.getCells().forEach(function (t, e) { i({ ra: a, $: e }, t) }) }) }(i, function (t, e) { o = o.then(function () { return rd(function a() { return od(a, function (a) { switch (a.l) { case 1: return dd(a, e.getAllManifests(), 2); case 2: a.s.forEach(function (e, a) { var n = ms(new so("manifest", t.ra, t.$, a), e); d.push(n) }), E(a); } }) }) }) }), dd(t, o, 2); case 2: return k(t), dd(t, i.destroy(), 6); case 6: S(t, 3); break; case 3: return t.return(d); } }) })) }, Ss.prototype.list = Ss.prototype.list, Ss.deleteAll = function () { return rd(function a() { var n; return od(a, function (t) { switch (t.l) { case 1: return n = new Kd, h(t, 2), dd(t, n.erase(), 2); case 2: return k(t), dd(t, n.destroy(), 5); case 5: S(t, 0); } }) }) }, Os.offline = Is, D("shaka.polyfill.installAll", function () { for (var t = 0; t < pl.length; ++t)pl[t].pe() }); var pl = [], ll, ul; D("shaka.polyfill.register", Bs), Bs(function () { if (ed.Document) { var e = Element.prototype; e.requestFullscreen = e.requestFullscreen || e.mozRequestFullScreen || e.msRequestFullscreen || e.webkitRequestFullscreen, (e = Document.prototype).exitFullscreen = e.exitFullscreen || e.mozCancelFullScreen || e.msExitFullscreen || e.webkitExitFullscreen, "fullscreenElement" in document || (Object.defineProperty(document, "fullscreenElement", { get: function () { return document.mozFullScreenElement || document.msFullscreenElement || document.webkitFullscreenElement } }), Object.defineProperty(document, "fullscreenEnabled", { get: function () { return document.mozFullScreenEnabled || document.msFullscreenEnabled || document.webkitSupportsFullscreen || document.webkitFullscreenEnabled } })), document.addEventListener("webkitfullscreenchange", js), document.addEventListener("webkitfullscreenerror", js), document.addEventListener("mozfullscreenchange", js), document.addEventListener("mozfullscreenerror", js), document.addEventListener("MSFullscreenChange", js), document.addEventListener("MSFullscreenError", js) } }), Bs(function () { Ye("CrKey") && delete ed.indexedDB }), Bs(function () { Ye("Trident/") && !HTMLInputElement.prototype.originalAddEventListener && (HTMLInputElement.prototype.originalAddEventListener = HTMLInputElement.prototype.addEventListener, HTMLInputElement.prototype.addEventListener = Fs) }), Bs(function () { navigator.languages || Object.defineProperty(navigator, "languages", { get: function () { return navigator.language ? [navigator.language] : ["en"] } }) }), Bs(function () { }), Bs(function () { if (ed.MediaSource) if (ed.cast && cast.__platform__ && cast.__platform__.canDisplayType) !function () { var d = MediaSource.isTypeSupported, a = /^dv(?:h[e1]|a[v1])\./; MediaSource.isTypeSupported = function (e) { for (var t = e.split(/ *; */), p = t[0], m = {}, g = 1; g < t.length; ++g) { var y = t[g].split("="), b = y[0]; y = y[1].replace(/"(.*)"/, "$1"), m[b] = y } if (!(t = m.codecs)) return d(e); var u = !1, h = !1; for (var v in e = t.split(",").filter(function (t) { return a.test(t) && (h = !0), /^(hev|hvc)1\.2/.test(t) && (u = !0), !0 }), h && (u = !1), m.codecs = e.join(","), u && (m.eotf = "smpte2084"), m) p += "; " + v + "=\"" + m[v] + "\""; return cast.__platform__.canDisplayType(p) } }(); else if (navigator.vendor && navigator.vendor.includes("Apple")) { var e = navigator.appVersion; !function () { var a = MediaSource.isTypeSupported; MediaSource.isTypeSupported = function (e) { return "mp2t" != e.split(/ *; */)[0].split("/")[1] && a(e) } }(), e.includes("Version/8") ? ed.MediaSource = null : e.includes("Version/9") ? Vs() : e.includes("Version/10") ? (Vs(), function () { var d = MediaSource.prototype.endOfStream; MediaSource.prototype.endOfStream = function () { for (var e = [], t = 0; t < arguments.length; ++t)e[t] = arguments[t]; for (var n = t = 0, o; n < this.sourceBuffers.length; ++n)o = this.sourceBuffers[n], o = o.buffered.end(o.buffered.length - 1), t = Math.max(t, o); if (!isNaN(this.duration) && t < this.duration) for (this.Cd = !0, t = 0; t < this.sourceBuffers.length; ++t)this.sourceBuffers[t].td = !1; return d.apply(this, e) }; var e = !1, a = MediaSource.prototype.addSourceBuffer; MediaSource.prototype.addSourceBuffer = function () { for (var t = [], n = 0; n < arguments.length; ++n)t[n] = arguments[n]; return (t = a.apply(this, t)).mediaSource_ = this, t.addEventListener("updateend", Ks, !1), e || (this.addEventListener("sourceclose", Hs, !1), e = !0), t } }()) : (e.includes("Version/11") || e.includes("Version/12")) && (Vs(), function () { var a = SourceBuffer.prototype.remove; SourceBuffer.prototype.remove = function (e, t) { return a.call(this, e, t - .001) } }()) } else Ye("Tizen") && function () { var a = MediaSource.isTypeSupported; MediaSource.isTypeSupported = function (e) { return "opus" != Ge(e)[0] && a(e) } }() }), zs.prototype.createMediaKeys = function () { var t = new Xs(this.keySystem); return Promise.resolve(t) }, zs.prototype.getConfiguration = function () { return this.a }, Xs.prototype.createSession = function (t) { if ("temporary" != (t = t || "temporary")) throw new TypeError("Session type " + t + " is unsupported on this platform."); return new Ys(this.b, t) }, Xs.prototype.setServerCertificate = function (t) { return this.c = t ? new Uint8Array(t) : null, Promise.resolve(!0) }, P(Ys, ve), (r = Ys.prototype).generateRequest = function (a, e) { this.a = new ue; try { this.c = this.g.createSession("video/mp4", new Uint8Array(e)), De(this.f, this.c, "webkitkeymessage", this.Xf.bind(this)), De(this.f, this.c, "webkitkeyadded", this.Vf.bind(this)), De(this.f, this.c, "webkitkeyerror", this.Wf.bind(this)), Js(this, "status-pending") } catch (t) { this.a.reject(t) } return this.a }, r.load = function () { return Promise.reject(Error("MediaKeySession.load not yet supported")) }, r.update = function (t) { this.b = new ue; try { this.c.update(new Uint8Array(t)) } catch (t) { this.b.reject(t) } return this.b }, r.close = function () { try { this.c.close(), this.closed.resolve(), Oe(this.f) } catch (t) { this.closed.reject(t) } return this.closed }, r.remove = function () { return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform")) }, r.Xf = function (t) { this.a && (this.a.resolve(), this.a = null), this.dispatchEvent(new be("message", { messageType: null == this.keyStatuses.a ? "license-request" : "license-renewal", message: t.message.buffer })) }, r.Vf = function () { this.b && (Js(this, "usable"), this.b.resolve(), this.b = null) }, r.Wf = function () { var t = Error("EME PatchedMediaKeysApple key error"); if (t.errorCode = this.c.error, null != this.a) this.a.reject(t), this.a = null; else if (null != this.b) this.b.reject(t), this.b = null; else switch (this.c.error.code) { case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT: case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE: Js(this, "output-not-allowed"); break; default: Js(this, "internal-error"); } }, (r = $s.prototype).forEach = function (t) { this.a && t(this.a, ll) }, r.get = function (t) { if (this.has(t)) return this.a }, r.has = function (a) { var e = ll; return this.a && ut(new Uint8Array(a), new Uint8Array(e)) }, r.entries = function () { }, r.keys = function () { }, r.values = function () { }, Bs(function () { ed.HTMLVideoElement && ed.WebKitMediaKeys && (ll = new Uint8Array([0]).buffer, delete HTMLMediaElement.prototype.mediaKeys, HTMLMediaElement.prototype.mediaKeys = null, HTMLMediaElement.prototype.setMediaKeys = Gs, ed.MediaKeys = Xs, ed.MediaKeySystemAccess = zs, navigator.requestMediaKeySystemAccess = qs) }), Zs.prototype.c = function (d) { if (!(1 < d.version)) { var e = lt(d.reader.Va(16)), t = []; if (0 < d.version) for (var n = d.reader.D(), o = 0, s; o < n; ++o)s = lt(d.reader.Va(16)), t.push(s); n = d.reader.D(), d.reader.J(n), this.b.push.apply(this.b, t), this.f.push(e), this.a.push({ start: d.start, end: d.start + d.size - 1 }) } }, tp.prototype.createMediaKeys = function () { var t = new np(this.keySystem); return Promise.resolve(t) }, tp.prototype.getConfiguration = function () { return this.a }, np.prototype.createSession = function (t) { if ("temporary" != (t = t || "temporary")) throw new TypeError("Session type " + t + " is unsupported on this platform."); return new rp(this.a, t) }, np.prototype.setServerCertificate = function () { return Promise.resolve(!1) }, P(rp, ve), (r = rp.prototype).generateRequest = function (a, e) { this.a = new ue; try { this.c = this.g.createSession("video/mp4", new Uint8Array(e), null), De(this.f, this.c, "mskeymessage", this.kf.bind(this)), De(this.f, this.c, "mskeyadded", this.hf.bind(this)), De(this.f, this.c, "mskeyerror", this.jf.bind(this)), op(this, "status-pending") } catch (t) { this.a.reject(t) } return this.a }, r.load = function () { return Promise.reject(Error("MediaKeySession.load not yet supported")) }, r.update = function (t) { this.b = new ue; try { this.c.update(new Uint8Array(t)) } catch (t) { this.b.reject(t) } return this.b }, r.close = function () { try { this.c.close(), this.closed.resolve(), Oe(this.f) } catch (t) { this.closed.reject(t) } return this.closed }, r.remove = function () { return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform")) }, r.kf = function (t) { this.a && (this.a.resolve(), this.a = null), this.dispatchEvent(new be("message", { messageType: null == this.keyStatuses.a ? "license-request" : "license-renewal", message: t.message.buffer })) }, r.hf = function () { this.a ? (op(this, "usable"), this.a.resolve(), this.a = null) : this.b && (op(this, "usable"), this.b.resolve(), this.b = null) }, r.jf = function () { var t = Error("EME PatchedMediaKeysMs key error"); if (t.errorCode = this.c.error, null != this.a) this.a.reject(t), this.a = null; else if (null != this.b) this.b.reject(t), this.b = null; else switch (this.c.error.code) { case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT: case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE: op(this, "output-not-allowed"); break; default: op(this, "internal-error"); } }, (r = sp.prototype).forEach = function (t) { this.a && t(this.a, ul) }, r.get = function (t) { if (this.has(t)) return this.a }, r.has = function (a) { var e = ul; return this.a && ut(new Uint8Array(a), new Uint8Array(e)) }, r.entries = function () { }, r.keys = function () { }, r.values = function () { }, Bs(function () { !ed.HTMLVideoElement || !ed.MSMediaKeys || navigator.requestMediaKeySystemAccess && MediaKeySystemAccess.prototype.getConfiguration || (ul = new Uint8Array([0]).buffer, delete HTMLMediaElement.prototype.mediaKeys, HTMLMediaElement.prototype.mediaKeys = null, HTMLMediaElement.prototype.setMediaKeys = ap, ed.MediaKeys = np, ed.MediaKeySystemAccess = tp, navigator.requestMediaKeySystemAccess = ep) }), up.prototype.createSession = function () { }, up.prototype.setServerCertificate = function () { }, cp.prototype.getConfiguration = function () { }, cp.prototype.createMediaKeys = function () { }, Bs(function () { !ed.HTMLVideoElement || navigator.requestMediaKeySystemAccess && MediaKeySystemAccess.prototype.getConfiguration || (navigator.requestMediaKeySystemAccess = pp, delete HTMLMediaElement.prototype.mediaKeys, HTMLMediaElement.prototype.mediaKeys = null, HTMLMediaElement.prototype.setMediaKeys = lp, ed.MediaKeys = up, ed.MediaKeySystemAccess = cp) }, -10); var cl = "", fl; yp.prototype.createMediaKeys = function () { var t = new bp(this.a); return Promise.resolve(t) }, yp.prototype.getConfiguration = function () { return this.b }, (r = bp.prototype).createSession = function (a) { if ("temporary" != (a = a || "temporary") && "persistent-license" != a) throw new TypeError("Session type " + a + " is unsupported on this platform."); var n = this.b || document.createElement("video"); return n.src || (n.src = "about:blank"), a = new Tp(n, this.g, a), this.c.push(a), a }, r.setServerCertificate = function () { return Promise.resolve(!1) }, r.qf = function (a) { var e = document.createEvent("CustomEvent"); e.initCustomEvent("encrypted", !1, !1, null), e.initDataType = "webm", e.initData = a.initData, this.b.dispatchEvent(e) }, r.$f = function (a) { var n = vp(this, a.sessionId); n && (a = new be("message", { messageType: null == n.keyStatuses.a ? "licenserequest" : "licenserenewal", message: a.message }), n.b && (n.b.resolve(), n.b = null), n.dispatchEvent(a)) }, r.Yf = function (t) { (t = vp(this, t.sessionId)) && (xp(t, "usable"), t.a && t.a.resolve(), t.a = null) }, r.Zf = function (a) { var e = vp(this, a.sessionId); e && e.handleError(a) }, P(Tp, ve), (r = Tp.prototype).handleError = function (a) { var e = Error("EME v0.1b key error"); e.errorCode = a.errorCode, e.errorCode.systemCode = a.systemCode, !a.sessionId && this.b ? (e.method = "generateRequest", 45 == a.systemCode && (e.message = "Unsupported session type."), this.b.reject(e), this.b = null) : a.sessionId && this.a ? (e.method = "update", this.a.reject(e), this.a = null) : (e = a.systemCode, a.errorCode.code == MediaKeyError.MEDIA_KEYERR_OUTPUT ? xp(this, "output-restricted") : xp(this, 1 == e ? "expired" : "internal-error")) }, r.jd = function (a, e) { if (this.a) this.a.then(this.jd.bind(this, a, e)).catch(this.jd.bind(this, a, e)); else { if (this.a = a, "webkit-org.w3.clearkey" == this.c) { var t = Qe(e), d = JSON.parse(t); "oct" != d.keys[0].kty && (this.a.reject(Error("Response is not a valid JSON Web Key Set.")), this.a = null), t = ot(d.keys[0].k), d = ot(d.keys[0].kid) } else t = new Uint8Array(e), d = null; var o = fp("addKey"); try { this.f[o](this.c, t, d, this.sessionId) } catch (t) { this.a.reject(t), this.a = null } } }, r.generateRequest = function (a, e) { return Ep(this, e, null) }, r.load = function (t) { return "persistent-license" == this.g ? Ep(this, null, t) : Promise.reject(Error("Not a persistent session.")) }, r.update = function (a) { var e = new ue; return this.jd(e, a), e }, r.close = function () { if ("persistent-license" != this.g) { if (!this.sessionId) return this.closed.reject(Error("The session is not callable.")), this.closed; var t = fp("cancelKeyRequest"); try { this.f[t](this.c, this.sessionId) } catch (t) { } } return this.closed.resolve(), this.closed }, r.remove = function () { return "persistent-license" == this.g ? this.close() : Promise.reject(Error("Not a persistent session.")) }, (r = kp.prototype).forEach = function (t) { this.a && t(this.a, fl) }, r.get = function (t) { if (this.has(t)) return this.a }, r.has = function (a) { var e = fl; return this.a && ut(new Uint8Array(a), new Uint8Array(e)) }, r.entries = function () { }, r.keys = function () { }, r.values = function () { }, Bs(function () { if (!(!ed.HTMLVideoElement || navigator.requestMediaKeySystemAccess && MediaKeySystemAccess.prototype.getConfiguration)) { if (HTMLMediaElement.prototype.webkitGenerateKeyRequest) cl = "webkit"; else if (!HTMLMediaElement.prototype.generateKeyRequest) return; fl = new Uint8Array([0]).buffer, navigator.requestMediaKeySystemAccess = mp, delete HTMLMediaElement.prototype.mediaKeys, HTMLMediaElement.prototype.mediaKeys = null, HTMLMediaElement.prototype.setMediaKeys = gp, ed.MediaKeys = bp, ed.MediaKeySystemAccess = yp } }), Bs(function () { if (ed.HTMLVideoElement) { var e = HTMLVideoElement.prototype; e.requestPictureInPicture && document.exitPictureInPicture || !e.webkitSupportsPresentationMode || (document.pictureInPictureEnabled = !0, document.pictureInPictureElement = null, e.requestPictureInPicture = Ip, document.exitPictureInPicture = Ap, document.addEventListener("webkitpresentationmodechanged", Sp, !0)) } }), Bs(function () { if (ed.HTMLMediaElement) { var a = HTMLMediaElement.prototype.play; HTMLMediaElement.prototype.play = function () { var t = a.apply(this); return t && t.catch(function () { }), t } } }), Bs(function () { if (ed.HTMLVideoElement) { var e = HTMLVideoElement.prototype; !e.getVideoPlaybackQuality && "webkitDroppedFrameCount" in e && (e.getVideoPlaybackQuality = Cp) } }), Bs(function () { if (!ed.VTTCue && ed.TextTrackCue) { var e = TextTrackCue.length; if (3 == e) ed.VTTCue = _p; else if (6 == e) ed.VTTCue = wp; else { try { var t = !!_p(1, 2, "") } catch (a) { t = !1 } t && (ed.VTTCue = _p) } } }), Rp.prototype.parseInit = function () { }, Rp.prototype.parseMedia = function (b, e) { var t = Qe(b), T = [], r = new DOMParser, E = null; try { E = r.parseFromString(t, "text/xml") } catch (t) { throw new le(2, 2, 2005) } if (E) { if (!(E = E.getElementsByTagName("tt")[0])) throw new le(2, 2, 2005); var x = _r.getAttributeNS(E, "http://www.w3.org/ns/ttml#parameter", "frameRate"), k = _r.getAttributeNS(E, "http://www.w3.org/ns/ttml#parameter", "subFrameRate"), S = _r.getAttributeNS(E, "http://www.w3.org/ns/ttml#parameter", "frameRateMultiplier"), I = _r.getAttributeNS(E, "http://www.w3.org/ns/ttml#parameter", "tickRate"); if (t = E.getAttribute("xml:space") || "default", r = E.getAttribute("tts:extent"), "default" != t && "preserve" != t) throw new le(2, 2, 2005); t = "default" == t, x = new Fp(x, k, S, I), k = Lp(E.getElementsByTagName("metadata")[0]), S = Lp(E.getElementsByTagName("styling")[0]), I = Lp(E.getElementsByTagName("layout")[0]); for (var A = [], l = 0; l < I.length; l++) { var C = I[l], _ = S, v = r, w = new Gt, R = C.getAttribute("xml:id"), L, D; R ? (w.id = R, R = null, v && (R = ml.exec(v) || yl.exec(v)), v = R ? +R[1] : null, R = R ? +R[2] : null, (L = Op(C, _, "extent")) && null != (L = (D = ml.exec(L)) || yl.exec(L)) && (w.width = null == v ? +L[1] : 100 * +L[1] / v, w.height = null == R ? +L[2] : 100 * +L[2] / R, w.widthUnits = D || null != v ? 1 : 0, w.heightUnits = D || null != R ? 1 : 0), (C = Op(C, _, "origin")) && null != (L = (D = ml.exec(C)) || yl.exec(C)) && (w.viewportAnchorX = null == R ? +L[1] : 100 * +L[1] / R, w.viewportAnchorY = null == v ? +L[2] : 100 * +L[2] / v, w.viewportAnchorUnits = D || null != v ? 1 : 0)) : w = null, w && A.push(w) } for (r = Lp(E.getElementsByTagName("body")[0]), E = 0; E < r.length; E++)(l = Dp(r[E], e.periodStart, x, k, S, I, A, t)) && T.push(l) } return T }; var ml = /^(\d{1,2}|100)% (\d{1,2}|100)%$/, gl = /^(\d+px|\d+em)$/, yl = /^(\d+)px (\d+)px$/, bl = /^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/, hl = /^(?:(\d{2,}):)?(\d{2}):(\d{2})$/, vl = /^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/, Tl = /^(\d*(?:\.\d*)?)f$/, El = /^(\d*(?:\.\d*)?)t$/, xl = /^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/, kl = { left: "start", center: "center", right: "end", start: "start", end: "end" }, Sl = { left: "line-left", center: "center", right: "line-right" }; hn["application/ttml+xml"] = Rp, Vp.prototype.parseInit = function (a) { var n = !1; if (new Vr().G("moov", Kr).G("trak", Kr).G("mdia", Kr).G("minf", Kr).G("stbl", Kr).ca("stsd", Hr).G("stpp", function (t) { n = !0, t.parser.stop() }).parse(a), !n) throw new le(2, 2, 2007) }, Vp.prototype.parseMedia = function (a, i) { var t = !1, d = []; if (new Vr().G("mdat", Gr(function (a) { t = !0, d = d.concat(this.a.parseMedia(a, i)) }.bind(this))).parse(a), !t) throw new le(2, 2, 2007); return d }, hn["application/mp4; codecs=\"stpp\""] = Vp, hn["application/mp4; codecs=\"stpp.TTML.im1t\""] = Vp, Kp.prototype.parseInit = function () { }, Kp.prototype.parseMedia = function (m, e) { var t = Qe(m); if (t = (t = t.replace(/\r\n|\r(?=[^\n]|$)/gm, "\n")).split(/\n{2,}/m), !/^WEBVTT($|[ \t\n])/m.test(t[0])) throw new le(2, 2, 2e3); var g = e.segmentStart; if (null == g && (g = 0, t[0].includes("X-TIMESTAMP-MAP"))) { var y = t[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m), b = t[0].match(/MPEGTS:(\d+)/m); if (y && b) { if (null == (g = qp(new Ni(y[1])))) throw new le(2, 2, 2e3); g = e.periodStart + (+b[1] / 9e4 - g) } } b = []; var v = t[0].split("\n"); for (y = 1; y < v.length; y++)if (/^Region:/.test(v[y])) { var T = new Ni(v[y]), E = new Gt; Di(T), Oi(T); for (var x = Di(T); x;) { var k = E, S = x; (x = /^id=(.*)$/.exec(S)) ? k.id = x[1] : (x = /^width=(\d{1,2}|100)%$/.exec(S)) ? k.width = +x[1] : (x = /^lines=(\d+)$/.exec(S)) ? (k.height = +x[1], k.heightUnits = 2) : (x = /^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(S)) ? (k.regionAnchorX = +x[1], k.regionAnchorY = +x[2]) : (x = /^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(S)) ? (k.viewportAnchorX = +x[1], k.viewportAnchorY = +x[2]) : /^scroll=up$/.exec(S) && (k.scroll = "up"), Oi(T), x = Di(T) } b.push(E) } for (y = [], T = 1; T < t.length; T++) { if (x = v = t[T].split("\n"), S = g, v = b, 1 == x.length && !x[0] || /^NOTE($|[ \t])/.test(x[0]) || "STYLE" == x[0]) v = null; else { E = null, x[0].includes("-->") || (E = x[0], x.splice(0, 1)); var I = qp(k = new Ni(x[0])), h = Li(k, /[ \t]+--\x3e[ \t]+/g), d = qp(k); if (null == I || null == h || null == d) throw new le(2, 2, 2001); for (x = new Ht(I + S, d + S, x.slice(1).join("\n").trim()), Oi(k), S = Di(k); S;)Hp(x, S, v), Oi(k), S = Di(k); null != E && (x.id = E), v = x } v && y.push(v) } return y }, hn["text/vtt"] = Kp, hn["text/vtt; codecs=\"vtt\""] = Kp, zp.prototype.parseInit = function (a) { var e = !1; if (new Vr().G("moov", Kr).G("trak", Kr).G("mdia", Kr).ca("mdhd", function (t) { 0 == t.version ? (t.reader.J(4), t.reader.J(4), this.a = t.reader.D(), t.reader.J(4)) : (t.reader.J(8), t.reader.J(8), this.a = t.reader.D(), t.reader.J(8)), t.reader.J(4) }.bind(this)).G("minf", Kr).G("stbl", Kr).ca("stsd", Hr).G("wvtt", function () { e = !0 }).parse(a), !this.a) throw new le(2, 2, 2008); if (!e) throw new le(2, 2, 2008) }, zp.prototype.parseMedia = function (d, e) { var t = this; if (!this.a) throw new le(2, 2, 2008); var n = 0, p = [], m = [], o = !1, g = !1, y = !1, b = null, v; if (new Vr().G("moof", Kr).G("traf", Kr).ca("tfdt", function (t) { o = !0, n = 0 == t.version ? t.reader.D() : t.reader.ub() }).ca("tfhd", function (a) { var n = a.flags; (a = a.reader).J(4), 1 & n && a.J(8), 2 & n && a.J(4), b = 8 & n ? a.D() : null }).ca("trun", function (a) { g = !0; var d = a.version, t = a.flags, n = (a = a.reader).D(); 1 & t && a.J(4), 4 & t && a.J(4); for (var r = [], i = 0, l; i < n; i++)l = { duration: null, sampleSize: null, ld: null }, 256 & t && (l.duration = a.D()), 512 & t && (l.sampleSize = a.D()), 1024 & t && a.J(4), 2048 & t && (l.ld = 0 == d ? a.D() : a.Vd()), r.push(l); p = r }).G("mdat", Gr(function (t) { y = !0, v = t })).parse(d), !y && !o && !g) throw new le(2, 2, 2008); var T = n, E = new jr(new DataView(v.buffer, v.byteOffset, v.byteLength), 0); return p.forEach(function (i) { var d = i.duration || b, r = i.ld ? n + i.ld : T; T = r + (d || 0); var a = 0; do { var o = E.D(); a += o; var p = null; "vttc" == Wr(E.D()) ? 8 < o && (p = E.Va(o - 8)) : E.J(o - 8), d && p && m.push(Gp(p, e.periodStart + r / t.a, e.periodStart + T / t.a)) } while (i.sampleSize && a < i.sampleSize) }), m.filter(Ot.Da) }, hn["application/mp4; codecs=\"wvtt\""] = zp, D("shaka.util.Dom.createHTMLElement", function (t) { return document.createElement(t) }), D("shaka.util.Dom.createVideoElement", function () { var t = document.createElement("video"); return t.muted = !0, t.width = 600, t.height = 400, t }), D("shaka.util.Dom.asHTMLElement", function (t) { return t }), D("shaka.util.Dom.asHTMLMediaElement", function (t) { return t }), D("shaka.util.Dom.removeAllChildren", function (t) { for (; t.firstChild;)t.removeChild(t.firstChild) }) }.call(e, t, t), e.shaka) i[a] = e.shaka[a] }() }, 142: function (T, e, t) { "use strict"; function n() { return { decode: function (t) { if (!t) return ""; if ("string" != typeof t) throw new Error("Error - expected string data."); return decodeURIComponent(encodeURIComponent(t)) } } } function m() { this.values = Object.create(null) } function y(a, d, s) { function t() { var e = function (a) { function e(a, e, t, n) { return 3600 * (0 | a) + 60 * (0 | e) + (0 | t) + (0 | n) / 1e3 } var t = a.match(i); return t ? t[3] ? e(t[1], t[2], t[3].replace(":", ""), t[4]) : 59 < t[1] ? e(t[1], t[2], 0, t[4]) : e(0, t[1], t[2], t[4]) : null }(a); if (null === e) throw new Error("Malformed timestamp: " + p); return a = a.replace(o, ""), e } function n() { a = a.replace(c, "") } var p = a; if (n(), d.startTime = t(), n(), "-->" !== a.substr(0, 3)) throw new Error("Malformed time stamp (time stamps must be separated by '-->'): " + p); a = a.substr(3), n(), d.endTime = t(), n(), function (n, e) { var d = new m; !function (d, e, t, n) { for (var r = n ? d.split(n) : [d], i = 0; i <= r.length; i += 1)if ("string" == typeof r[i]) { var s = r[i].split(t); 2 === s.length && e(s[0], s[1]) } }(n, function (n, e) { switch (n) { case "region": for (var t = s.length - 1; 0 <= t; t--)if (s[t].id === e) { d.set(n, s[t].region); break } break; case "vertical": d.alt(n, e, ["rl", "lr"]); break; case "line": var r = e.split(","), a = r[0]; d.integer(n, a), d.percent(n, a) && d.set("snapToLines", !1), d.alt(n, a, ["auto"]), 2 === r.length && d.alt("lineAlign", r[1], ["start", g, "end"]); break; case "position": var o = e.split(","); d.percent(n, o[0]), 2 === o.length && d.alt("positionAlign", o[1], ["start", g, "end", "line-left", "line-right", "auto"]); break; case "size": d.percent(n, e); break; case "align": d.alt(n, e, ["start", g, "end", "left", "right"]); } }, u, l), e.region = d.get("region", null), e.vertical = d.get("vertical", ""); var t = d.get("line", "auto"); "auto" === t && -1 === f.line && (t = -1), e.line = t, e.lineAlign = d.get("lineAlign", "start"), e.snapToLines = d.get("snapToLines", !0), e.size = d.get("size", 100), e.align = d.get("align", g); var r = d.get("position", "auto"); "auto" === r && 50 === f.position && (r = "start" === e.align || "left" === e.align ? 0 : "end" === e.align || "right" === e.align ? 100 : 50), e.position = r }(a, d) } t.r(e); var E = t(49), r = t(75), i = /^(\d+):(\d{2})(:\d{2})?\.(\d{3})/, a = /^-?\d+$/, x = /\r\n|\n/, s = /^NOTE($|[ \t])/, o = /^[^\sa-zA-Z-]+/, u = /:/, l = /\s/, c = /^\s+/, k = /-->/, d = /^WEBVTT([ \t].*)?$/, p = function (a, e) { this.window = a, this.state = "INITIAL", this.buffer = "", this.decoder = e || new n, this.regionList = [], this.maxCueBatch = 1e3 }; m.prototype = { set: function (a, e) { this.get(a) || "" === e || (this.values[a] = e) }, get: function (a, e, t) { return t ? this.has(a) ? this.values[a] : e[t] : this.has(a) ? this.values[a] : e }, has: function (t) { return t in this.values }, alt: function (a, e, t) { for (var n = 0; n < t.length; ++n)if (e === t[n]) { this.set(a, e); break } }, integer: function (n, e) { a.test(e) && this.set(n, parseInt(e, 10)) }, percent: function (a, e) { return 0 <= (e = parseFloat(e)) && 100 >= e && (this.set(a, e), !0) } }; var f = new r.a(0, 0, 0), g = "middle" === f.align ? "middle" : "center"; p.prototype = { parse: function (i, p) { function e() { for (var a = o.buffer, e = 0; e < a.length && "\r" !== a[e] && "\n" !== a[e];)++e; var i = a.substr(0, e); return "\r" === a[e] && ++e, "\n" === a[e] && ++e, o.buffer = a.substr(e), i } function t() { "CUETEXT" === o.state && o.cue && o.oncue && o.oncue(o.cue), o.cue = null, o.state = "INITIAL" === o.state ? "BADWEBVTT" : "BADCUE" } var o = this, a; i && (o.buffer += o.decoder.decode(i, { stream: !0 })); try { if ("INITIAL" === o.state) { if (!x.test(o.buffer)) return this; var l = (a = e()).match(d); if (!l || !l[0]) throw new Error("Malformed WebVTT signature."); o.state = "HEADER" } } catch (a) { return t(), this } var c = !1, m = 0; !function n() { try { for (; o.buffer && m <= o.maxCueBatch;) { if (!x.test(o.buffer)) return o.flush(), this; switch (c ? c = !1 : a = e(), o.state) { case "HEADER": u.test(a) || a || (o.state = "ID"); break; case "NOTE": a || (o.state = "ID"); break; case "ID": if (s.test(a)) { o.state = "NOTE"; break } if (!a) break; if (o.cue = new r.a(0, 0, ""), o.state = "CUE", !k.test(a)) { o.cue.id = a; break } case "CUE": try { y(a, o.cue, o.regionList) } catch (t) { o.cue = null, o.state = "BADCUE"; break } o.state = "CUETEXT"; break; case "CUETEXT": var i = k.test(a); if (!a || i && (c = !0)) { o.oncue && (m += 1, o.oncue(o.cue)), o.cue = null, o.state = "ID"; break } o.cue.text && (o.cue.text += "\n"), o.cue.text += a; break; case "BADCUE": a || (o.state = "ID"); } } if (m = 0, o.buffer) Object(E.b)(n); else if (!p) return o.flush(), this } catch (a) { return t(), this } }() }, flush: function () { try { if (this.buffer += this.decoder.decode(), (this.cue || "HEADER" === this.state) && (this.buffer += "\n\n", this.parse(void 0, !0)), "INITIAL" === this.state) throw new Error("Malformed WebVTT signature.") } catch (t) { throw t } return this.onflush && this.onflush(), this } }, e.default = p }, 161: function (U, e, t) { "use strict"; function n() { } function s(t) { this._service = t } function l(a) { var e = H.Browser.safari ? "center" : "middle", t = new i.a(a.startTime, a.endTime, a.payload); return t.align = "center" === a.textAlign ? e : a.textAlign, t.lineAlign = "center" === a.lineAlign ? e : a.lineAlign, t.size = a.size, null !== a.line && (t.line = a.line), null !== a.position && (t.position = a.position), t } function f(t) { return (f = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t })(t) } function B(a, e) { for (var t = 0, i; t < e.length; t++)i = e[t], i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(a, i.key, i) } function y(a, e) { return e && ("object" === f(e) || "function" == typeof e) ? e : function (t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t }(a) } function g(t) { return (g = Object.setPrototypeOf ? Object.getPrototypeOf : function (t) { return t.__proto__ || Object.getPrototypeOf(t) })(t) } function j(a, e) { return (j = Object.setPrototypeOf || function (a, e) { return a.__proto__ = e, a })(a, e) } function F(a, p, S) { function n() { ye.addEventListener("error", b), ye.addEventListener("trackschanged", Y), ye.addEventListener("adaptation", function () { ge.pollAdaptation = !0 }), Object(V.j)(l, function (a, e) { S.addEventListener(e, a) }), ge.service.on("cues", me), be.start() } function i(t, e) { return Object(v.a)(t, p.qualityLabels, e) } function g() { ye && (ye.removeEventListener("error", b), ye.removeEventListener("trackschanged", Y)), Object(V.j)(l, function (a, e) { S.removeEventListener(e, a) }), ge.service && ge.service.off("cues", me), be.stop() } function e() { if (f = null, g(), ye) { var a = ye.getNetworkingEngine(); a.clearAllRequestFilters(), a.clearAllResponseFilters(), ye = null } if (ge.service) { var e = ge.service.destroy(); return ge.service = null, e } } function t() { ge.seeking ? ge.setState(T.ob) : ge.state === T.qb && (ge.stallTime = S.currentTime, ge.setState(T.rb)) } function b(n) { if (!(S.src || S.played && S.played.length)) return ge.destroy(), void (ye = w(S)); var e = n.detail ? n.detail : n, t = function (a) { var e = a.category, t = a.code, n = a.data, r = a.severity !== O, i = r ? 240000 : 340000, d = r ? N.o : null; if (r) switch (t) { case Q: i = 241004; break; case J: var p = Object(L.b)(240000, n[1], n[0]); i = p.code, d = p.key; break; case $: var u = Object(L.b)(240000, 0, n[0]); i = u.code, d = u.key; break; case Z: i = 241001; break; case ee: i = 244604; break; case te: i = 244000, 1 < n[0] && 5 > n[0] && (i += n[0] - 1); break; case ae: i = 242601; break; case ne: d = N.n, i = 242632; break; case ie: i = 242635; break; case re: case de: i = 241005; break; default: H.Browser.ie && a.message && 0 === a.message.indexOf("Access is denied.") ? i = 241012 : e === G ? i = 242600 : e === q ? i = 241000 : e === z ? i = 244000 : e === X ? i = 249000 : e === W && (i = 246000); }return { key: d, code: i, fatal: r, changeLevel: t === ee } }(e), i = t.key, a = t.code, r = t.fatal, d = t.changeLevel; if (r) { if (d) { var o = function () { var a = Object(V.n)(ge.shakaLevels, { active: !0 }); if (a) for (var e = 0; e < ge.jwLevels.length; e += 1)if (a.id === ge.jwLevels[e].shakaId) return e; return null }(); if (se(o, ge.jwLevels)) return void fe(o) } ce(), ge.trigger(T.G, new N.s(i, a, e)) } else ge.trigger(T.ub, new N.s(null, a, e)) } function w(a) { var e = new d.a.Player(a); return ge.service = new u(e, a), ge.adaptationId = -1, ge.adaptationTs = -1, e } function D(t) { S.textTracks && (t && t.length && ge.setupSideloadedTracks(t), ge.setTextTracks(S.textTracks)) } function M(a) { he = a.sources[0].drm || {}, ge.service.setLoadedItem(a), ge.clearTracks(), ge.setupSideloadedTracks(a.tracks), ge.on(T.D, function () { S && 1 === S.readyState && 0 < S.buffered.length && S.currentTime < S.buffered.start(0) && setTimeout(function () { S.currentTime = S.buffered.start(0) }, 0) }); var e = ye.getNetworkingEngine(); e.clearAllRequestFilters(), e.clearAllResponseFilters(), (a.withCredentials || p.withCredentials) && e.registerRequestFilter(U); var r = he.widevine ? he.widevine.serverCertificateUrl : void 0; return r ? new Promise(function (e, d) { Object(k.a)({ url: r, responseType: "arraybuffer" }, function (t) { return B(a, t).then(e) }, function (a, e, t, n) { return d(n) }) }) : B(a) } function U(a, e) { e.allowCrossSiteCredentials = !0 } function B() { var t = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : { sources: [] }, n = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {}, r; n.response && (r = new Uint8Array(n.response)); var d = be.getEstimate(); ge.service.setup(function (o) { var e = {}, r = "", p, l; if (he.clearkey && Object(h.c)("clearkey")) return (l = he.clearkey).keyId = l.keyId ? l.keyId.replace(/-/g, "") : null, e.clearKeys = {}, e.clearKeys[l.keyId] = l.key, e; if (he.widevine && Object(h.c)("widevine")) ge.drmUsed = "widevine", p = "com.widevine.alpha", r = "http://widevine-proxy.appspot.com/proxy"; else { if (!he.playready || !Object(h.c)("playready")) return e; ge.drmUsed = "playready", p = "com.microsoft.playready", r = "http://microsoft-proxy.appspot.com/proxy" } if (!(l = he[ge.drmUsed])) return e; o && (e.advanced = {}, e.advanced[p] = { serverCertificate: o }), e.servers = e.servers || {}, e.servers[p] = l.url || r; var m = ye.getNetworkingEngine(), a = d.a.net.NetworkingEngine.RequestType.LICENSE, s = l, u = s.licenseRequestFilter, c = s.licenseResponseFilter; return m.registerRequestFilter(function (n, i) { if (n === a) { try { Object.defineProperties(i, { open: { get: function () { return function (t, e) { i.uris = [t], i.method = e } }, enumerable: !0 }, setRequestHeader: { get: function () { return function (t, e) { i.headers[t] = e } }, enumerable: !0 }, withCredentials: { get: function () { return i.allowCrossSiteCredentials }, set: function (t) { i.allowCrossSiteCredentials = t }, enumerable: !0 } }) } catch (t) { } if (function (a, i) { [].concat(a.headers || []).concat(a.licenseRequestHeaders || []).forEach(function (t) { i.headers[t.name] = t.value }); var e = a.customData; e && (i.headers.customData = e) }(l, i), "function" == typeof u) return u.call(ye, i, ye.drmInfo()) } }), m.registerResponseFilter(function (n, e) { return n === a ? "function" == typeof c ? c.call(ye, e, ye.drmInfo()) : void 0 : void 0 }), e }(r), p.selectedCaptionCode || Object(x.b)(p.captionLabel), d, m); var i = t.sources[0].file; return (t.starttime ? ye.load(i, t.starttime) : ye.load(i)).then(function () { ge.livePausedItem = null, f = null, ge.state === T.nb && ye && ye.isLive() && ue() }).catch(b) } function j(r) { if (se(r, ge.jwLevels)) { ge.service.enableAbr(!1); var e = ge.jwLevels[r].shakaId, t = Object(V.n)(ge.shakaLevels, { id: e }); if (t) { var n = t.bandwidth > m, i = t.language !== ve; m = t.bandwidth, ye.selectVariantTrack(t, n || i) } var a = 0 === r; ge.service.enableAbr(a), a || (ge.pollAdaptation = !0) } } function F(a) { var e = ge.audioTracks[a || pe()]; if (e) { var t = ge.shakaAudioTracks[e.shakaIndex]; t && (ve = t.language, ye.selectAudioLanguage(ve), fe(ge.currentQuality)) } } function Y() { var r = ye.getTextTracks(); ge._tracksById && r.length === Object.keys(ge._tracksById).length || (r = r.filter(function (t) { return "Shaka Player TextTrack" !== t.label }).map(function (a) { var e = a; return e.kind = (e.kind || "subtitles").replace(/^(.+[^s])$/, "$1s"), e.embedded = !0, e.label = Object(x.d)(e.language), e.source = "currentTime", e }), ge.addTextTracks(r)); var d = ye.getVariantTracks(), t = Object(V.n)(d, { active: !0 }), n = Object(V.o)(d, "language"), i = "video"; if (ge.tracksByLang = n, Object(V.H)(n) && t) { oe(n[t.language]); var p = 0; if (!ge.service.abrEnabled()) { var l = ge.service.getVariantHistory(); if (l.length) { var s = l[0].id, u = Object(V.n)(ge.jwLevels, { shakaId: s }); p = ge.jwLevels.indexOf(u) } } ge.currentQuality = Math.max(0, p), j(ge.currentQuality), ge.trigger(T.I, { levels: ge.jwLevels, currentQuality: ge.currentQuality }), function (a, e) { var t = Object(V.m)(a[e], function (t) { return t.active }), n = []; Object.keys(a).forEach(function (i) { i === e ? n.push(t) : n.push(a[i][0]) }), Array.isArray(n) && le(n), ge.trigger(T.f, { tracks: ge.audioTracks, currentTrack: ge.currentAudioIndex }) }(n, t.language), F(ge.currentAudioIndex), -1 < t.mimeType.indexOf("audio") && (i = "audio"), ge.trigger(T.T, { mediaType: i }) } } function oe(a) { ge.shakaLevels = a, ge.shakaLevels.sort(function (a, e) { return a.height < e.height || a.bandwidth < e.bandwidth ? 1 : -1 }); var r = Object(v.b)(ge.shakaLevels); ge.jwLevels = ge.shakaLevels.reduce(function (t, e) { return t.push({ shakaId: e.id, bitrate: e.bandwidth, label: i(e, r), height: e.height, width: e.width }), t }, []), 1 < ge.shakaLevels.length && ge.jwLevels.unshift({ label: "Auto", shakaId: "auto" }) } function se(a, e) { return Object(V.w)(a) && !Object(V.v)(a) && 0 <= a && a < Object(V.H)(e) } function pe() { return se(ge.currentAudioIndex, ge.audioTracks) ? ge.currentAudioIndex : -1 } function le(a) { var r, e; Array.isArray(a) && (ge.shakaAudioTracks = a, ge.audioTracks = (r = a).map(function (t, e) { var n = t.language, i = 1 < Object(V.K)(r, { language: n }).length, a = Object(x.d)(n); return "und" === n ? a = "Unknown" : "dv" === n && (a = "Audio Description"), i && (a += " (" + Object(v.c)(t.bandwidth) + " kbps)"), { autoselect: !1, defaulttrack: !!t.active, groupid: "default", language: t.language, name: a, shakaIndex: e, shakaId: t.id } }), ge.currentAudioIndex = se(ge.currentAudioIndex, ge.audioTracks) ? ge.currentAudioIndex : ((e = Object(V.m)(ge.audioTracks, function (t) { return t.defaulttrack && "dv" !== t.language })) || (e = Object(V.m)(ge.audioTracks, function (t) { return "dv" !== t.language })), e ? e.shakaIndex : 0)) } function ue() { ge.livePausedItem = ge.service.loadedItem, ge.service.unload() } function ce() { g(), ge.service && ge.service.setLoadedItem(null), f = null } function fe(t) { ge.tracksByLang && ge.audioTracks && oe(ge.tracksByLang[ge.audioTracks[ge.currentAudioIndex].language]), j(t), ge.currentQuality = t } function me(r) { var e = ye.getTextTracks(), t = ge.getSubtitlesTrack(); if (0 > t) { var d = Object(V.n)(e, { active: !0 }); t = Object(V.q)(e, d) } var i = e[t]; if (i) { var a = Object(V.n)(ge._tracksById, { language: i.language }), s; s = a ? a._id : "".concat(i.kind, "s").concat(t), r.forEach(function (t) { ge.renderNatively && (t.align = "center"), ge.addVTTCue({ type: "".concat(i.kind, "s"), cue: t, track: s }) }) } return [] } var ge = this, l = {}, f = null, ye = null, be = Object(R.a)(this, p.bandwidthEstimate), m = p.bitrateSelection, he, ve, Te; ge.video = S, ge.drmUsed = null, ge.position = 0, ge.levels = [], ge.currentQuality = -1, ge.supportsPlaybackRate = !0, ge.service = null, ge.adaptationId = -1, ge.adaptationTs = -1, ge.pollAdaptation = !1, ge.livePausedItem = null, ge.jwLevels = [], ge.state = T.nb, Object(V.j)(I.a, function (a, e) { l[e] = a.bind(ge) }), ge.checkAdaptation = function () { var l = S.videoWidth, e = S.videoHeight, t = ye.getStats(), n = t.width, a = t.height; ge.shakaLevels || Y(); var i = ge.service.getVariantHistory(ge.adaptationTs); if (i.length) { var r = -1 === ge.adaptationTs, o = Object(V.m)(ge.jwLevels, function (t) { return i.some(function (a) { var n = a.id === t.shakaId && (t.width === l && t.height === e || null === t.width); return n && (ge.adaptationTs = a.timestamp), n }) }); if (o && o.shakaId !== ge.adaptationId) { ge.adaptationId = o.shakaId, ge.pollAdaptation = !1; var s = ge.jwLevels.indexOf(o), u = o.label, c = o.bitrate, d = ge.service.abrEnabled(), p = d ? "auto" : "manual", f = d ? "auto" : "api"; r && (f = "initial choice"), ge.trigger(T.U, { level: { index: s, label: u, bitrate: c, width: n, height: a }, bandwidth: t.estimatedBandwidth, mode: p, reason: f }) } } else ge.pollAdaptation = !1 }, Object(V.k)(ge, c.a, A.a, _.a, P.a, { seeking: !1, eventsOn_: function () { ye || (ye = w(S)), n() }, eventsOff_: function () { return he && H.Browser.firefox ? void (ge.remove(), ge.setContainer(ge.container)) : e() }, init: function () { ge.currentAudioIndex = -1, ge.adaptationId = -1, ge.adaptationTs = -1 }, preload: function (a) { var e = "auto" === a.preload ? K.a : K.b; ye || (ye = w(S)), ge.service.setMaxBuffer(e), g(), n(), f = M(a) }, load: function (t) { return g(), ye && S.src || (ge.destroy(), ye = w(S), ge.service.setLoadedItem(null)), (n(), ge.service.setMaxBuffer(K.a), ge.setState(T.ob), ge.service.getLoadedItem() !== t) ? (ge.adaptationId = -1, ge.adaptationTs = -1, ge.drmUsed = null, f = M(t), S.play(), f) : (D(t.tracks), f) }, pause: function () { ye && ye.isLive() && !ge.service.isDvr() && !ge.livePausedItem && (ue(), ge.setState(T.pb)), S.pause() }, getQualityLevels: function () { return Object(V.B)(ge.jwLevels, function (t) { return Object(r.a)(t) }) }, getCurrentQuality: function () { return ge.currentQuality }, getAudioTracks: function () { return Array.isArray(ge.audioTracks) ? ge.audioTracks : [] }, getCurrentAudioTrack: pe, play: function () { var t = ge.livePausedItem; return t && (ge.livePausedItem = null, ge.load(t)), S.play() || Object(C.a)(S) }, seek: function (r) { var e = ye.seekRange().end, t = ye.seekRange().start, n = 0 > r ? e - t + r : r; ge.trigger(T.Q, { position: ge.service.getCurrentTime(), offset: n }), ge.seeking = !0, ge.service.seek(r); var i = ge.service.getDuration(); if (0 !== i && i !== 1 / 0 && Object(V.A)(i)) { var a = this.video.currentTime; ge.trigger(T.S, { position: ge.getCurrentTime(), duration: i, currentTime: a, seekRange: ge.getSeekRange(), metadata: { currentTime: a } }) } }, setCurrentQuality: function (t) { se(t, ge.jwLevels) && t !== ge.currentQuality && (fe(t), ge.trigger(T.J, { currentQuality: t, levels: ge.jwLevels })) }, setAudioTracks: function (t) { Array.isArray(t) && (le(t), ge.trigger(T.f, { tracks: ge.audioTracks, currentTrack: ge.currentAudioIndex })) }, setCurrentAudioTrack: function (a) { var e; se(a, ge.audioTracks) && (e = a, ge.currentAudioIndex = e, se(e, ge.audioTracks) && F(ge.currentAudioIndex), ge.trigger(T.f, { tracks: ge.audioTracks, currentTrack: a }), ge.trigger(T.g, { tracks: ge.audioTracks, currentTrack: a })) }, setPlaybackRate: function (t) { ge.service && ge.service.setPlaybackRate(t) }, getPlaybackRate: function () { return ge.service ? ge.service.getPlaybackRate() : 1 }, isLive: function () { return !!ge.service && ge.service.isLive() }, getCurrentTime: function () { return ge.service ? ge.service.getCurrentTime() : 0 }, getDuration: function () { return ge.service ? ge.service.getDuration() : 0 }, getSeekRange: function () { return ge.service ? ge.service.getSeekRange() : { start: 0, end: 0 } }, getLiveLatency: function () { var a = null, n = this.service.getSeekRange().end; return ge.isLive() && n && (a = n - S.currentTime), a }, setVisibility: function (t) { (t = !!t) ? Object(E.d)(ge.container, { visibility: "visible", opacity: 1 }) : Object(E.d)(ge.container, { visibility: "", opacity: 0 }) }, stop: function () { ce(), S.pause(), ge.setState(T.nb) }, setShakaPlayer: function (t) { ye = t }, destroy: e, supportsFullscreen: Object(V.d)(!0), getName: Object(V.d)({ name: "shaka" }), renderNatively: (Te = p.renderCaptionsNatively, H.Browser.chrome && Te), setSubtitlesTrack: function (t) { P.a.setSubtitlesTrack.call(ge, t); var e = ye.getTextTracks()[t - 1]; ge.renderNatively || (ge._currentTextTrackIndex = t - 1), e && (ye.selectTextLanguage(e.language), p.selectedCaptionCode = e.language), fe(ge.currentQuality) }, getBandwidthEstimate: function () { if (ye) return ye.getStats().estimatedBandwidth } }), l.loadeddata = function () { ge.checkAdaptation(), [].forEach.call(S.textTracks, function (t) { if ("Shaka Player TextTrack" === t.label) return t.inuse = !1, t.mode = "hidden", void (t.embedded = !0) }), I.a.loadeddata.call(ge) }, l.timeupdate = function () { ge.pollAdaptation && ge.checkAdaptation(), I.a.timeupdate.call(ge) }, l.waiting = t, l.ratechange = function () { if (0 === S.playbackRate && 0 !== S.defaultPlaybackRate) { if (.4 > S.duration - S.currentTime) return void I.a.ended.call(ge); t() } else I.a.ratechange.call(ge) } } t.r(e); var V = t(0), r = t(87), K = t(137), a = t(142); n.prototype.parseInit = function () { }, n.prototype.parseMedia = function (n) { var e = function (a) { var e = "", i; if (!a) return ""; 239 === (i = new Uint8Array(a))[0] && 187 === i[1] && 191 === i[2] && (i = i.subarray(3)); for (var d = 0; d < i.length; d += 65535)e += String.fromCharCode.apply(null, i.subarray(d, d + 65535)); return window.decodeURIComponent(window.escape(e)) }(n); return function (i) { var e = new a.default(window), t = []; return e.oncue = function (a) { t.push(a) }, e.parse(i), t }(e = e.replace(/\r\n|\r(?=[^\n]|$)/gm, "\n")) }; var i = t(75), H = t(5); s.prototype.append = function (t) { t.length && (t[0].payload && (t = t.map(l)), this._service.trigger("cues", t)) }, s.prototype.remove = function () { return !0 }, s.prototype.isTextVisible = function () { return !0 }, s.prototype.setTextVisibility = function () { }, s.prototype.destroy = function () { return Promise.resolve() }; var c = t(9), o = t(140), d = t.n(o), p = t(78); d.a.polyfill.installAll(), d.a.text.TextEngine.registerParser("text/vtt", n), d.a.text.TextEngine.registerParser("text/vtt; codecs=\"vtt\"", n); var u = function (a) { function d(t, e) { var a; return function (a, e) { if (!(a instanceof e)) throw new TypeError("Cannot call a class as a function") }(this, d), (a = y(this, g(d).call(this))).shakaPlayer = t, a.videoTag = e, a.loadedItem = null, a.streamType = "VOD", a } var e, t, r; return function (a, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); a.prototype = Object.create(e && e.prototype, { constructor: { value: a, writable: !0, configurable: !0 } }), e && j(a, e) }(d, a), e = d, (t = [{ key: "setup", value: function (a, e, t, r) { var i = this, d = !Object(V.A)(r); d || (t = r / this.shakaPlayer.getConfiguration().abr.bandwidthDowngradeTarget), this.shakaPlayer.configure({ abr: { enabled: d, defaultBandwidthEstimate: t }, drm: a, preferredTextLanguage: e, streaming: { rebufferingGoal: K.b }, textDisplayFactory: function () { return new s(i) } }) } }, { key: "enableAbr", value: function (t) { this.shakaPlayer.configure({ abr: { enabled: !!t } }) } }, { key: "abrEnabled", value: function () { return this.shakaPlayer.getConfiguration().abr.enabled } }, { key: "setMaxBuffer", value: function (t) { this.shakaPlayer.configure({ streaming: { bufferingGoal: t } }) } }, { key: "setPlaybackRate", value: function (t) { this.videoTag.playbackRate = this.videoTag.defaultPlaybackRate = t, this.shakaPlayer && this.shakaPlayer.trickPlay(t) } }, { key: "seek", value: function (a) { if ("LIVE" !== this.streamType) { var e = this.shakaPlayer.seekRange().end; this.videoTag.currentTime = 0 > a ? e + a : a } } }, { key: "getPlaybackRate", value: function () { return this.shakaPlayer ? this.shakaPlayer.getPlaybackRate() || 1 : this.videoTag.playbackRate } }, { key: "isLive", value: function () { return this.shakaPlayer.isLive() } }, { key: "isDvr", value: function () { return "DVR" === this.streamType } }, { key: "getCurrentTime", value: function () { var t = this.videoTag.currentTime; return this.shakaPlayer.isLive() && "DVR" === this.streamType && (t -= this.shakaPlayer.seekRange().end), t } }, { key: "getDuration", value: function () { var a = this.loadedItem, e = this.shakaPlayer, t = this.videoTag.duration; if (!a) return t; var d = a.minDvrWindow; if (this.shakaPlayer.isLive()) { var r = e.seekRange(); t = r.start - r.end, t = Object(p.a)(t, d) ? t : 1 / 0 } return this.streamType = Object(p.b)(t, d), t } }, { key: "getLoadedItem", value: function () { return this.loadedItem } }, { key: "getSeekRange", value: function () { return this.shakaPlayer.seekRange() } }, { key: "getVariantHistory", value: function (a) { return a = a || 0, this.shakaPlayer.getStats().switchHistory.filter(function (e) { return "variant" === e.type && e.timestamp > a }) } }, { key: "setLoadedItem", value: function (t) { this.loadedItem = t, this.streamType = "VOD" } }, { key: "unload", value: function () { this.loadedItem = null, this.shakaPlayer.unload() } }, { key: "destroy", value: function () { return window.VTTCue = i.a, this.loadedItem = null, this.shakaPlayer.destroy() } }]) && B(e.prototype, t), r && B(e, r), d }(c.a), h = t(36), v = t(138), T = t(3), E = t(11), x = t(14), k = t(28), S = t(57), I = t(111), A = t(112), _ = t(113), P = t(83), C = t(74), R = t(139), N = t(1), L = t(114), D = d.a.util.Error, O = D.Severity.RECOVERABLE, M = D.Category, q = M.NETWORK, z = M.MEDIA, G = M.MANIFEST, X = M.PLAYER, W = M.DRM, Y = D.Code, Q = Y.UNSUPPORTED_SCHEME, J = Y.BAD_HTTP_STATUS, $ = Y.HTTP_ERROR, Z = Y.TIMEOUT, ee = Y.MP4_SIDX_WRONG_BOX_TYPE, te = Y.VIDEO_ERROR, ae = Y.DASH_INVALID_XML, ne = Y.CONTENT_UNSUPPORTED_BY_BROWSER, ie = Y.RESTRICTIONS_CANNOT_BE_MET, re = Y.REQUEST_FILTER_ERROR, de = Y.RESPONSE_FILTER_ERROR; Object(V.k)(F.prototype, S.a), F.getName = Object(V.d)({ name: "shaka" }), e.default = F }, 72: function (d, e, t) { "use strict"; function n(a) { var r = [], t = (a = Object(p.i)(a)).split("\r\n\r\n"); 1 === t.length && (t = a.split("\n\n")); for (var d = 0; d < t.length; d++)if ("WEBVTT" !== t[d]) { var l = s(t[d]); l.text && r.push(l) } return r } function s(r) { var e = {}, t = r.split("\r\n"); 1 === t.length && (t = r.split("\n")); var d = 1; if (0 < t[0].indexOf(" --> ") && (d = 0), t.length > d + 1 && t[d + 1]) { var s = t[d], a = s.indexOf(" --> "); 0 < a && (e.begin = Object(p.g)(s.substr(0, a)), e.end = Object(p.g)(s.substr(a + 5)), e.text = t.slice(d + 1).join("\r\n")) } return e } t.d(e, "a", function () { return n }); var p = t(2) }, 74: function (a, e, t) { "use strict"; function n(i) { return new Promise(function (s, t) { if (i.paused) return t(d("NotAllowedError", 0, "play() failed.")); var n = function () { i.removeEventListener("play", e), i.removeEventListener("playing", a), i.removeEventListener("pause", a), i.removeEventListener("abort", a), i.removeEventListener("error", a) }, e = function () { i.addEventListener("playing", a), i.addEventListener("abort", a), i.addEventListener("error", a), i.addEventListener("pause", a) }, a = function (i) { if (n(), "playing" === i.type) s(); else { var e = "The play() request was interrupted by a \"".concat(i.type, "\" event."); "error" === i.type ? t(d("NotSupportedError", 9, e)) : t(d("AbortError", 20, e)) } }; i.addEventListener("play", e) }) } function d(a, e, t) { var n = new Error(t); return n.name = a, n.code = e, n } t.d(e, "a", function () { return n }) }, 75: function (a, e) { "use strict"; function n(t) { return !("string" != typeof t) && !!{ start: !0, middle: !0, end: !0, left: !0, right: !0 }[t.toLowerCase()] && t.toLowerCase() } var t = window.VTTCue; t || ((t = function (i, e, t) { var g = this; g.hasBeenReset = !1; var r = "", b = !1, T = i, E = e, x = t, k = null, S = "", I = !0, A = "auto", C = "start", _ = "auto", w = 100, R = "middle"; Object.defineProperty(g, "id", { enumerable: !0, get: function () { return r }, set: function (t) { r = "" + t } }), Object.defineProperty(g, "pauseOnExit", { enumerable: !0, get: function () { return b }, set: function (t) { b = !!t } }), Object.defineProperty(g, "startTime", { enumerable: !0, get: function () { return T }, set: function (t) { if ("number" != typeof t) throw new TypeError("Start time must be set to a number."); T = t, this.hasBeenReset = !0 } }), Object.defineProperty(g, "endTime", { enumerable: !0, get: function () { return E }, set: function (t) { if ("number" != typeof t) throw new TypeError("End time must be set to a number."); E = t, this.hasBeenReset = !0 } }), Object.defineProperty(g, "text", { enumerable: !0, get: function () { return x }, set: function (t) { x = "" + t, this.hasBeenReset = !0 } }), Object.defineProperty(g, "region", { enumerable: !0, get: function () { return k }, set: function (t) { k = t, this.hasBeenReset = !0 } }), Object.defineProperty(g, "vertical", { enumerable: !0, get: function () { return S }, set: function (a) { var e = function (t) { return "string" == typeof t && !!{ "": !0, lr: !0, rl: !0 }[t.toLowerCase()] && t.toLowerCase() }(a); if (!1 === e) throw new SyntaxError("An invalid or illegal string was specified."); S = e, this.hasBeenReset = !0 } }), Object.defineProperty(g, "snapToLines", { enumerable: !0, get: function () { return I }, set: function (t) { I = !!t, this.hasBeenReset = !0 } }), Object.defineProperty(g, "line", { enumerable: !0, get: function () { return A }, set: function (t) { if ("number" != typeof t && "auto" !== t) throw new SyntaxError("An invalid number or illegal string was specified."); A = t, this.hasBeenReset = !0 } }), Object.defineProperty(g, "lineAlign", { enumerable: !0, get: function () { return C }, set: function (a) { var e = n(a); if (!e) throw new SyntaxError("An invalid or illegal string was specified."); C = e, this.hasBeenReset = !0 } }), Object.defineProperty(g, "position", { enumerable: !0, get: function () { return _ }, set: function (t) { if (0 > t || 100 < t) throw new Error("Position must be between 0 and 100."); _ = t, this.hasBeenReset = !0 } }), Object.defineProperty(g, "size", { enumerable: !0, get: function () { return w }, set: function (t) { if (0 > t || 100 < t) throw new Error("Size must be between 0 and 100."); w = t, this.hasBeenReset = !0 } }), Object.defineProperty(g, "align", { enumerable: !0, get: function () { return R }, set: function (a) { var e = n(a); if (!e) throw new SyntaxError("An invalid or illegal string was specified."); R = e, this.hasBeenReset = !0 } }), g.displayState = void 0 }).prototype.getCueAsHTML = function () { return window.WebVTT.convertCueToDOMTree(window, this.text) }), e.a = t }, 76: function (a, e, t) { "use strict"; function n(a, e) { var t = a.kind || "cc"; return a.default || a.defaulttrack ? "default" : a._id || a.file || t + e } function r(a, e) { var i = a.label || a.name || a.language; return i || (i = "Unknown CC", 1 < (e += 1) && (i += " [" + e + "]")), { label: i, unknownCount: e } } t.d(e, "a", function () { return n }), t.d(e, "b", function () { return r }) }, 77: function (p, e, m) { "use strict"; function b(t) { throw new s.s(null, t) } function t(n, e, d) { n.xhr = Object(i.a)(n.file, function (t) { !function (n, i, e, t) { var r = n.responseXML ? n.responseXML.firstChild : null, d, u; if (r) for ("xml" === Object(y.b)(r) && (r = r.nextSibling); r.nodeType === r.COMMENT_NODE;)r = r.nextSibling; try { if (r && "tt" === Object(y.b)(r)) d = function (l) { l || b(306007); var e = [], t = l.getElementsByTagName("p"), u = 30, T = l.getElementsByTagName("tt"); if (T && T[0]) { var i = parseFloat(T[0].getAttribute("ttp:frameRate")); isNaN(i) || (u = i) } t || b(306005), t.length || (t = l.getElementsByTagName("tt:p")).length || (t = l.getElementsByTagName("tts:p")); for (var E = 0; E < t.length; E++) { for (var x = t[E], s = x.getElementsByTagName("br"), c = 0, k; c < s.length; c++)k = s[c], k.parentNode.replaceChild(l.createTextNode("\r\n"), k); var S = x.innerHTML || x.textContent || x.text || "", d = Object(a.i)(S).replace(/>\s+</g, "><").replace(/(<\/?)tts?:/g, "$1").replace(/<br.*?\/>/g, "\r\n"); if (d) { var p = x.getAttribute("begin"), v = x.getAttribute("dur"), m = x.getAttribute("end"), y = { begin: Object(a.g)(p, u), text: d }; m ? y.end = Object(a.g)(m, u) : v && (y.end = y.begin + Object(a.g)(v, u)), e.push(y) } } return e.length || b(306005), e }(n.responseXML), u = l(d), delete i.xhr, e(u); else { var c = n.responseText; 0 <= c.indexOf("WEBVTT") ? m.e(18).then(function () { return m(142).default }.bind(null, m)).catch(Object(g.c)(301131)).then(function (t) { var a = new t(window); u = [], a.oncue = function (t) { u.push(t) }, a.onflush = function () { delete i.xhr, e(u) }, a.parse(c) }).catch(function (a) { delete i.xhr, t(Object(s.A)(null, s.b, a)) }) : (d = Object(o.a)(c), u = l(d), delete i.xhr, e(u)) } } catch (a) { delete i.xhr, t(Object(s.A)(null, s.b, a)) } }(t, n, e, d) }, function (a, e, t, n) { d(Object(s.z)(n, s.b)) }) } function n(t) { t && t.forEach(function (a) { var e = a.xhr; e && (e.onload = null, e.onreadystatechange = null, e.onerror = null, "abort" in e && e.abort()), delete a.xhr }) } function l(t) { return t.map(function (t) { return new d.a(t.begin, t.end, t.text) }) } var d = m(75), g = m(10), i = m(28), y = m(4), o = m(72), a = m(2), s = m(1); m.d(e, "c", function () { return t }), m.d(e, "a", function () { return n }), m.d(e, "b", function () { return l }) }, 78: function (d, e, t) { "use strict"; function o(a, e) { return a !== 1 / 0 && Math.abs(a) >= Math.max(i(e), 0) } function n(a, e) { var t = "VOD"; return a === 1 / 0 ? t = "LIVE" : 0 > a && (t = o(a, i(e)) ? "DVR" : "LIVE"), t } function i(t) { return void 0 === t ? 120 : Math.max(t, 0) } t.d(e, "a", function () { return o }), t.d(e, "b", function () { return n }) }, 79: function (d, e, t) { "use strict"; function s(d, e) { for (var t = d.length, a = "", p = e || 0, l, u, c; p < t;)if (0 !== (l = d[p++]) && 3 !== l) switch (l >> 4) { case 0: case 1: case 2: case 3: case 4: case 5: case 6: case 7: a += String.fromCharCode(l); break; case 12: case 13: u = d[p++], a += String.fromCharCode((31 & l) << 6 | 63 & u); break; case 14: u = d[p++], c = d[p++], a += String.fromCharCode((15 & l) << 12 | (63 & u) << 6 | (63 & c) << 0); }return a } function i(a) { var e = function (a) { for (var e = "0x", i = 0; i < a.length; i++)16 > a[i] && (e += "0"), e += a[i].toString(16); return parseInt(e) }(a); return 127 & e | (32512 & e) >> 1 | (8323072 & e) >> 2 | (2130706432 & e) >> 3 } function a() { return (0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : []).reduce(function (a, e) { if (!("value" in e) && "data" in e && e.data instanceof ArrayBuffer) { var r = new Uint8Array(e.data), n = r.length; e = { value: { key: "", data: "" } }; for (var y = 10; 14 > y && y < r.length && 0 !== r[y];)e.value.key += String.fromCharCode(r[y]), y++; var b = 19, T = r[b]; 3 !== T && 0 !== T || (T = r[++b], n--); var E = 0; if (1 !== T && 2 !== T) for (var x = b + 1; x < n; x++)if (0 === r[x]) { E = x - b; break } if (0 < E) { var k = s(r.subarray(b, b += E), 0); if ("PRIV" === e.value.key) { if ("com.apple.streaming.transportStreamTimestamp" === k) { var h = 1 & i(r.subarray(b, b += 4)), d = i(r.subarray(b, b += 4)) + (h ? 4294967296 : 0); e.value.data = d } else e.value.data = s(r, b + 1); e.value.info = k } else e.value.info = k, e.value.data = s(r, b + 1) } else { var p = r[b]; e.value.data = 1 === p || 2 === p ? function (a, e) { for (var t = a.length - 1, n = "", d = e || 0; d < t;)254 === a[d] && 255 === a[d + 1] || (n += String.fromCharCode((a[d] << 8) + a[d + 1])), d += 2; return n }(r, b + 1) : s(r, b + 1) } } if (g.hasOwnProperty(e.value.key) && (a[g[e.value.key]] = e.value.data), e.value.info) { var v = a[e.value.key]; v !== Object(v) && (v = {}, a[e.value.key] = v), v[e.value.info] = e.value.data } else a[e.value.key] = e.value.data; return a }, {}) } t.d(e, "c", function () { return s }), t.d(e, "b", function () { return i }), t.d(e, "a", function () { return a }); var g = { TIT2: "title", TT2: "title", WXXX: "url", TPE1: "artist", TP1: "artist", TALB: "album", TAL: "album" } }, 83: function (c, e, t) { "use strict"; function x(a, e, t) { a && (a.removeEventListener ? a.removeEventListener(e, t) : a["on" + e] = null) } function l() { var a = this.video.textTracks, e = Object(o.l)(a, function (t) { return (t.inuse || !t._id) && p(t.kind) }); if (this._textTracks && !T.call(this, e)) { for (var t = -1, i = 0; i < this._textTracks.length; i++)if ("showing" === this._textTracks[i].mode) { t = i; break } t !== this._currentTextTrackIndex && this.setSubtitlesTrack(t + 1) } else this.setTextTracks(a) } function f() { this.setTextTracks(this.video.textTracks) } function h(n) { var i = this; n && (this._textTracks || this._initTextTracks(), n.forEach(function (t) { if (!t.kind || p(t.kind)) { var r = m.call(i, t); y.call(i, r), t.file && (t.data = [], Object(E.c)(t, function (t) { i.addVTTCuesToTrack(r, t) }, function (t) { i.trigger(a.ub, t) })) } }), this._textTracks && this._textTracks.length && this.trigger("subtitlesTracks", { tracks: this._textTracks })) } function d(a, e, t) { if (i.Browser.ie) { var n = t; (a || "metadata" === e.kind) && (n = new window.TextTrackCue(t.startTime, t.endTime, t.text)), function (d, e) { var t = [], n = d.mode; d.mode = "hidden"; for (var r = d.cues, i = r.length - 1; 0 <= i && r[i].startTime > e.startTime; i--)t.unshift(r[i]), d.removeCue(r[i]); try { d.addCue(e), t.forEach(function (e) { return d.addCue(e) }) } catch (t) { console.error(t) } d.mode = n }(e, n) } else try { e.addCue(t) } catch (t) { console.error(t) } } function n(a, e) { e && e.length && Object(o.j)(e, function (e) { if (!(i.Browser.ie && a && /^(native|subtitle|cc)/.test(e._id))) { i.Browser.ie && "disabled" === e.mode || (e.mode = "disabled", e.mode = "hidden"); for (var t = e.cues.length; t--;)e.removeCue(e.cues[t]); e.embedded || (e.mode = "disabled"), e.inuse = !1 } }) } function p(t) { return "subtitles" === t || "captions" === t } function m(i) { var e = Object(k.b)(i, this._unknownCount), n = e.label, r; if (this._unknownCount = e.unknownCount, this.renderNatively || "metadata" === i.kind) { var d = this.video.textTracks; (r = Object(o.n)(d, { label: n })) || (r = this.video.addTextTrack(i.kind, n, i.language || "")), r.default = i.default, r.mode = "disabled", r.inuse = !0 } else (r = i).data = r.data || []; return r._id || (r._id = Object(k.a)(i, this._textTracks.length)), r } function y(t) { this._textTracks.push(t), this._tracksById[t._id] = t } function g() { if (this._textTracks) { var t = this._textTracks.filter(function (t) { return t.embedded || "subs" === t.groupid }); this._initTextTracks(), t.forEach(function (t) { this._tracksById[t._id] = t }), this._textTracks = t } } function b(t) { this.triggerActiveCues(t.currentTarget.activeCues) } function v(d, e, t) { var n = d.kind; this._cachedVTTCues[d._id] || (this._cachedVTTCues[d._id] = {}); var r = this._cachedVTTCues[d._id], a; switch (n) { case "captions": case "subtitles": a = t || Math.floor(20 * e.startTime); var p = "_" + e.line, o = Math.floor(20 * e.endTime), s = r[a + p] || r[a + 1 + p] || r[a - 1 + p]; return !(s && 1 >= Math.abs(s - o)) && (r[a + p] = o, !0); case "metadata": var l = e.data ? new Uint8Array(e.data).join("") : e.text; return !r[a = t || e.startTime + l] && (r[a] = e.endTime, !0); default: return !1; } } function T(a) { if (a.length > this._textTracks.length) return !0; for (var e = 0, i; e < a.length; e++)if (i = a[e], !i._id || !this._tracksById[i._id]) return !0; return !1 } var E = t(77), k = t(76), S = t(79), i = t(5), a = t(3), o = t(0); e.a = { _itemTracks: null, _textTracks: null, _tracksById: null, _cuesByTrackId: null, _cachedVTTCues: null, _metaCuesByTextTime: null, _currentTextTrackIndex: -1, _unknownCount: 0, _activeCues: null, _initTextTracks: function () { this._textTracks = [], this._tracksById = {}, this._metaCuesByTextTime = {}, this._cuesByTrackId = {}, this._cachedVTTCues = {}, this._unknownCount = 0 }, addTracksListener: function (a, e, t) { !a || (x(a, e, t), this.instreamMode) || (a.addEventListener ? a.addEventListener(e, t) : a["on" + e] = t) }, clearTracks: function () { Object(E.a)(this._itemTracks); var t = this._tracksById && this._tracksById.nativemetadata; (this.renderNatively || t) && (n(this.renderNatively, this.video.textTracks), t && (t.oncuechange = null)), this._itemTracks = null, this._textTracks = null, this._tracksById = null, this._cuesByTrackId = null, this._metaCuesByTextTime = null, this._unknownCount = 0, this._currentTextTrackIndex = -1, this._activeCues = null, this.renderNatively && (this.removeTracksListener(this.video.textTracks, "change", this.textTrackChangeHandler), n(this.renderNatively, this.video.textTracks)) }, clearMetaCues: function () { var t = this._tracksById && this._tracksById.nativemetadata; t && (n(this.renderNatively, [t]), t.mode = "hidden", t.inuse = !0, this._cachedVTTCues[t._id] = {}) }, clearCueData: function (a) { var e = this._cachedVTTCues; e && e[a] && (e[a] = {}, this._tracksById && (this._tracksById[a].data = [])) }, disableTextTrack: function () { if (this._textTracks) { var a = this._textTracks[this._currentTextTrackIndex]; if (a) { a.mode = "disabled"; var e = a._id; e && 0 === e.indexOf("nativecaptions") && (a.mode = "hidden") } } }, enableTextTrack: function () { if (this._textTracks) { var t = this._textTracks[this._currentTextTrackIndex]; t && (t.mode = "showing") } }, getSubtitlesTrack: function () { return this._currentTextTrackIndex }, removeTracksListener: x, addTextTracks: h, setTextTracks: function (o) { if (this._currentTextTrackIndex = -1, !!o) { if (this._textTracks ? (this._unknownCount = 0, this._textTracks = this._textTracks.filter(function (a) { var e = a._id; return this.renderNatively && e && 0 === e.indexOf("nativecaptions") ? (delete this._tracksById[e], !1) : (a.name && 0 === a.name.indexOf("Unknown") && this._unknownCount++ , !0) }, this), delete this._tracksById.nativemetadata) : this._initTextTracks(), o.length) for (var e = 0, m = o.length, n; e < m; e++) { if (n = o[e], !n._id) { if ("captions" !== n.kind && "metadata" !== n.kind) n._id = Object(k.a)(n, this._textTracks.length); else if (n._id = "native" + n.kind + e, !n.label && "captions" === n.kind) { var g = Object(k.b)(n, this._unknownCount); n.name = g.label, this._unknownCount = g.unknownCount } if (this._tracksById[n._id]) continue; n.inuse = !0 } if (n.inuse && !this._tracksById[n._id]) if ("metadata" === n.kind) n.mode = "hidden", n.oncuechange = b.bind(this), this._tracksById[n._id] = n; else if (p(n.kind)) { var a = n.mode, s = void 0; if (n.mode = "hidden", !n.cues.length && n.embedded) continue; if (n.mode = a, this._cuesByTrackId[n._id] && !this._cuesByTrackId[n._id].loaded) { for (var h = this._cuesByTrackId[n._id].cues; s = h.shift();)d(this.renderNatively, n, s); n.mode = a, this._cuesByTrackId[n._id].loaded = !0 } y.call(this, n) } } this.renderNatively && (this.textTrackChangeHandler = this.textTrackChangeHandler || l.bind(this), this.addTracksListener(this.video.textTracks, "change", this.textTrackChangeHandler), (i.Browser.edge || i.Browser.firefox || i.Browser.safari) && (this.addTrackHandler = this.addTrackHandler || f.bind(this), this.addTracksListener(this.video.textTracks, "addtrack", this.addTrackHandler))), this._textTracks.length && this.trigger("subtitlesTracks", { tracks: this._textTracks }) } }, setupSideloadedTracks: function (a) { if (this.renderNatively) { var e = a === this._itemTracks; e || Object(E.a)(this._itemTracks), (this._itemTracks = a, !a) || e || (this.disableTextTrack(), g.call(this), this.addTextTracks(a)) } }, setSubtitlesTrack: function (t) { if (!this.renderNatively) return void (this.setCurrentSubtitleTrack && this.setCurrentSubtitleTrack(t - 1)); this._textTracks && (0 === t && this._textTracks.forEach(function (t) { t.mode = t.embedded ? "hidden" : "disabled" }), this._currentTextTrackIndex === t - 1 || (this.disableTextTrack(), this._currentTextTrackIndex = t - 1, this._textTracks[this._currentTextTrackIndex] && (this._textTracks[this._currentTextTrackIndex].mode = "showing"), this.trigger("subtitlesTrackChanged", { currentTrack: this._currentTextTrackIndex + 1, tracks: this._textTracks }))) }, textTrackChangeHandler: null, addTrackHandler: null, addCuesToTrack: function (r) { var e = this._tracksById[r.name]; if (e) { e.source = r.source; for (var t = r.captions || [], n = [], i = !1, d = 0; d < t.length; d++) { var p = t[d], s = r.name + "_" + p.begin + "_" + p.end; this._metaCuesByTextTime[s] || (this._metaCuesByTextTime[s] = p, n.push(p), i = !0) } i && n.sort(function (a, e) { return a.begin - e.begin }); var l = Object(E.b)(n); Array.prototype.push.apply(e.data, l) } }, addCaptionsCue: function (r) { if (r.text && r.begin && r.end) { var e = r.trackid.toString(), n = this._tracksById && this._tracksById[e], d; n || (n = { kind: "captions", _id: e, data: [] }, this.addTextTracks([n]), this.trigger("subtitlesTracks", { tracks: this._textTracks })), r.useDTS && (n.source || (n.source = r.source || "mpegts")), d = r.begin + "_" + r.text; var s = this._metaCuesByTextTime[d]; if (!s) { s = { begin: r.begin, end: r.end, text: r.text }, this._metaCuesByTextTime[d] = s; var p = Object(E.b)([s])[0]; n.data.push(p) } } }, createCue: function (a, e, t) { var n = window.VTTCue || window.TextTrackCue, r = Math.max(e || 0, a + .25); return new n(a, r, t) }, addVTTCue: function (p, e) { this._tracksById || this._initTextTracks(); var t = p.track ? p.track : "native" + p.type, n = this._tracksById[t], l = "captions" === p.type ? "Unknown CC" : "ID3 Metadata", i = p.cue; if (!n) { var a = { kind: p.type, _id: t, label: l, embedded: !0 }; n = m.call(this, a), this.renderNatively || "metadata" === n.kind ? this.setTextTracks(this.video.textTracks) : h.call(this, [n]) } if (v.call(this, n, i, e)) { var o = this.renderNatively || "metadata" === n.kind; return o ? d(o, n, i) : n.data.push(i), i } return null }, addVTTCuesToTrack: function (a, e) { if (this.renderNatively) { var t = this._tracksById[a._id], i; if (!t) return this._cuesByTrackId || (this._cuesByTrackId = {}), void (this._cuesByTrackId[a._id] = { cues: e, loaded: !1 }); if (!(this._cuesByTrackId[a._id] && this._cuesByTrackId[a._id].loaded)) for (this._cuesByTrackId[a._id] = { cues: e, loaded: !0 }; i = e.shift();)d(this.renderNatively, t, i) } }, triggerActiveCues: function (d) { var s = this; if (!d || !d.length) return void (this._activeCues = null); var t = this._activeCues || [], e = Array.prototype.filter.call(d, function (d) { if (t.some(function (e) { return a = e, (t = d).startTime === a.startTime && t.endTime === a.endTime && t.text === a.text && t.data === a.data && t.value === a.value; var t, a })) return !1; if (d.data || d.value) return !0; if (d.text) { var e = JSON.parse(d.text), n = { metadataTime: d.startTime, metadata: e }; e.programDateTime && (n.programDateTime = e.programDateTime), e.metadataType && (n.metadataType = e.metadataType, delete e.metadataType), s.trigger(a.K, n) } return !1 }); if (e.length) { var n = Object(S.a)(e), i = e[0].startTime; this.trigger(a.K, { metadataType: "id3", metadataTime: i, metadata: n }) } this._activeCues = Array.prototype.slice.call(d) }, renderNatively: !1 } }, 85: function (a, e, t) { "use strict"; function n(t) { return t && t.length ? t.end(t.length - 1) : 0 } t.d(e, "a", function () { return n }) }, 87: function (a, e, t) { "use strict"; function n(t) { return { bitrate: t.bitrate, label: t.label, width: t.width, height: t.height } } t.d(e, "a", function () { return n }) } }]);